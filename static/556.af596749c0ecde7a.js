"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[556],{7556:(tt,b,r)=>{r.r(b),r.d(b,{ActivityModule:()=>Qe});var u=r(6895),A=r(3060),l=r(4006),S=r(7030),E=r(7335),Z=r(4025);const x=["NONE","LOW","MEDIUM","HIGH"],et=["INTERNAL","EVERYONE"],v=["NEW","INPROGRESS","REJECTED","REJECTED","RESOLVED"],it={NEW:[{title:"Start",icon:"play_circle_fill",action:"INPROGRESS"},{title:"Resolve",icon:"assistant_photo",action:"RESOLVED"},{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Edit",icon:"edit",action:"EDIT"},{title:"Move to Organization",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],INPROGRESS:[{title:"Resolve",icon:"assistant_photo",action:"RESOLVED"},{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],REJECTED:[{title:"Reopen",icon:"reply",action:"NEW"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],RESOLVED:[{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}]},at=[{title:"Start",icon:"play_circle_fill",action:"INPROGRESS",displayCondition:(a,n)=>"NEW"===a.status},{title:"Resolve",icon:"assistant_photo",action:"RESOLVE",displayCondition:(a,n)=>("INPROGRESS"===a.status||"NEW"===a.status)&&(a.createdBy===n._id||n.organization.includes(a.assignTo))},{title:"Reject",icon:"cancel",action:"REJECTED",displayCondition:(a,n)=>"REJECTED"!==a.status&&("NEW"===a.status&&a.createdBy===n._id||"INPROGRESS"===a.status&&a.createdBy===n._id||n.organization.includes(a.assignTo)||"RESOLVED"===a.status&&a.createdBy===n._id)},{title:"Reply",icon:"reply",action:"REPLAY",displayCondition:(a,n)=>"REJECTED"!==a.status},{title:"Edit",icon:"edit",action:"EDIT",displayCondition:(a,n)=>"NEW"===a.status&&a.createdBy===n._id},{title:"Move to Organization",icon:"skip_next",action:"MOVE_TO_ORGANIZATION",displayCondition:(a,n)=>a.createdBy===n._id&&("NEW"===a.status||"INPROGRESS"===a.status)},{title:"Archive",icon:"archive",action:"ARCHIVE",displayCondition:(a,n)=>a.createdBy===n._id&&("NEW"===a.status||"INPROGRESS"===a.status)},{title:"Delete",icon:"delete_sweep",action:"DELETE",displayCondition:(a,n)=>"NEW"===a.status&&a.createdBy===n._id},{title:"Reopen",icon:"reply",action:"NEW",displayCondition:(a,n)=>"REJECTED"===a.status}];var t=r(4650),T=r(5938),nt=r(6903),M=r(7199),N=r(9690),ot=r(2126),I=r(9642),C=r(2653),B=r(7957),k=r(3238),O=r(4859),y=r(9549),J=r(4144);function ct(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-option",10,11),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.optionSelected(c))}),t._uU(2),t.qZA()}if(2&a){const e=n.$implicit;t.Q6J("value",e.organization),t.xp6(2),t.hij(" ",e.organization," ")}}let rt=(()=>{class a{constructor(e,i,o,c,s,p,d,_){this.activityService=e,this.organizationService=i,this.storageService=o,this.companySettingsService=c,this.confirmationPopup=s,this.alertPopupService=p,this.dialogref=d,this.data=_,this.organizationsList=[],this.searchedOrganizationList=[],this.isSuperAdmin=!1,this.selectedActivityId="",this.selectedActivityId=_}ngOnInit(){this.isSuperAdmin=this.storageService.getDataFromLocalStorage(Z.I.ROLE)===E.G.SuperAdmin,this.logedInUserId=this.storageService.getDataFromLocalStorage(Z.I.USER_ID),this.isSuperAdmin?this.getAllOrganizations():this.getOrganizationsSearchCriteria()}getAllOrganizations(){this.companySettingsService.getAllOrganizations().subscribe(e=>{this.organizationsList=e.organizations,this.searchedOrganizationList=e.organizations})}filterOrganization(e){if(e.target.value){const i=new nt.C;this.searchedOrganizationList=i.transform(this.organizationsList,e.target.value,"organization")}}getOrganizationsSearchCriteria(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:0,pageSize:0,sortField:"",sortOrder:0,type:"",role:"",userSearch:"",organizationId:"",organization:"",organizationSerach:"",userId:this.logedInUserId}).subscribe(i=>{this.organizationsList=i.data.organizations,this.searchedOrganizationList=i.data.organizations})}optionSelected(e){this.selectOrganization=e}selectedOrganization(){this.confirmationPopup.open({message:`Are sure to move activity to ${this.selectOrganization.organization}`}).afterClosed().subscribe(e=>{e&&this.activityService.updateActivityOrganization({organzation:this.selectOrganization._id,activityId:this.selectedActivityId}).subscribe(i=>{this.alertPopupService.open({message:"Activity Updated Successfully",action:"ok"})},i=>{this.alertPopupService.open({message:i.message?i.message:"Unable to move organization to this activity",action:"ok"})})})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U),t.Y36(M.M),t.Y36(N.V),t.Y36(ot.$),t.Y36(I.O),t.Y36(C.z),t.Y36(T.so),t.Y36(T.WI))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-move-to-organization-pop-up"]],decls:14,vars:4,consts:[[1,"elog-dialog"],[1,"user"],[1,"elog-dialog-body"],["appearance","outline","width","100%"],["placeholder","Find an Organisation","matInput","",1,"p-2",3,"matAutocomplete","keyup"],["auto","matAutocomplete"],[3,"value","click",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-end","p-1"],["mat-button","","mat-dialog-close","true",3,"mat-dialog-close"],["mat-dialog-close","true","mat-raised-button","","color","primary",3,"mat-dialog-close","click"],[3,"value","click"],["matOption",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Move Organization"),t.qZA(),t.TgZ(3,"mat-dialog-content",2)(4,"mat-form-field",3)(5,"input",4),t.NdJ("keyup",function(c){return i.filterOrganization(c)}),t.qZA(),t.TgZ(6,"mat-autocomplete",null,5),t.YNc(8,ct,3,2,"mat-option",6),t.qZA()()(),t.TgZ(9,"mat-dialog-actions",7)(10,"button",8),t._uU(11," Cancel "),t.qZA(),t.TgZ(12,"button",9),t.NdJ("click",function(){return i.selectedOrganization()}),t._uU(13," MOVE "),t.qZA()()()),2&e){const o=t.MAs(7);t.xp6(5),t.Q6J("matAutocomplete",o),t.xp6(3),t.Q6J("ngForOf",i.searchedOrganizationList),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0)}},dependencies:[u.sg,B.XC,B.ZL,k.ey,O.lW,T.ZT,T.xY,T.H8,y.KE,J.Nt]}),a})();var st=r(3248);let U=(()=>{class a{constructor(e,i){this.httpDataService=e,this.matDialog=i}getAllActivities(){return this.httpDataService.get("activity")}getActivitiesMasterData(){return this.httpDataService.get("activity-masterdata")}createActivity(e){return this.httpDataService.post("activity-type",e)}postActivity(e){return this.httpDataService.post("activity",e)}getActivityMastarData(){return this.httpDataService.get("activity-masterdata")}getActivityById(e){return this.httpDataService.get(`activity/${e}`)}updateActivity(e,i){return this.httpDataService.put(`activity/${e}`,i)}updateActivityLogById(e,i){return this.httpDataService.put(`activity/activityLog/${e}`,i)}updateArchivestatus(e,i){return this.httpDataService.put(`activity/archive/${e}`,i)}deleteSelectedActivity(e){return this.httpDataService.delete(`activity/${e}`)}updateActivityStatus(e,i){return this.httpDataService.put(`activity/update/activityStatus/${e}`,i)}updateActivityDueDate(e,i){return this.httpDataService.put(`activity/update/dueDate/${e}`,i)}openMoveToOrganizationPopup(e){return this.matDialog.open(rt,{width:"600px",height:"280px",disableClose:!0,data:e})}updateActivityOrganization(e){return this.httpDataService.put("activity/update/moveOrganization",e)}}return a.\u0275fac=function(e){return new(e||a)(t.LFG(st.L),t.LFG(T.uw))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var lt=r(1584);let pt=(()=>{class a{constructor(){}downloadFile(e,i="data",o){let c=this.ConvertToCSV(e,o);console.log(c);let s=new Blob(["\ufeff"+c],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),d=URL.createObjectURL(s);-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&p.setAttribute("target","_blank"),p.setAttribute("href",d),p.setAttribute("download",i+".csv"),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)}ConvertToCSV(e,i){let o="object"!=typeof e?JSON.parse(e):e,c="",s="S.No,";for(let p in i)s+=i[p].displayName+",";s=s.slice(0,-1),c+=s+"\r\n";for(let p=0;p<o.length;p++){let d=p+1+"";for(let _ in i)d+=","+o[p][i[_].propertyName];c+=d+"\r\n"}return c}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var R=r(2137),G=r(3546),h=r(9602),q=r(7392),D=r(8255),F=r(1948),H=r(4385),$=r(266),m=r(5869);let j=(()=>{class a{constructor(e){this.fb=e,this.value="<h3>Write Here....</h3>",this.updatedDescription=new t.vpe,this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]]}ngOnInit(){this.editor=new m.ML,this.editor.commands.focus().scrollIntoView().exec(),this.createformgroup(),this.richtextForm?.controls.description?.valueChanges.subscribe(e=>{this.updatedDescription.emit(e)})}createformgroup(){this.richtextForm=this.fb.group({description:[""]})}ngOnDestroy(){this.editor.destroy()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(l.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-rich-text-editor"]],inputs:{value:"value"},outputs:{updatedDescription:"updatedDescription"},decls:3,vars:6,consts:[[3,"formGroup"],[3,"editor","toolbar"],["formControlName","description",3,"editor","placeholder","ngModel"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t._UZ(1,"ngx-editor-menu",1)(2,"ngx-editor",2),t.qZA()),2&e&&(t.Q6J("formGroup",i.richtextForm),t.xp6(1),t.Q6J("editor",i.editor)("toolbar",i.toolbar),t.xp6(1),t.Q6J("editor",i.editor)("placeholder","Type here...")("ngModel",i.value))},dependencies:[m.tP,m.Mn,l._Y,l.JJ,l.JL,l.sg,l.u]}),a})();function ut(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"mat-icon"),t._uU(3,"insert_drive_file"),t.qZA()(),t.TgZ(4,"div",8)(5,"h4",9),t._uU(6),t.qZA(),t.TgZ(7,"p",10),t._uU(8),t.qZA()(),t.TgZ(9,"div",11),t.NdJ("click",function(){const c=t.CHM(e).index,s=t.oxw();return t.KtG(s.deleteFile(c))}),t.TgZ(10,"mat-icon"),t._uU(11,"delete_forever"),t.qZA()()()}if(2&a){const e=n.$implicit,i=t.oxw();t.xp6(6),t.hij(" ",null==e?null:e.name," "),t.xp6(2),t.hij(" ",i.formatBytes(null==e?null:e.size)," ")}}let V=(()=>{class a{constructor(e){this.alertpopupService=e,this.updatedFilesDescription=new t.vpe,this.files=[]}ngOnInit(){}onFileDropped(e){this.prepareFilesList(e)}fileBrowseHandler(e){this.prepareFilesList(e.target.files)}deleteFile(e){this.files.splice(e,1)}prepareFilesList(e){for(const i of e)console.log(i),"image/jpeg"==i.type||"text/plain"==i.type||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==i.type||"image/png"==i.type||"application/vnd.openxmlformats-officedocument.presentationml.presentation"==i.type||"application/pdf"==i.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==i.type&&i.size<=262144e3?this.files.push(i):this.alertpopupService.open({message:`${i.type} is not accept `,action:"ok"});this.updatedFilesDescription.emit(this.files)}formatBytes(e,i){if(0===e)return"0 Bytes";const c=i<=0?0:i||2,p=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,p)).toFixed(c))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][p]}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(C.z))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-fileuploader"]],outputs:{updatedFilesDescription:"updatedFilesDescription"},decls:13,vars:1,consts:[["appDnd","",1,"container",3,"fileDropped"],["type","file","id","fileDropRef","multiple","",3,"change"],["fileDropRef",""],["for","fileDropRef"],[1,"files-list"],["class","single-file",4,"ngFor","ngForOf"],[1,"single-file"],[1,"file-icon",2,"width","50px"],[1,"info"],[1,"name"],[1,"size"],[1,"delete",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("fileDropped",function(c){return i.onFileDropped(c)}),t.TgZ(1,"input",1,2),t.NdJ("change",function(c){return i.fileBrowseHandler(c)}),t.qZA(),t.TgZ(3,"mat-icon"),t._uU(4,"upload_file"),t.qZA(),t.TgZ(5,"h3"),t._uU(6,"Drag and drop file here"),t.qZA(),t.TgZ(7,"h3"),t._uU(8,"or"),t.qZA(),t.TgZ(9,"label",3),t._uU(10,"Browse for file"),t.qZA()(),t.TgZ(11,"div",4),t.YNc(12,ut,12,2,"div",5),t.qZA()),2&e&&(t.xp6(12),t.Q6J("ngForOf",i.files))},dependencies:[u.sg,q.Hw],styles:[".container[_ngcontent-%COMP%]{width:450px;height:200px;padding:2rem;text-align:center;border:dashed 1px #979797;position:relative;margin:0 auto}input[_ngcontent-%COMP%]{opacity:0;position:absolute;z-index:2;width:100%;height:100%;top:0;left:0}label[_ngcontent-%COMP%]{color:#fff;width:183px;height:44px;border-radius:21.5px;background-color:#db202f;padding:8px 16px}h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#38424c}.fileover[_ngcontent-%COMP%]{animation:shake 1s;animation-iteration-count:infinite}.files-list[_ngcontent-%COMP%]{margin-top:1.5rem}.single-file[_ngcontent-%COMP%]{display:flex;padding:.5rem;justify-content:space-between;align-items:center;border:dashed 1px #979797;margin-bottom:1rem}.delete[_ngcontent-%COMP%]{margin-left:.5rem;cursor:pointer;align-self:flex-end;display:flex;flex-grow:1}.name[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#353f4a;margin:0}.size[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#a4a4a4;margin:0;margin-bottom:.25rem}.info[_ngcontent-%COMP%]{width:100%}"]}),a})();function dt(a,n){if(1&a&&(t.TgZ(0,"span")(1,"mat-icon"),t._uU(2," chat"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(null==e.activityData?null:e.activityData.activityLog.length)}}function mt(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"attach_file"),t.qZA())}function gt(a,n){if(1&a&&(t.TgZ(0,"p")(1,"mat-icon"),t._uU(2,"insert_drive_file"),t.qZA(),t._uU(3),t.ALo(4,"number"),t.qZA()),2&a){const e=n.$implicit;t.xp6(3),t.AsE("",null==e?null:e.name," ",t.xi3(4,2,(null==e?null:e.size)/1024,".2-2")," Kb ")}}function _t(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"attach_file"),t.qZA())}function yt(a,n){if(1&a&&(t.TgZ(0,"div")(1,"mat-icon"),t._uU(2,"insert_drive_file"),t.qZA(),t._uU(3),t.ALo(4,"number"),t.qZA()),2&a){const e=n.$implicit;t.xp6(3),t.AsE("",null==e?null:e.name," ",t.xi3(4,2,(null==e?null:e.size)/1024,".2-2")," Kb ")}}function vt(a,n){if(1&a&&(t.TgZ(0,"div",7)(1,"mat-card")(2,"mat-card-content")(3,"div",48)(4,"div"),t._uU(5),t.qZA(),t.TgZ(6,"div",9)(7,"mat-icon",10),t._uU(8,"person_outline"),t.qZA()(),t.TgZ(9,"div"),t._uU(10),t.TgZ(11,"p"),t._uU(12),t.ALo(13,"date"),t.qZA()(),t.TgZ(14,"span",49)(15,"strong"),t._uU(16),t.ALo(17,"titlecase"),t.qZA()(),t.TgZ(18,"div")(19,"p"),t._uU(20),t.ALo(21,"titlecase"),t.qZA()(),t.TgZ(22,"div")(23,"p"),t._uU(24),t.qZA()()(),t._UZ(25,"hr")(26,"div",11),t.TgZ(27,"div",8),t.YNc(28,_t,2,0,"mat-icon",4),t.YNc(29,yt,5,5,"div",12),t.qZA()()()()),2&a){const e=n.$implicit,i=n.index,o=t.oxw();t.xp6(5),t.Oqu(i+1),t.xp6(5),t.hij(" Created by ",e.createdByUserName," "),t.xp6(2),t.Oqu(t.xi3(13,9,e.updatedAt,"medium")),t.xp6(4),t.Oqu(t.lcZ(17,12,e.title)),t.xp6(4),t.hij("Status: ",t.lcZ(21,14,e.status),""),t.xp6(4),t.hij("Assigned To: ",o.selectedActivityAssignedTo," "),t.xp6(2),t.Q6J("innerHTML",e.message,t.oJD),t.xp6(2),t.Q6J("ngIf",(null==e||null==e.attachments?null:e.attachments.length)>=1),t.xp6(1),t.Q6J("ngForOf",null==e?null:e.attachments)}}function ht(a,n){if(1&a&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.organization,"")}}function At(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",58),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.updateActivityDetails())}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function ft(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.updateStatusOfSelectedActivity("Resolve"))}),t.TgZ(1,"mat-icon"),t._uU(2,"assistant_photo"),t.qZA()()}}function Tt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.updateStatusOfSelectedActivity("Reject"))}),t.TgZ(1,"mat-icon"),t._uU(2,"checkmark"),t.qZA()()}}function Dt(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",50)(2,"button",51),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.YNc(5,At,3,0,"button",52),t.TgZ(6,"button",53),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.updateSelectedArchiveStatus())}),t.TgZ(7,"mat-icon"),t._uU(8,"archive"),t.qZA()(),t.TgZ(9,"button",54),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.deleteSelectedActivity())}),t.TgZ(10,"mat-icon"),t._uU(11,"delete"),t.qZA()(),t.YNc(12,ft,3,0,"button",55),t.YNc(13,Tt,3,0,"button",56),t.TgZ(14,"button",57),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.downloadActivity())}),t.TgZ(15,"mat-icon"),t._uU(16,"download"),t.qZA()()(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)),t.xp6(7),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"INPROGRESS"===(null==e.activityData?null:e.activityData.status)),t.xp6(1),t.Q6J("ngIf","REJECTED"!==(null==e.activityData?null:e.activityData.status))}}function Zt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",53),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.updateSelectedArchiveStatus())}),t.TgZ(1,"mat-icon"),t._uU(2,"archive"),t.qZA()()}}function Ct(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",54),t.NdJ("click",function(){t.CHM(e);const o=t.oxw(2);return t.KtG(o.deleteSelectedActivity())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function bt(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",50)(2,"button",61),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.YNc(5,Zt,3,0,"button",62),t.YNc(6,Ct,3,0,"button",63),t.TgZ(7,"button",57),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.downloadActivity())}),t.TgZ(8,"mat-icon"),t._uU(9,"download"),t.qZA()()(),t.BQk()}if(2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"INPROGRESS"===(null==e.activityData?null:e.activityData.status)||"REJECTED"===(null==e.activityData?null:e.activityData.status)),t.xp6(1),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"REJECTED"===(null==e.activityData?null:e.activityData.status))}}function St(a,n){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",50)(2,"button",51),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.TgZ(5,"button",57),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.downloadActivity())}),t.TgZ(6,"mat-icon"),t._uU(7,"download"),t.qZA()()(),t.BQk()}}function xt(a,n){if(1&a&&(t.TgZ(0,"div")(1,"mat-icon"),t._uU(2,"insert_drive_file"),t.qZA(),t._uU(3),t.ALo(4,"number"),t.ALo(5,"date"),t.qZA()),2&a){const e=n.$implicit;t.xp6(3),t.lnq("",null==e?null:e.name," ",t.xi3(4,3,(null==e?null:e.size)/1024,".2-2")," Kb ",t.xi3(5,6,null==e?null:e.updatedAt,"medium")," ")}}function Nt(a,n){if(1&a&&(t.TgZ(0,"div",64)(1,"p")(2,"strong"),t._uU(3),t.qZA(),t._uU(4),t.ALo(5,"date"),t.qZA()()),2&a){const e=n.$implicit;t.xp6(3),t.hij("",e.status,":"),t.xp6(1),t.hij(" ",t.xi3(5,2,e.updatedAt,"medium")," ")}}function kt(a,n){if(1&a&&(t.TgZ(0,"div",8)(1,"span",65)(2,"mat-icon",66),t._uU(3,"person_outline"),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(2),t.s9C("matTooltip",e.organization)}}let Ot=(()=>{class a{constructor(e,i,o,c,s,p,d,_,f,L,Q){this.activatedRoute=e,this.activityService=i,this.formBuilder=o,this.organizationService=c,this.router=s,this.alertpopupService=p,this.confirmationDialogService=d,this.userService=_,this.csvHelperService=f,this.storageService=L,this.userDetailsService=Q,this.Priority=x,this.visibility=et,this.status=v,this.filesListArray=[],this.description="",this.toDay=new Date,this.activatedRoute.queryParams.subscribe(Y=>{this.selectedActivityId=Y.aId})}ngOnInit(){this.getActivityDetailsById(),this.getActivityMasterData(),this.getAllOrganizationsBySearchCriteria(),this.genarateActivityLogForm(),this.isSuperAdmin=this.storageService.getDataFromLocalStorage(Z.I.ROLE)===E.G.SuperAdmin,this.logedInUserId=this.storageService.getDataFromLocalStorage(Z.I.USER_ID)}getActivityDetailsById(){this.activityService.getActivityById(this.selectedActivityId).subscribe(e=>{this.activityData=e.data[0],this.selectedActivityEntryTypeId=e.data[0]?.activitEntryType,this.selectedActivityRelatedTypeId=e.data[0]?.activityRelatedTo,this.selectedActivitySectorId=e.data[0]?.activitySector,this.selectedActivityScopeId=e.data[0]?.activityScope,this.selectedActivityCreatedById=e.data[0]?.createdBy,this.organizationCreatedBy=this.activityData?.createdByOrganizationData[0]?.organization,this.activityLogData=this.activityData?.activityLog,this.isArchive=this.activityData?.isArchive,this.selectedActivityTypeId=this.activityData?.activityType,this.organizationsInvolved=this.activityData?.organizationData,this.ministryName=this.activityData?.organizationData[0]?.organization,this.selectedActivityAssignedTo=this.activityData?.organizationData.filter(i=>i._id==this.activityData?.assignTo).map(i=>i.organization),this.getUserById(),this.getLogedInUserDetails(),this.ActivityTimeLogs=this.activityData?.statusLog})}getLogedInUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.logedInUserDetails=e,this.isAssignee=e?.organization?.includes(this.activityData?.assignTo)})}getActivityMasterData(){this.activityService.getActivitiesMasterData().subscribe(e=>{this.activityEntryType=e.data?.activityEntryTypesData.filter(i=>i._id==this.selectedActivityEntryTypeId).map(i=>i.name),this.activityRelatedTypesData=e.data?.activityRelatedTypesData.filter(i=>i._id==this.selectedActivityRelatedTypeId).map(i=>i.name),this.activitySectorsData=e.data?.activitySectorsData.filter(i=>i._id==this.selectedActivitySectorId).map(i=>i.name),this.ActivityScopeData=e.data?.activityScopesData.filter(i=>i._id==this.selectedActivityScopeId).map(i=>i.name),this.activityType=e?.data?.activityTypesData.filter(i=>i._id==this.selectedActivityTypeId).map(i=>i.name)})}getUserById(){this.userService.getUserById(this.activityData?.createdBy).subscribe(e=>{this.activityReportedBy=e?.existingUser?.Name})}genarateActivityLogForm(){this.activityLogForm=this.formBuilder.group({priority:["",[l.kI.required]],visibility:["",[l.kI.required]],status:["",[l.kI.required]],assignTo:["",[l.kI.required]],attachments:["",[l.kI.required]]})}onSubmit(){const e={...this.activityLogForm.value,attachments:0===this.filesListArray.length?void 0:this.filesListArray,message:this.description};this.activityService.updateActivityLogById(this.selectedActivityId,e).subscribe(i=>{this.alertpopupService.open({message:i.message?i.message:"Activity Updated Successfully",action:"ok"}),this.getActivityDetailsById(),this.activityLogForm?.reset()},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}getAllOrganizationsBySearchCriteria(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:0,pageSize:50,sortField:"",sortOrder:0,type:"63973bfb61ab6f49bfdd3c35",organization:"",organizationId:"",isActive:!0,userId:"",userSearch:""}).subscribe(i=>{this.organizationList=i.data.organizations})}updatedDescription(e){this.description=e}updatedFilesDescription(e){for(var i=0;i<e.length;i++)this.filesListArray.push({name:e[i].name,size:e[i].size,path:"string"})}updateActivityDetails(){this.router.navigate([S.p.CREATEACTIVITY],{queryParams:{aId:this.selectedActivityId}})}dueDateSetter(e,i){"noDueDate"==e?this.selectedDate="":"Today"==e?this.selectedDate=new Date:"Tomorrow"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+1)):"Next Monday"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+(7-this.toDay.getDay())%7+1)):"This Friday"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+(12-this.toDay.getDay())%7)):"custom"==e&&(this.selectedDate=i.value),this.activityService.updateActivityDueDate(this.selectedActivityId,{dueDate:this.selectedDate}).subscribe(o=>{this.alertpopupService.open({message:o.message,action:"ok"}),this.getActivityDetailsById()},o=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})}updateSelectedArchiveStatus(){const e={isArchive:!0};this.confirmationDialogService.open({message:"Are you sure you want to archive"}).afterClosed().subscribe(i=>{i&&this.activityService.updateArchivestatus(this.selectedActivityId,e).subscribe(o=>{this.alertpopupService.open({message:o.message,action:"ok"}),this.getActivityDetailsById()},o=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})}deleteSelectedActivity(){this.confirmationDialogService.open({message:"Are you sure you want to delete "}).afterClosed().subscribe(e=>{e&&this.activityService.deleteSelectedActivity(this.selectedActivityId).subscribe(i=>{this.alertpopupService.open({message:i.message,action:"ok"}),this.getActivityDetailsById()},i=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})}updateStatusOfSelectedActivity(e){let i="";"Reject"==e?i=v[2]:"Resolve"==e&&(i=v[4]);const o={status:i};this.confirmationDialogService.open({message:`Are you sure you want to ${e}`}).afterClosed().subscribe(c=>{c&&this.activityService.updateActivityStatus(this.selectedActivityId,o).subscribe(s=>{this.alertpopupService.open({message:s.message,action:"ok"}),this.getActivityDetailsById()},s=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})}downloadActivity(){this.csvHelperService.downloadFile([{title:this.activityData.title,description:this.activityData.description,status:this.activityData.status,assignedTo:this.selectedActivityAssignedTo[0],dueDate:this.activityData.dueDate,attachments:this.activityData.attachments,priority:this.activityData.priority,type:this.activityType[0],sector:this.activitySectorsData[0],entryType:this.activityEntryType[0],ministry:this.organizationsInvolved,Scope:this.ActivityScopeData[0],relatedTo:this.activityRelatedTypesData[0],categoryMappedTo:"",activityprogress:""}],"activity details",[{propertyName:"title",displayName:"Title"},{propertyName:"description",displayName:"Description"},{propertyName:"status",displayName:"Status"},{propertyName:"assignedTo",displayName:"Assigned To"},{propertyName:"dueDate",displayName:"Due Date"},{propertyName:"attachments",displayName:"Attachments"},{propertyName:"priority",displayName:"Priority"},{propertyName:"type",displayName:"Type"},{propertyName:"sector",displayName:"Sector"},{propertyName:"entryType",displayName:"Entry Type"},{propertyName:"ministry",displayName:"Ministry/Department"},{propertyName:"scope",displayName:"Scope"},{propertyName:"relatedTo",displayName:"Related To"},{propertyName:"categoryMappedTo",displayName:"Category Mapped to"},{propertyName:"activityprogress",displayName:"Activity % of progress"}])}refreshPage(){this.getActivityDetailsById()}resetActivityLogForm(){this.activityLogForm.reset()}navigateToPreviousRoute(){this.router.navigate([S.p.ACTIVITY])}statusClass(e){return"MEDIUM"===e?"confirm":"HIGH"===e?"reject":""}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(A.gz),t.Y36(U),t.Y36(l.qu),t.Y36(M.M),t.Y36(A.F0),t.Y36(C.z),t.Y36(I.O),t.Y36(lt.K),t.Y36(pt),t.Y36(N.V),t.Y36(R.H))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity-details"]],decls:233,vars:75,consts:[[3,"click"],[1,"row","container"],[1,"row"],[1,"col-md-9"],[4,"ngIf"],[1,"col-md-3"],[1,"table","table-borderless"],[1,"col-md-12","my-2"],[1,"d-flex"],[1,"img-span","d-flex"],[1,"mat-i"],[3,"innerHTML"],[4,"ngFor","ngForOf"],["class","col-md-12 my-2",4,"ngFor","ngForOf"],[3,"formGroup","ngSubmit"],["value","",3,"updatedDescription"],["appearance","outline"],["formControlName","status"],[3,"value"],["aria-label","","formControlName","priority","layout","row"],[1,"row","mb-3"],[1,"col-sm-3","col-form-label"],[1,"col-sm-8"],["aria-label","","formControlName","visibility","layout","row"],["formControlName","assignTo"],[3,"value",4,"ngFor","ngForOf"],[3,"updatedFilesDescription"],[1,"d-flex","justify-content-end","align-items-center"],["type","button","mat-raised-button","",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"col-md-3","kit"],[1,"d-flex","align-items-center"],[1,"mat-Icon"],["data-toggle","dropdown",1,"quick-action"],[1,"img-span"],["mat-button","",1,"date-icon",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item",""],["dueDateFiltersMatMenu","matMenu"],["mat-menu-item","",3,"click"],["matInput","",3,"matDatepicker","dateChange"],["matIconSuffix","",3,"for"],["picker",""],[1,"d-flex","flex-wrap"],[1,"mx-2","text"],[1,"mx-3"],["class","my-2",4,"ngFor","ngForOf"],["class"," d-flex",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-between"],[1,"organization-title"],[1,"d-flex","justify-content-start"],["mat-stroked-button","","matTooltip","Reload",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Edit",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Archive",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Delete",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Resolve",3,"click",4,"ngIf"],["mat-stroked-button","","class","padding","matTooltip","Reject",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Download",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Edit",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Resolve",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Reject",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Refresh",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Archive",3,"click",4,"ngIf"],["mat-stroked-button","","class","padding","matTooltip","Delete",3,"click",4,"ngIf"],[1,"my-2"],[1,"img-span","d-flex","align-items-center","justify-content-center"],[1,"mat-i",3,"matTooltip"]],template:function(e,i){if(1&e&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return i.navigateToPreviousRoute()}),t.TgZ(1,"mat-icon"),t._uU(2,"keyboard_return"),t.qZA()(),t.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"h2"),t._uU(7),t.ALo(8,"titlecase"),t.qZA(),t.TgZ(9,"p"),t._uU(10),t.ALo(11,"date"),t.YNc(12,dt,4,1,"span",4),t.qZA(),t._UZ(13,"hr"),t.TgZ(14,"div",2)(15,"div",5)(16,"table",6)(17,"tbody")(18,"tr")(19,"td"),t._uU(20,"Type"),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA()(),t.TgZ(23,"tr")(24,"td"),t._uU(25,"Entry Type:"),t.qZA(),t.TgZ(26,"td"),t._uU(27),t.qZA()(),t.TgZ(28,"tr")(29,"td"),t._uU(30,"Related To:"),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA()(),t.TgZ(33,"tr")(34,"td"),t._uU(35,"Priority:"),t.qZA(),t.TgZ(36,"td"),t._uU(37),t.ALo(38,"titlecase"),t.qZA()(),t.TgZ(39,"tr")(40,"td"),t._uU(41,"Status:"),t.qZA(),t.TgZ(42,"td"),t._uU(43),t.ALo(44,"titlecase"),t.qZA()()()()(),t.TgZ(45,"div",5)(46,"table",6)(47,"tbody")(48,"tr")(49,"td"),t._uU(50,"Reported By:"),t.qZA(),t.TgZ(51,"td"),t._uU(52),t.qZA()(),t.TgZ(53,"tr")(54,"td"),t._uU(55,"Ministry/Department:"),t.qZA(),t.TgZ(56,"td"),t._uU(57),t.qZA()(),t.TgZ(58,"tr")(59,"td"),t._uU(60,"Organization:"),t.qZA(),t.TgZ(61,"td"),t._uU(62),t.qZA()()()()(),t.TgZ(63,"div",5)(64,"table",6)(65,"tbody")(66,"tr")(67,"td"),t._uU(68,"Sector:"),t.qZA(),t.TgZ(69,"td"),t._uU(70),t.qZA()(),t.TgZ(71,"tr")(72,"td"),t._uU(73,"Scope:"),t.qZA(),t.TgZ(74,"td"),t._uU(75),t.qZA()()()()(),t.TgZ(76,"div")(77,"div",7)(78,"mat-card")(79,"mat-card-content")(80,"div",8)(81,"div",9)(82,"mat-icon",10),t._uU(83,"person_outline"),t.qZA()(),t.TgZ(84,"div"),t._uU(85," Created by "),t.TgZ(86,"strong"),t._uU(87),t.qZA(),t.TgZ(88,"p"),t._uU(89),t.ALo(90,"date"),t.qZA()()(),t._UZ(91,"hr")(92,"div",11),t.TgZ(93,"div",8),t.YNc(94,mt,2,0,"mat-icon",4),t.YNc(95,gt,5,5,"p",12),t.qZA()()()(),t.YNc(96,vt,30,16,"div",13),t.TgZ(97,"form",14),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(98,"div")(99,"label"),t._uU(100," Write your Reply: "),t.qZA(),t.TgZ(101,"app-rich-text-editor",15),t.NdJ("updatedDescription",function(c){return i.updatedDescription(c)}),t.qZA()(),t.TgZ(102,"mat-form-field",16)(103,"mat-label"),t._uU(104,"Status: "),t.qZA(),t.TgZ(105,"mat-select",17)(106,"mat-option",18),t._uU(107,"New"),t.qZA(),t.TgZ(108,"mat-option",18),t._uU(109,"In Progress"),t.qZA(),t.TgZ(110,"mat-option",18),t._uU(111,"Not Admissible"),t.qZA(),t.TgZ(112,"mat-option",18),t._uU(113,"Resolved"),t.qZA()()(),t.TgZ(114,"mat-radio-group",19)(115,"div",20)(116,"mat-label",21),t._uU(117,"Priority:"),t.qZA(),t.TgZ(118,"div",22)(119,"mat-radio-button",18),t._uU(120,"None"),t.qZA(),t.TgZ(121,"mat-radio-button",18),t._uU(122,"Low"),t.qZA(),t.TgZ(123,"mat-radio-button",18),t._uU(124,"Medium"),t.qZA(),t.TgZ(125,"mat-radio-button",18),t._uU(126,"High"),t.qZA()()()(),t.TgZ(127,"mat-radio-group",23)(128,"div",20)(129,"mat-label",21),t._uU(130,"Visibility:"),t.qZA(),t.TgZ(131,"div",22)(132,"mat-radio-button",18),t._uU(133,"Internal"),t.qZA(),t.TgZ(134,"mat-radio-button",18),t._uU(135,"Everyone"),t.qZA()()()(),t.TgZ(136,"mat-form-field",16)(137,"mat-label"),t._uU(138,"Assign to"),t.qZA(),t.TgZ(139,"mat-select",24),t.YNc(140,ht,2,2,"mat-option",25),t.qZA()(),t.TgZ(141,"div")(142,"app-fileuploader",26),t.NdJ("updatedFilesDescription",function(c){return i.updatedFilesDescription(c)}),t.qZA()(),t.TgZ(143,"div",27)(144,"button",28),t.NdJ("click",function(){return i.resetActivityLogForm()}),t._uU(145,"Cancel"),t.qZA(),t.TgZ(146,"button",29),t._uU(147," Post "),t.qZA()()()()()(),t.TgZ(148,"div",30),t.YNc(149,Dt,17,3,"ng-container",4),t.YNc(150,bt,10,2,"ng-container",4),t.YNc(151,St,8,0,"ng-container",4),t._UZ(152,"hr"),t.TgZ(153,"div",31)(154,"mat-icon",32),t._uU(155,"folder_shared"),t.qZA(),t.TgZ(156,"h3",33),t._uU(157,"Assigned To"),t.qZA()(),t.TgZ(158,"div",8)(159,"div",34)(160,"mat-icon",10),t._uU(161,"person_outline"),t.qZA()(),t.TgZ(162,"strong"),t._uU(163),t.qZA()(),t._UZ(164,"hr"),t.TgZ(165,"div",8)(166,"div",8)(167,"mat-icon"),t._uU(168," date_range"),t.qZA(),t.TgZ(169,"h4"),t._uU(170),t.ALo(171,"date"),t.qZA(),t.TgZ(172,"button",35)(173,"mat-icon"),t._uU(174,"edit"),t.qZA(),t.TgZ(175,"mat-menu",null,36)(177,"button",37),t._uU(178),t.ALo(179,"date"),t.qZA(),t.TgZ(180,"button",37),t._uU(181),t.qZA(),t.TgZ(182,"button",37),t._uU(183),t.ALo(184,"date"),t.qZA()()(),t.TgZ(185,"button",35)(186,"mat-icon"),t._uU(187,"view_headline"),t.qZA()()(),t.TgZ(188,"mat-menu",null,38)(190,"button",39),t.NdJ("click",function(){return i.dueDateSetter("noDueDate")}),t._uU(191," No Due Date "),t.qZA(),t.TgZ(192,"button",39),t.NdJ("click",function(){return i.dueDateSetter("Today")}),t._uU(193,"Today"),t.qZA(),t.TgZ(194,"button",39),t.NdJ("click",function(){return i.dueDateSetter("Tomorrow")}),t._uU(195," Tomorrow "),t.qZA(),t.TgZ(196,"button",39),t.NdJ("click",function(){return i.dueDateSetter("Next Monday")}),t._uU(197," Next Monday "),t.qZA(),t.TgZ(198,"button",39),t.NdJ("click",function(){return i.dueDateSetter("This Friday")}),t._uU(199," This Friday "),t.qZA(),t.TgZ(200,"mat-label"),t._uU(201,"Choose a date"),t.qZA(),t.TgZ(202,"input",40),t.NdJ("dateChange",function(c){return i.dueDateSetter("custom",c)}),t.qZA(),t._UZ(203,"mat-datepicker-toggle",41)(204,"mat-datepicker",null,42),t.qZA()(),t._UZ(206,"hr"),t.TgZ(207,"div",43)(208,"mat-icon"),t._uU(209,"attach_file"),t.qZA(),t.TgZ(210,"h3",44),t._uU(211),t.qZA(),t.YNc(212,xt,6,9,"div",12),t.qZA(),t._UZ(213,"hr"),t.TgZ(214,"div",8)(215,"mat-icon"),t._uU(216,"timeline"),t.qZA(),t.TgZ(217,"h3",45),t._uU(218,"Activities"),t.qZA()(),t.TgZ(219,"div")(220,"div")(221,"strong"),t._uU(222,"Created:"),t.qZA(),t._uU(223),t.ALo(224,"date"),t.qZA(),t.YNc(225,Nt,6,5,"div",46),t.qZA(),t._UZ(226,"hr"),t.TgZ(227,"div",8)(228,"mat-icon"),t._uU(229," people"),t.qZA(),t.TgZ(230,"h3",45),t._uU(231,"People Involved"),t.qZA()(),t.YNc(232,kt,4,1,"div",47),t.qZA()()()),2&e){const o=t.MAs(176),c=t.MAs(189),s=t.MAs(205);t.xp6(7),t.Oqu(t.lcZ(8,51,null==i.activityData?null:i.activityData.title)),t.xp6(3),t.hij(" Last updated on ",t.xi3(11,53,null==i.activityData?null:i.activityData.createdAt,"medium")," "),t.xp6(2),t.Q6J("ngIf",(null==i.activityData?null:i.activityData.activityLog.length)>=1),t.xp6(10),t.Oqu(i.activityType),t.xp6(5),t.Oqu(i.activityEntryType),t.xp6(5),t.Oqu(i.activityRelatedTypesData),t.xp6(4),t.Tol(i.statusClass(null==i.activityData?null:i.activityData.priority)),t.xp6(1),t.Oqu(t.lcZ(38,56,null==i.activityData?null:i.activityData.priority)),t.xp6(6),t.Oqu(t.lcZ(44,58,null==i.activityData?null:i.activityData.status)),t.xp6(9),t.Oqu(i.activityReportedBy),t.xp6(5),t.hij(" ",i.ministryName," "),t.xp6(5),t.Oqu(i.organizationCreatedBy),t.xp6(8),t.Oqu(i.activitySectorsData),t.xp6(5),t.Oqu(i.ActivityScopeData),t.xp6(12),t.Oqu(i.activityReportedBy),t.xp6(2),t.Oqu(t.xi3(90,60,null==i.activityData?null:i.activityData.createdAt,"medium")),t.xp6(3),t.Q6J("innerHTML",null==i.activityData?null:i.activityData.description,t.oJD),t.xp6(2),t.Q6J("ngIf",(null==i.activityData||null==i.activityData.attachments?null:i.activityData.attachments.length)>=1),t.xp6(1),t.Q6J("ngForOf",null==i.activityData?null:i.activityData.attachments),t.xp6(1),t.Q6J("ngForOf",i.activityLogData),t.xp6(1),t.Q6J("formGroup",i.activityLogForm),t.xp6(9),t.Q6J("value",i.status[0]),t.xp6(2),t.Q6J("value",i.status[1]),t.xp6(2),t.Q6J("value",i.status[2]),t.xp6(2),t.Q6J("value",i.status[3]),t.xp6(7),t.Q6J("value",i.Priority[0]),t.xp6(2),t.Q6J("value",i.Priority[1]),t.xp6(2),t.Q6J("value",i.Priority[2]),t.xp6(2),t.Q6J("value",i.Priority[3]),t.xp6(7),t.Q6J("value",i.visibility[0]),t.xp6(2),t.Q6J("value",i.visibility[1]),t.xp6(6),t.Q6J("ngForOf",i.organizationList),t.xp6(6),t.Q6J("disabled",""===i.description),t.xp6(3),t.Q6J("ngIf",i.isSuperAdmin),t.xp6(1),t.Q6J("ngIf",i.logedInUserId==i.selectedActivityCreatedById),t.xp6(1),t.Q6J("ngIf",i.isAssignee&&(null==i.activityData?null:i.activityData.createdByOrganization)!=(null==i.activityData?null:i.activityData.organizationData[0]._id)&&i.isSuperAdmin),t.xp6(12),t.hij(" ",i.selectedActivityAssignedTo,""),t.xp6(7),t.Oqu(null!=i.activityData&&i.activityData.dueDate?t.xi3(171,63,null==i.activityData?null:i.activityData.dueDate,"medium"):"No DueDate"),t.xp6(2),t.Q6J("matMenuTriggerFor",c),t.xp6(6),t.hij(" Due Date ",t.xi3(179,66,null==i.activityData?null:i.activityData.dueDate,"medium")," "),t.xp6(3),t.hij("Updated by",null==i.activityData?null:i.activityData.updatedBy,""),t.xp6(2),t.hij(" Created At ",t.xi3(184,69,null==i.activityData?null:i.activityData.createdAt,"medium")," "),t.xp6(2),t.Q6J("matMenuTriggerFor",o),t.xp6(17),t.Q6J("matDatepicker",s),t.xp6(1),t.Q6J("for",s),t.xp6(8),t.hij(" ",0==(null==i.activityData||null==i.activityData.attachments?null:i.activityData.attachments.length)?"No Files in this Activity":"Files in this Activity"," "),t.xp6(1),t.Q6J("ngForOf",null==i.activityData?null:i.activityData.attachments),t.xp6(11),t.hij(" ",t.xi3(224,72,null==i.activityData?null:i.activityData.createdAt,"medium")," "),t.xp6(2),t.Q6J("ngForOf",i.ActivityTimeLogs),t.xp6(7),t.Q6J("ngForOf",i.organizationsInvolved)}},dependencies:[u.sg,u.O5,l._Y,l.JJ,l.JL,l.sg,l.u,k.ey,O.lW,G.a8,G.dn,h.Mq,h.hl,h.nW,q.Hw,y.KE,y.hX,J.Nt,D.VK,D.OP,D.p6,F.VQ,F.U0,H.gD,$.gM,j,V,u.JJ,u.rS,u.uU],styles:[".mat-Icon[_ngcontent-%COMP%]{font-size:50px;width:50px;height:50px}.padding[_ngcontent-%COMP%]{min-width:30px;padding:0;border-radius:5px}.img-span[_ngcontent-%COMP%]{height:50px;width:50px;background-color:#bbb;border-radius:50%;text-align:center}.mat-i[_ngcontent-%COMP%]{font-size:40px;height:50px;width:50px;opacity:.5}h3[_ngcontent-%COMP%]{margin:0}.kit[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{opacity:.7}hr[_ngcontent-%COMP%]{opacity:.1}.text[_ngcontent-%COMP%]{color:#b1b1b1}.date-icon[_ngcontent-%COMP%]{min-width:30px;padding:0}.redText[_ngcontent-%COMP%]{color:#b54b4b}.blueText[_ngcontent-%COMP%]{color:#7979c4}"]}),a})();var Ut=r(5017),g=r(3626),K=r(8739),qt=r(8202),Ft=r(5150),z=r(6308);const Et={Filters:[{DisplayName:"Created Date",key:"createddate"},{DisplayName:"Due Date",key:"duedate"},{DisplayName:"Status",key:"status"},{DisplayName:"Types",key:"types"},{DisplayName:"Entry Type",key:"entrytype"},{DisplayName:"Sectors",key:"sector"},{DisplayName:"Scope",key:"scope"},{DisplayName:"Priority",key:"priority"},{DisplayName:"Created BY",key:"createdby"},{DisplayName:"Assigned To",key:"assignedto"}],createddate:[{DisplayName:"AnyTime",key:"ALL"},{DisplayName:"PastHour",key:{unit:"H",quantity:1}},{DisplayName:"Past 24 hours",key:{unit:"H",quantity:24}},{DisplayName:"Past Week",key:{unit:"W",quantity:1}},{DisplayName:"Past Month",key:{unit:"M",quantity:1}},{DisplayName:"Past Year",key:{unit:"Y",quantity:1}},{DisplayName:"Custom Range",key:{unit:"R",range:{from:"",to:""}}}],duedate:[{DisplayName:"Any Time",key:"ALL"},{DisplayName:"OverDue",key:"OVERDUE"},{DisplayName:"Today",key:"TODAY"},{DisplayName:"Custom Range",key:"R"}],status:[{DisplayName:"All",key:"ALL"},{DisplayName:"Not Admissible",key:"REJECTED"},{DisplayName:"New",key:"NEW"},{DisplayName:"In Progress",key:"INPROGRESS"},{DisplayName:"Resolved",key:"RESOLVED"}],priority:[{DisplayName:"None",key:"NONE"},{DisplayName:"Low",key:"LOW"},{DisplayName:"Medium",key:"MEDIUM"},{DisplayName:"High",key:"HIGH"}],createdby:[],assignedto:[],groupBy:[{DisplayName:"Due Date",key:"dueDate"},{DisplayName:"Status",key:"status"},{DisplayName:"Priority",key:"priority"},{DisplayName:"Assigned to",key:"assignTo"}],sortBy:[{DisplayName:"Tittle",key:"title"},{DisplayName:"Activity#",key:"activity"},{DisplayName:"Due Date",key:"dueDate"},{DisplayName:"Assigned to",key:"assignTo"}]};var Mt=r(6709),w=r(3848);function It(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-radio-button",48),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.filterActivityListData("createdDate",o))}),t._uU(1),t.qZA()}if(2&a){const e=n.$implicit;t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Jt(a,n){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid start date"),t.qZA())}function Rt(a,n){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid end date"),t.qZA())}const W=function(){return{width:"180px"}};function zt(a,n){if(1&a&&(t.TgZ(0,"mat-form-field",49),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-label"),t._uU(2,"Enter date"),t.qZA(),t.TgZ(3,"mat-date-range-input",50),t._UZ(4,"input",51)(5,"input",52),t.qZA(),t._UZ(6,"mat-datepicker-toggle",53)(7,"mat-date-range-picker",null,54),t.YNc(9,Jt,2,0,"mat-error",29),t.YNc(10,Rt,2,0,"mat-error",29),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw();t.Q6J("ngStyle",t.DdM(6,W)),t.xp6(3),t.Q6J("formGroup",i.customCreatedDate)("rangePicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.customCreatedDate.controls.fromDate.hasError("matStartDateInvalid")),t.xp6(1),t.Q6J("ngIf",i.customCreatedDate.controls.toDate.hasError("matEndDateInvalid"))}}function wt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-radio-button",48),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.filterActivityListData("dueDate",o))}),t._uU(1),t.qZA()}if(2&a){const e=n.$implicit;t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Pt(a,n){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid start date"),t.qZA())}function Lt(a,n){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid end date"),t.qZA())}function Qt(a,n){if(1&a&&(t.TgZ(0,"mat-form-field",49),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-label"),t._uU(2,"Enter date"),t.qZA(),t.TgZ(3,"mat-date-range-input",50),t._UZ(4,"input",51)(5,"input",52),t.qZA(),t._UZ(6,"mat-datepicker-toggle",53)(7,"mat-date-range-picker",null,55),t.YNc(9,Pt,2,0,"mat-error",29),t.YNc(10,Lt,2,0,"mat-error",29),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw();t.Q6J("ngStyle",t.DdM(6,W)),t.xp6(3),t.Q6J("formGroup",i.customDueDate)("rangePicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.customDueDate.controls.fromDate.hasError("matStartDateInvalid")),t.xp6(1),t.Q6J("ngIf",i.customDueDate.controls.toDate.hasError("matEndDateInvalid"))}}function Yt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",11),t.NdJ("click",function(o){return o.stopPropagation()}),t.TgZ(1,"section",56)(2,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"status"))}),t._uU(3),t.qZA()()()}if(2&a){const e=n.$implicit;t.xp6(2),t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Bt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"section",56)(1,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"types"))}),t._uU(2),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(1),t.s9C("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function Gt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"section",56)(1,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"entryType"))}),t._uU(2),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(1),t.s9C("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function Ht(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"section",56)(1,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"sectors"))}),t._uU(2),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(1),t.s9C("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function $t(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"section",56)(1,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"scope"))}),t._uU(2),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(1),t.s9C("value",e._id),t.xp6(1),t.hij(" ",e.name," ")}}function jt(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"div",11),t.NdJ("click",function(o){return o.stopPropagation()}),t.TgZ(1,"section",56)(2,"mat-checkbox",57),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(c.activityListFilterOnChanged(o,"priority"))}),t._uU(3),t.qZA()()()}if(2&a){const e=n.$implicit;t.xp6(2),t.s9C("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Vt(a,n){if(1&a&&(t.TgZ(0,"div",11),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"section",56)(2,"mat-checkbox",58),t._uU(3),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(3),t.hij(" ",e," ")}}function Kt(a,n){if(1&a&&(t.TgZ(0,"div",11),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"section",56)(2,"mat-checkbox",58),t._uU(3),t.qZA()()()),2&a){const e=n.$implicit;t.xp6(3),t.hij(" ",e," ")}}function Wt(a,n){if(1&a&&(t.TgZ(0,"mat-option"),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Xt(a,n){if(1&a&&(t.TgZ(0,"mat-option"),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function te(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"assignment"),t.qZA(),t._uU(2," All Tasks "))}function ee(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"assignment_ind"),t.qZA(),t._uU(2," My Tasks "))}function ie(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"hourglass_empty"),t.qZA(),t._uU(2," Overdue "))}function ae(a,n){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"wb_incandescent"),t.qZA(),t._uU(2," High Priority "))}function ne(a,n){1&a&&(t.TgZ(0,"div")(1,"mat-tab"),t.YNc(2,ae,3,0,"ng-template",28),t.qZA()())}function oe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"th",59)(1,"mat-checkbox",60),t.NdJ("change",function(o){t.CHM(e);const c=t.oxw();return t.KtG(o?c.toggleAllRows():null)}),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function ce(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",61)(1,"mat-checkbox",62),t.NdJ("click",function(o){return o.stopPropagation()})("change",function(o){const s=t.CHM(e).$implicit,p=t.oxw();return t.KtG(o?p.selection.toggle(s):null)}),t.qZA(),t.TgZ(2,"button",63),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.generateActivityRowActions(c.status,c))}),t.TgZ(3,"mat-icon"),t._uU(4,"arrow_drop_down"),t.qZA()()()}if(2&a){const e=n.$implicit,i=t.oxw(),o=t.MAs(124);t.xp6(1),t.Q6J("checked",i.selection.isSelected(e))("aria-label",i.checkboxLabel(e)),t.xp6(1),t.Q6J("matMenuTriggerFor",o)}}function re(a,n){1&a&&t._UZ(0,"th",64)}function se(a,n){if(1&a&&(t.TgZ(0,"td",61),t._uU(1),t.ALo(2,"titlecase"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,e.status)," ")}}function le(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," Activity "),t.qZA())}function pe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",65),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.navigateToActivityDetails(c._id))}),t._uU(1),t.qZA()}if(2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.activityType," ")}}function ue(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," Title "),t.qZA())}function de(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",65),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.navigateToActivityDetails(c._id))}),t._uU(1),t.qZA()}if(2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.title," ")}}function me(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," Priority "),t.qZA())}function ge(a,n){if(1&a&&(t.TgZ(0,"td",61),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.priority," ")}}function _e(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," Due date "),t.qZA())}function ye(a,n){if(1&a&&(t.TgZ(0,"td",61),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.updatedAt,"fullDate")," ")}}function ve(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," Assignto "),t.qZA())}function he(a,n){if(1&a&&(t.TgZ(0,"td",61),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.xp6(1),t.hij(" ",e.assignto," ")}}function Ae(a,n){1&a&&(t.TgZ(0,"th",64),t._uU(1," actions "),t.qZA())}function fe(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"td",61)(1,"mat-icon",66),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.navigateToActivityDetails(c._id))}),t._uU(2,"keyboard_arrow_right icon"),t.qZA()()}}function Te(a,n){1&a&&t._UZ(0,"tr",67)}function De(a,n){1&a&&t._UZ(0,"tr",68)}function Ze(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",70),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.onActivityRowActionClick(c.action))}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.title)}}function Ce(a,n){if(1&a&&(t.ynx(0),t.YNc(1,Ze,5,2,"button",69),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.activityRowActionByStatus)}}function be(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"button",70),t.NdJ("click",function(){const c=t.CHM(e).$implicit,s=t.oxw(2);return t.KtG(s.onActivityRowActionClick(c.action))}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&a){const e=n.$implicit;t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.title)}}function Se(a,n){if(1&a&&(t.ynx(0),t.YNc(1,be,5,2,"button",69),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.userActivityRowActionByStatus)}}const X=new Date;X.getMonth(),X.getFullYear();let xe=(()=>{class a{constructor(e,i,o,c,s,p){this.activityService=e,this.storageService=i,this.router=o,this.userDetailsService=c,this.alertpopupService=s,this.confirmationDialogService=p,this.activityId="",this.displayedColumns=["select","Status","Activity","Title","Priority","Duedate","Assignto","actions"],this.activityFiltersData=Et,this.currentStatus=v,this.superAdminActivityRowActions=it,this.userActivityRowActions=at,this.statusEnums=v,this.activitylist=[],this.filter=qt.t,this.customPage=Ft.Z,this.isSuperAdmin=!1,this.isShowCustomCreatedDate=!1,this.isShowCustomDueDate=!1,this.selection=new Ut.Ov(!0,[]),this.filters={types:[],status:[],entryType:[],scope:[],priority:[],sectors:[]},this.customCreatedDate=new l.cw({fromDate:new l.NI(null),toDate:new l.NI(null)}),this.customDueDate=new l.cw({fromDate:new l.NI(null),toDate:new l.NI(null)}),this.createdDate=new l.NI,this.dueDte=new l.NI,this.activitySearchCriteriaPayload={pageNumber:0,pageSize:20,sortField:"",sortOrder:0}}ngOnInit(){this.getAllActivities(),this.getAcivityMasterData(),this.isSuperAdmin=this.storageService.getDataFromLocalStorage(Z.I.ROLE)===E.G.SuperAdmin,this.getLogedinUserDetails(),this.customCreatedDate.valueChanges.subscribe(e=>{null!==e.fromDate&&null!==e.toDate&&(this.activitySearchCriteriaPayload={...this.activitySearchCriteriaPayload,createdDate:{unit:"R",range:{from:e.fromDate?.toISOString(),to:e.toDate?.toISOString()}}})}),this.customDueDate.valueChanges.subscribe(e=>{null!==e.fromDate&&null!==e.toDate&&(this.activitySearchCriteriaPayload={...this.activitySearchCriteriaPayload,dueDate:{unit:"R",range:{from:e.fromDate?.toISOString(),to:e.toDate?.toISOString()}}})})}getLogedinUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.logedInUserDetails=e})}downloadFile(){}isAllSelected(){const i=this.dataSource?.data.length;return this.selection.selected.length===i}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}getAllActivities(){this.activityService.getAllActivities().subscribe(e=>{this.dataSource=new g.by(e.data),this.dataSource.paginator=this.paginator})}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort)}onChangedPageSize(e){console.log(e)}sortChange(e){console.log(e)}getAcivityMasterData(){this.activityService.getActivityMastarData().subscribe(e=>{e.data&&(this.masterData=e.data)})}navigateToActivityDetails(e){this.router.navigate([S.p.ACTIVITY_DETAILS],{queryParams:{aId:e}})}generateActivityRowActions(e,i){this.selectedActivtyForRowActions=i,this.activityRowActionByStatus=this.superAdminActivityRowActions[e],this.userActivityRowActionByStatus=this.userActivityRowActions.filter(o=>o.displayCondition(i,this.logedInUserDetails))}onActivityRowActionClick(e){switch(e){case"NEW":case"INPROGRESS":case"RESOLVED":case"REJECTED":this.updateActivityStatus(e);break;case"REPLAY":this.navigateToActivityDetails(this.selectedActivtyForRowActions._id);break;case"ARCHIVE":this.updateArchivestatus();break;case"DELETE":this.deleteActivityByActivityId();break;case"MOVE_TO_ORGANIZATION":this.activityService.openMoveToOrganizationPopup(this.selectedActivtyForRowActions._id).afterClosed().subscribe(i=>{console.log(i)})}}updateActivityStatus(e){this.confirmationDialogService.open({message:`Are you sure to change status to ${e}`}).afterClosed().subscribe(i=>{i&&this.activityService.updateActivityStatus(this.selectedActivtyForRowActions._id,{status:e}).subscribe(o=>{this.alertpopupService.open({message:"Activity Status Updated Successfully",action:"ok"}),this.getAllActivities()})},i=>{this.alertpopupService.open({message:i.message?i.message:"Unable to update Activity status",action:"ok"})})}updateArchivestatus(){this.confirmationDialogService.open({message:"Are you sure to Archive the activity"}).afterClosed().subscribe(e=>{e&&this.activityService.updateArchivestatus(this.selectedActivtyForRowActions._id,{isArchive:!0}).subscribe(i=>{this.alertpopupService.open({message:"Activity Archived Successfully",action:"ok"}),this.getAllActivities()})},e=>{this.alertpopupService.open({message:e.message?e.message:"Unable to archive Activity status",action:"ok"})})}deleteActivityByActivityId(){this.confirmationDialogService.open({message:"Are you sure to Delete activity"}).afterClosed().subscribe(e=>{e&&this.activityService.deleteSelectedActivity(this.selectedActivtyForRowActions._id).subscribe(i=>{this.alertpopupService.open({message:"Activity Deleted Successfully",action:"ok"}),this.getAllActivities()})},e=>{this.alertpopupService.open({message:e.message?e.message:"Unable to delete Activity status",action:"ok"})})}filterActivityListData(e,i){switch(e){case"createdDate":console.log(i?.source?.value);const o=i?.source?.value;"R"===o?.unit?this.isShowCustomCreatedDate=!0:this.activitySearchCriteriaPayload="ALL"===o?{...this.activitySearchCriteriaPayload,createdDate:""}:{...this.activitySearchCriteriaPayload,createdDate:o},console.log(this.activitySearchCriteriaPayload);break;case"dueDate":const c=i?.source?.value;"R"===c?this.isShowCustomDueDate=!0:this.activitySearchCriteriaPayload="ALL"===c?{...this.activitySearchCriteriaPayload,dueDate:""}:{...this.activitySearchCriteriaPayload,dueDate:c}}}activityListFilterOnChanged(e,i){if(e.checked)this.filters[i].push(e.source.value);else{let o=this.filters[i].findIndex(c=>c===e.source.value);this.filters[i].splice(o,1)}this.activitySearchCriteriaPayload={...this.activitySearchCriteriaPayload,...this.filters},console.log(this.activitySearchCriteriaPayload)}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(U),t.Y36(N.V),t.Y36(A.F0),t.Y36(R.H),t.Y36(C.z),t.Y36(I.O))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity"]],viewQuery:function(e,i){if(1&e&&(t.Gf(K.NW,5),t.Gf(z.YE,5)),2&e){let o;t.iGM(o=t.CRH())&&(i.paginator=o.first),t.iGM(o=t.CRH())&&(i.sort=o.first)}},decls:127,vars:36,consts:[[1,"text-end"],["matTooltip","Download",1,"btn","btn-secondary","mx-1",3,"click"],[1,"icon-taskdownl"],["mat-button","","matTooltip","Filters",3,"matMenuTriggerFor"],["filters","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["createddate","matMenu"],["aria-labelledby","example-radio-group-label",1,"example-radio-group",3,"click"],["class","example-radio-button",3,"value","change",4,"ngFor","ngForOf"],["appearance","fill",3,"ngStyle","click",4,"ngIf"],["duedate","matMenu"],[3,"click"],["aria-labelledby","example-radio-group-label",1,"example-radio-group"],["status","matMenu"],[3,"click",4,"ngFor","ngForOf"],["types","matMenu"],["class","example-section",4,"ngFor","ngForOf"],["entrytype","matMenu"],["geography","matMenu"],["scope","matMenu"],["priority","matMenu"],["createdby","matMenu"],["assignto","matMenu"],["mat-button","","matTooltip","Group By",3,"matMenuTriggerFor"],["groupBymenu","matMenu"],[4,"ngFor","ngForOf"],["mat-button","","matTooltip","Sort By",3,"matMenuTriggerFor"],["sortby","matMenu"],["mat-tab-label",""],[4,"ngIf"],["mat-table","","matSort","",1,"mat-elevation-z8","userTable",3,"dataSource","matSortChange"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Status"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","Activity"],["mat-cell","","class","cursor",3,"click",4,"matCellDef"],["matColumnDef","Title"],["matColumnDef","Priority"],["matColumnDef","Duedate"],["matColumnDef","Assignto"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSize","length","pageSizeOptions","page"],["paginator",""],["menu","matMenu"],[1,"example-radio-button",3,"value","change"],["appearance","fill",3,"ngStyle","click"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","fromDate","placeholder","Start date"],["matEndDate","","formControlName","toDate","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["picker1",""],[1,"example-section"],[1,"example-margin",3,"value","change"],[1,"example-margin"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor","click"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",1,"cursor",3,"click"],[1,"cursor",3,"click"],["mat-header-row",""],["mat-row",""],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(e,i){if(1&e&&(t._UZ(0,"div"),t.TgZ(1,"div",0)(2,"span")(3,"div",1),t.NdJ("click",function(){return i.downloadFile()}),t._UZ(4,"i",2),t.TgZ(5,"mat-icon"),t._uU(6,"file_download"),t.qZA()()(),t.TgZ(7,"button",3),t._uU(8," Filters "),t.TgZ(9,"mat-icon"),t._uU(10," filter_alt"),t.qZA()(),t.TgZ(11,"mat-menu",null,4)(13,"button",5),t._uU(14,"Created Date"),t.qZA(),t.TgZ(15,"button",5),t._uU(16,"Due Date"),t.qZA(),t.TgZ(17,"button",5),t._uU(18,"Status"),t.qZA(),t.TgZ(19,"button",5),t._uU(20,"Types"),t.qZA(),t.TgZ(21,"button",5),t._uU(22,"Entry Type"),t.qZA(),t.TgZ(23,"button",5),t._uU(24,"Geography"),t.qZA(),t.TgZ(25,"button",5),t._uU(26,"Scope"),t.qZA(),t.TgZ(27,"button",5),t._uU(28,"Priority"),t.qZA(),t.TgZ(29,"button",5),t._uU(30,"Created by"),t.qZA(),t.TgZ(31,"button",5),t._uU(32,"Assigned to"),t.qZA()(),t.TgZ(33,"mat-menu",null,6)(35,"mat-radio-group",7),t.NdJ("click",function(c){return c.stopPropagation()}),t.YNc(36,It,2,2,"mat-radio-button",8),t.qZA(),t.YNc(37,zt,11,7,"mat-form-field",9),t.qZA(),t.TgZ(38,"mat-menu",null,10)(40,"div",11),t.NdJ("click",function(c){return c.stopPropagation()}),t.TgZ(41,"mat-radio-group",12),t.YNc(42,wt,2,2,"mat-radio-button",8),t.qZA(),t.YNc(43,Qt,11,7,"mat-form-field",9),t.qZA()(),t.TgZ(44,"mat-menu",null,13),t.YNc(46,Yt,4,2,"div",14),t.qZA(),t.TgZ(47,"mat-menu",null,15)(49,"div",11),t.NdJ("click",function(c){return c.stopPropagation()}),t.YNc(50,Bt,3,2,"section",16),t.qZA()(),t.TgZ(51,"mat-menu",null,17)(53,"div",11),t.NdJ("click",function(c){return c.stopPropagation()}),t.YNc(54,Gt,3,2,"section",16),t.qZA()(),t.TgZ(55,"mat-menu",null,18)(57,"div",11),t.NdJ("click",function(c){return c.stopPropagation()}),t.YNc(58,Ht,3,2,"section",16),t.qZA()(),t.TgZ(59,"mat-menu",null,19)(61,"div",11),t.NdJ("click",function(c){return c.stopPropagation()}),t.YNc(62,$t,3,2,"section",16),t.qZA()(),t.TgZ(63,"mat-menu",null,20),t.YNc(65,jt,4,2,"div",14),t.qZA(),t.TgZ(66,"mat-menu",null,21),t.YNc(68,Vt,4,1,"div",14),t.qZA(),t.TgZ(69,"mat-menu",null,22),t.YNc(71,Kt,4,1,"div",14),t.qZA(),t.TgZ(72,"button",23),t._uU(73,"Group By "),t.TgZ(74,"mat-icon"),t._uU(75,"filter_list"),t.qZA()(),t.TgZ(76,"mat-menu",null,24),t.YNc(78,Wt,2,1,"mat-option",25),t.qZA(),t.TgZ(79,"button",26),t._uU(80," Sort By"),t.TgZ(81,"mat-icon"),t._uU(82,"sort"),t.qZA()(),t.TgZ(83,"mat-menu",null,27),t.YNc(85,Xt,2,1,"mat-option",25),t.qZA()(),t.TgZ(86,"mat-tab-group")(87,"mat-tab"),t.YNc(88,te,3,0,"ng-template",28),t.qZA(),t.TgZ(89,"mat-tab"),t.YNc(90,ee,3,0,"ng-template",28),t.qZA(),t.TgZ(91,"mat-tab"),t.YNc(92,ie,3,0,"ng-template",28),t.qZA(),t.YNc(93,ne,3,0,"div",29),t.qZA(),t.TgZ(94,"table",30),t.NdJ("matSortChange",function(c){return i.sortChange(c)}),t.ynx(95,31),t.YNc(96,oe,2,3,"th",32),t.YNc(97,ce,5,3,"td",33),t.BQk(),t.ynx(98,34),t.YNc(99,re,1,0,"th",35),t.YNc(100,se,3,3,"td",33),t.BQk(),t.ynx(101,36),t.YNc(102,le,2,0,"th",35),t.YNc(103,pe,2,1,"td",37),t.BQk(),t.ynx(104,38),t.YNc(105,ue,2,0,"th",35),t.YNc(106,de,2,1,"td",37),t.BQk(),t.ynx(107,39),t.YNc(108,me,2,0,"th",35),t.YNc(109,ge,2,1,"td",33),t.BQk(),t.ynx(110,40),t.YNc(111,_e,2,0,"th",35),t.YNc(112,ye,3,4,"td",33),t.BQk(),t.ynx(113,41),t.YNc(114,ve,2,0,"th",35),t.YNc(115,he,2,1,"td",33),t.BQk(),t.ynx(116,42),t.YNc(117,Ae,2,0,"th",35),t.YNc(118,fe,3,0,"td",33),t.BQk(),t.YNc(119,Te,1,0,"tr",43),t.YNc(120,De,1,0,"tr",44),t.qZA(),t.TgZ(121,"mat-paginator",45,46),t.NdJ("page",function(c){return i.onChangedPageSize(c)}),t.qZA(),t.TgZ(123,"mat-menu",null,47),t.YNc(125,Ce,2,1,"ng-container",29),t.YNc(126,Se,2,1,"ng-container",29),t.qZA()),2&e){const o=t.MAs(12),c=t.MAs(34),s=t.MAs(39),p=t.MAs(45),d=t.MAs(48),_=t.MAs(52),f=t.MAs(56),L=t.MAs(60),Q=t.MAs(64),Y=t.MAs(67),Ye=t.MAs(70),Be=t.MAs(77),Ge=t.MAs(84);t.xp6(7),t.Q6J("matMenuTriggerFor",o),t.xp6(6),t.Q6J("matMenuTriggerFor",c),t.xp6(2),t.Q6J("matMenuTriggerFor",s),t.xp6(2),t.Q6J("matMenuTriggerFor",p),t.xp6(2),t.Q6J("matMenuTriggerFor",d),t.xp6(2),t.Q6J("matMenuTriggerFor",_),t.xp6(2),t.Q6J("matMenuTriggerFor",f),t.xp6(2),t.Q6J("matMenuTriggerFor",L),t.xp6(2),t.Q6J("matMenuTriggerFor",Q),t.xp6(2),t.Q6J("matMenuTriggerFor",Y),t.xp6(2),t.Q6J("matMenuTriggerFor",Ye),t.xp6(5),t.Q6J("ngForOf",i.activityFiltersData.createddate),t.xp6(1),t.Q6J("ngIf",i.isShowCustomCreatedDate),t.xp6(5),t.Q6J("ngForOf",i.activityFiltersData.duedate),t.xp6(1),t.Q6J("ngIf",i.isShowCustomDueDate),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.status),t.xp6(4),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityTypesData),t.xp6(4),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityEntryTypesData),t.xp6(4),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activitySectorsData),t.xp6(4),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityScopesData),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.priority),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.createdby),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.assignedto),t.xp6(1),t.Q6J("matMenuTriggerFor",Be),t.xp6(6),t.Q6J("ngForOf",i.activityFiltersData.groupBy),t.xp6(1),t.Q6J("matMenuTriggerFor",Ge),t.xp6(6),t.Q6J("ngForOf",i.activityFiltersData.sortBy),t.xp6(8),t.Q6J("ngIf",i.isSuperAdmin),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("pageSize",i.customPage.pageSize)("length",i.activitylist.length)("pageSizeOptions",i.customPage.pageSizeOptions),t.xp6(4),t.Q6J("ngIf",i.isSuperAdmin),t.xp6(1),t.Q6J("ngIf",!1===i.isSuperAdmin)}},dependencies:[u.sg,u.O5,u.PC,l.Fj,l.JJ,l.JL,l.sg,l.u,k.ey,O.lW,Mt.oG,h.nW,h.wx,h.zY,h.By,h._g,q.Hw,y.TO,y.KE,y.hX,y.R9,D.VK,D.OP,D.p6,K.NW,F.VQ,F.U0,z.YE,z.nU,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,w.SP,w.uD,w.uX,$.gM,u.rS,u.uU],styles:['@charset "UTF-8";md-select[_ngcontent-%COMP%]{background-color:#fff;color:#000;border:1px solid #666666}.userTable[_ngcontent-%COMP%]{width:100%}.userTable[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{background-color:#818dcf;color:#fff}.userTable[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{background:whitesmoke}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid rgb(206,202,202)}.example-section[_ngcontent-%COMP%]{margin:12px 0}.example-margin[_ngcontent-%COMP%]{margin:0 12px}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:15px 0;align-items:flex-start}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.blue-color[_ngcontent-%COMP%]{color:#00f}.new[_ngcontent-%COMP%], .resolved[_ngcontent-%COMP%], .not-admissible[_ngcontent-%COMP%], .in-progress[_ngcontent-%COMP%]{height:19px;width:-moz-fit-content;width:fit-content;background-color:#f19a91;color:#fff;text-align:center;padding:4px 9px}.in-progress[_ngcontent-%COMP%]{background-color:#8dc2f8}.not-admissible[_ngcontent-%COMP%]{background-color:#8ad6a3}.resolved[_ngcontent-%COMP%]{background-color:\\a0  #f3c788}.cursor[_ngcontent-%COMP%]{cursor:pointer}']}),a})();var Ne=r(4128),P=r(7331);function ke(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.organization)}}function Oe(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-form-field",4)(2,"mat-label"),t._uU(3,"organizations"),t.qZA(),t.TgZ(4,"mat-select",22),t.YNc(5,ke,2,2,"mat-option",6),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(5),t.Q6J("ngForOf",null==e.userDetails?null:e.userDetails.organizationsdata)}}function Ue(a,n){if(1&a&&(t.ynx(0),t.TgZ(1,"h3"),t._uU(2,"Organization : "),t.TgZ(3,"strong"),t._uU(4),t.qZA()(),t.BQk()),2&a){const e=t.oxw();t.xp6(4),t.Oqu(null==e.userDetails?null:e.userDetails.Name)}}function qe(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}function Fe(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(null==e?null:e.name)}}function Ee(a,n){1&a&&(t.TgZ(0,"mat-icon",26),t._uU(1,"cancel"),t.qZA())}function Me(a,n){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip",24),t.NdJ("removed",function(){const c=t.CHM(e).index,s=t.oxw();return t.KtG(s.removeChip(c))}),t._uU(1),t.YNc(2,Ee,2,0,"mat-icon",25),t.qZA()}if(2&a){const e=n.$implicit,i=t.oxw();t.Q6J("removable",i.removable),t.xp6(1),t.hij(" ",null==e?null:e.organization," "),t.xp6(1),t.Q6J("ngIf",i.removable)}}function Ie(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(null==e?null:e.organization)}}function Je(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function Re(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function ze(a,n){if(1&a&&(t.TgZ(0,"mat-option",23),t._uU(1),t.qZA()),2&a){const e=n.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}const we=[{path:"",component:xe},{path:"create",component:(()=>{class a{constructor(e,i,o,c,s,p,d,_){this.organizationService=e,this.formBuilder=i,this.activityService=o,this.alertpopupService=c,this.storageService=s,this.activatedRoute=p,this.userDetailsService=d,this.router=_,this.removable=!0,this.filesListArray=[],this.priority=x,this.status=v,this.activatedRoute.queryParams.subscribe(f=>{this.selectedActivityId=f.aId,console.log(this.selectedActivityId)})}ngOnInit(){this.generateAddNewUserForm(),this.getUserDetails(),this.selectedActivityId?this.forkJoinResult():(this.getAllOrganization(),this.getActivityMasterData())}forkJoinResult(){(0,Ne.D)([this.organizations$,this.activityMasterData$,this.activity$]).subscribe(e=>{this.organizationsData=e[0]?.organizations;const i=e[0]?.organizations.filter(o=>e[2].data[0]?.organizationData.find(c=>c._id===o._id));this.activityTypesData=e[1]?.data.activityTypesData,this.activityRelatedTypesData=e[1]?.data?.activityRelatedTypesData,this.activityEntryTypesData=e[1]?.data?.activityEntryTypesData,this.activitySectorsData=e[1]?.data?.activitySectorsData,this.activityScopesData=e[1]?.data?.activityScopesData,this.selectedActivityData=e[2]?.data[0],this.activityForm.controls.activityType.setValue(this.selectedActivityData?.activityType),this.activityForm.controls.activityRelatedTo.setValue(this.selectedActivityData?.activityRelatedTo),this.activityForm.controls.organization?.setValue(i),this.activityForm.controls.activitEntryType.setValue(this.selectedActivityData?.activitEntryType),this.activityForm.controls.activitySector.setValue(this.selectedActivityData?.activitySector),this.activityForm.controls.activityScope.setValue(this.selectedActivityData?.activityScope),this.activityForm.controls.title.setValue(this.selectedActivityData?.title)})}get organizations$(){return this.organizationService.getAllOrganizations()}getAllOrganization(){this.organizations$.subscribe(e=>{this.organizationsData=e?.organizations,this.organizationList=e?.organizations})}get activityMasterData$(){return this.activityService.getActivitiesMasterData()}getActivityMasterData(){this.activityService.getActivitiesMasterData().subscribe(e=>{this.activityTypesData=e?.data?.activityTypesData,this.activityRelatedTypesData=e?.data?.activityRelatedTypesData,this.activityEntryTypesData=e?.data?.activityEntryTypesData,this.activitySectorsData=e?.data?.activitySectorsData,this.activityScopesData=e?.data?.activityScopesData})}generateAddNewUserForm(){this.activityForm=this.formBuilder.group({activityType:["",m.kI.required],activityRelatedTo:["",m.kI.required],organization:["",m.kI.required],activitEntryType:["",m.kI.required],activitySector:["",m.kI.required],activityScope:["",m.kI.required],title:["",m.kI.required],createdByOrganization:["",m.kI.required]})}get activity$(){return this.activityService.getActivityById(this.selectedActivityId)}onSubmit(){if(this.selectedActivityId){const e={...this.activityForm.value,attachments:this.filesListArray,organization:this.selectedOrganizationValue,priority:x[0],status:v[0]};this.activityService.updateActivity(this.selectedActivityId,e).subscribe(i=>{this.alertpopupService.open({message:i.message?i.message:"Activity updated Successfully",action:"ok"})},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}else{this.selectedOrganizationValue=this.activityForm.get("organization")?.value.map(i=>i._id);const e={...this.activityForm.value,attachments:this.filesListArray,organization:this.selectedOrganizationValue,priority:x[0],status:v[0],description:this.descriptionOfTextEditor};this.activityService.postActivity(e).subscribe(i=>{this.alertpopupService.open({message:i.message?i.message:"Activity Created Successfully",action:"ok"}),this.router.navigate([S.p.ACTIVITY])},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}}relatedValue(e){"Multiple Ministries/Departments"===e.value&&(this.isMultipleOrganization=!1)}removeChip(e){let i=this.activityForm.controls.organization;i.value.splice(e,1),this.activityForm.controls.organization?.setValue(i.value)}removeFileChip(e){this.filesListArray.splice(e,1)}getUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.userDetails=e,1===this.userDetails?.organization?.length&&this.activityForm?.controls.createdByOrganization?.setValue(this.userDetails?.organization[0])})}updatedDescription(e){this.descriptionOfTextEditor=e}updatedFilesDescription(e){for(var i=0;i<e.length;i++)this.filesListArray.push({name:e[i].name,size:e[i].size.toString(),path:"string"})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(M.M),t.Y36(l.qu),t.Y36(U),t.Y36(C.z),t.Y36(N.V),t.Y36(A.gz),t.Y36(R.H),t.Y36(A.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-createactivity"]],decls:64,vars:11,consts:[[1,"container"],[1,"d-flex"],[3,"formGroup","ngSubmit"],[4,"ngIf"],["appearance","outline"],["formControlName","activityType"],[3,"value",4,"ngFor","ngForOf"],["formControlName","activityRelatedTo"],[3,"removable","removed",4,"ngFor","ngForOf"],[1,"mx-5"],["appearance","outline",1,"w-100-per"],["multiple","multiple","formControlName","organization"],["formControlName","activitEntryType"],["formControlName","activitySector"],["formControlName","activityScope"],[1,"row"],[1,"col-12"],["matInput","","placeholder","Add an activity here & hit enter...","input","","type","text","formControlName","title"],["value","",3,"updatedDescription"],[3,"updatedFilesDescription"],[1,"d-flex","justify-content-end"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["formControlName","createdByOrganization"],[3,"value"],[3,"removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(e,i){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3," note_add"),t.qZA(),t.TgZ(4,"h2"),t._uU(5,"Create Activity"),t.qZA()(),t.TgZ(6,"form",2),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(7,"div"),t.YNc(8,Oe,6,1,"ng-container",3),t.YNc(9,Ue,5,1,"ng-container",3),t.qZA(),t.TgZ(10,"div")(11,"mat-form-field",4)(12,"mat-label"),t._uU(13,"Type"),t.qZA(),t.TgZ(14,"mat-select",5),t.YNc(15,qe,2,2,"mat-option",6),t.qZA()()(),t.TgZ(16,"div",1)(17,"div")(18,"mat-form-field",4)(19,"mat-label"),t._uU(20,"Related To"),t.qZA(),t.TgZ(21,"mat-select",7),t.YNc(22,Fe,2,2,"mat-option",6),t.qZA()()(),t.TgZ(23,"div")(24,"mat-chip-list"),t.YNc(25,Me,3,3,"mat-chip",8),t.qZA()(),t.TgZ(26,"div",9)(27,"mat-form-field",10)(28,"mat-label"),t._uU(29,"Ministry/Department"),t.qZA(),t.TgZ(30,"mat-select",11),t.YNc(31,Ie,2,2,"mat-option",6),t.qZA()()()(),t.TgZ(32,"div")(33,"mat-form-field",4)(34,"mat-label"),t._uU(35,"Entry Type"),t.qZA(),t.TgZ(36,"mat-select",12),t.YNc(37,Je,2,2,"mat-option",6),t.qZA()()(),t.TgZ(38,"div",1)(39,"div")(40,"mat-form-field",4)(41,"mat-label"),t._uU(42,"Sector"),t.qZA(),t.TgZ(43,"mat-select",13),t.YNc(44,Re,2,2,"mat-option",6),t.qZA()()(),t.TgZ(45,"div",9)(46,"mat-form-field",4)(47,"mat-label"),t._uU(48,"Scope"),t.qZA(),t.TgZ(49,"mat-select",14),t.YNc(50,ze,2,2,"mat-option",6),t.qZA()()()(),t.TgZ(51,"div",15)(52,"mat-form-field",4)(53,"mat-label"),t._uU(54,"Title"),t.qZA(),t.TgZ(55,"div",16),t._UZ(56,"input",17),t.qZA()()(),t.TgZ(57,"div")(58,"app-rich-text-editor",18),t.NdJ("updatedDescription",function(c){return i.updatedDescription(c)}),t.qZA()(),t.TgZ(59,"div")(60,"app-fileuploader",19),t.NdJ("updatedFilesDescription",function(c){return i.updatedFilesDescription(c)}),t.qZA()(),t.TgZ(61,"div",20)(62,"button",21),t._uU(63,"Submit"),t.qZA()()()()),2&e){let o;t.xp6(6),t.Q6J("formGroup",i.activityForm),t.xp6(2),t.Q6J("ngIf",(null==i.userDetails||null==i.userDetails.organizationsdata?null:i.userDetails.organizationsdata.length)>1),t.xp6(1),t.Q6J("ngIf",1===(null==i.userDetails||null==i.userDetails.organizationsdata?null:i.userDetails.organizationsdata.length)),t.xp6(6),t.Q6J("ngForOf",i.activityTypesData),t.xp6(7),t.Q6J("ngForOf",i.activityRelatedTypesData),t.xp6(3),t.Q6J("ngForOf",null==(o=i.activityForm.get("organization"))?null:o.value),t.xp6(6),t.Q6J("ngForOf",i.organizationsData),t.xp6(6),t.Q6J("ngForOf",i.activityEntryTypesData),t.xp6(7),t.Q6J("ngForOf",i.activitySectorsData),t.xp6(6),t.Q6J("ngForOf",i.activityScopesData),t.xp6(12),t.Q6J("disabled",i.activityForm.invalid)}},dependencies:[u.sg,u.O5,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,k.ey,O.lW,P.qn,P.HS,P.qH,q.Hw,y.KE,y.hX,J.Nt,H.gD,j,V],styles:[".container[_ngcontent-%COMP%]{background-color:#fff}"]}),a})()},{path:"details",component:Ot}];let Pe=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[A.Bz.forChild(we),A.Bz]}),a})();var Le=r(8165);let Qe=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.ez,Pe,l.UX,Le.m,l.u5]}),a})()},8202:(tt,b,r)=>{r.d(b,{t:()=>u});const u={IS_ACTIVE:2,MINISTRIES:1,ASSOCIATION:0,INACTIVE:3,MY_PROFILE:4,CHANGE_PASSWORD:5,NOTIFICATIONS:6,EMAIL_REPORTS:7}}}]);
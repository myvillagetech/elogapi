"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[652],{7652:(K,S,l)=>{l.r(S),l.d(S,{ActivityModule:()=>ui});var u=l(6895),f=l(3060),d=l(4006),A=l(7030),z=l(7335),D=l(4025);const I=["NONE","LOW","MEDIUM","HIGH"],W=["INTERNAL","EVERYONE"],T=["NEW","INPROGRESS","REJECTED","REJECTED","RESOLVED"],X={NEW:[{title:"Start",icon:"play_circle_fill",action:"INPROGRESS"},{title:"Resolve",icon:"assistant_photo",action:"RESOLVED"},{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Edit",icon:"edit",action:"EDIT"},{title:"Move to Organization",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],INPROGRESS:[{title:"Resolve",icon:"assistant_photo",action:"RESOLVED"},{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],REJECTED:[{title:"Reopen",icon:"reply",action:"NEW"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}],RESOLVED:[{title:"Reject",icon:"cancel",action:"REJECTED"},{title:"Reply",icon:"reply",action:"REPLY"},{title:"Move to Organisation",icon:"skip_next",action:"MOVE_TO_ORGANIZATION"},{title:"Archive",icon:"archive",action:"ARCHIVE"},{title:"Delete",icon:"delete_sweep",action:"DELETE"}]},tt=[{title:"Start",icon:"play_circle_fill",action:"INPROGRESS",displayCondition:(a,o)=>"NEW"===a.status},{title:"Resolve",icon:"assistant_photo",action:"RESOLVED",displayCondition:(a,o)=>("INPROGRESS"===a.status||"NEW"===a.status)&&(a.createdBy===o._id||o.organization.includes(a.assignTo))},{title:"Reject",icon:"cancel",action:"REJECTED",displayCondition:(a,o)=>"REJECTED"!==a.status&&("NEW"===a.status&&a.createdBy===o._id||"INPROGRESS"===a.status&&a.createdBy===o._id||o.organization.includes(a.assignTo)||"RESOLVED"===a.status&&a.createdBy===o._id)},{title:"Reply",icon:"reply",action:"REPLY",displayCondition:(a,o)=>"REJECTED"!==a.status},{title:"Edit",icon:"edit",action:"EDIT",displayCondition:(a,o)=>"NEW"===a.status&&a.createdBy===o._id},{title:"Move to Organization",icon:"skip_next",action:"MOVE_TO_ORGANIZATION",displayCondition:(a,o)=>a.createdBy===o._id&&("NEW"===a.status||"INPROGRESS"===a.status)},{title:"Archive",icon:"archive",action:"ARCHIVE",displayCondition:(a,o)=>a.createdBy===o._id&&("NEW"===a.status||"INPROGRESS"===a.status)},{title:"Delete",icon:"delete_sweep",action:"DELETE",displayCondition:(a,o)=>"NEW"===a.status&&a.createdBy===o._id},{title:"Reopen",icon:"reply",action:"NEW",displayCondition:(a,o)=>"REJECTED"===a.status}],R=[{propertyName:"reportedBy",displayName:"Reported By"},{propertyName:"activityId",displayName:"Activity ID"},{propertyName:"entryType",displayName:"Entry Type"},{propertyName:"type",displayName:"Type of Issue"},{propertyName:"ministry",displayName:"Ministry/Department"},{propertyName:"assignedTo",displayName:"Assigned To"},{propertyName:"createdAt",displayName:"Created Date"},{propertyName:"dueDate",displayName:"Due Date"},{propertyName:"title",displayName:"Title"},{propertyName:"description",displayName:"Description"},{propertyName:"status",displayName:"Current Status"}];var t=l(4650),q=l(5641),P=l(4068),k=l(2653),Q=l(9642),et=l(1584);let L=(()=>{class a{constructor(){}downloadFile(e,i="data",n){let s=this.ConvertToCSV(e,n),c=new Blob(["\ufeff"+s],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),m=URL.createObjectURL(c);-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&r.setAttribute("target","_blank"),r.setAttribute("href",m),r.setAttribute("download",i+".csv"),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r)}ConvertToCSV(e,i){let n="object"!=typeof e?JSON.parse(e):e,s="",c="S.No,";for(let r in i)c+=i[r].displayName+",";c=c.slice(0,-1),s+=c+"\r\n";for(let r=0;r<n.length;r++){let m=r+1+"";for(let p in i)m+=","+n[r][i[p].propertyName];s+=m+"\r\n"}return s}}return a.\u0275fac=function(e){return new(e||a)},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var U=l(9690),O=l(9732),E=l(3238),w=l(4859),y=l(9602),F=l(7392),h=l(9549),Y=l(4144),C=l(8255),N=l(1948),B=l(4385),$=l(266),_=l(5869);let H=(()=>{class a{constructor(e){this.fb=e,this.value="<h3>Write Here....</h3>",this.updatedDescription=new t.vpe,this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]]}ngOnInit(){this.editor=new _.ML,this.editor.commands.focus().scrollIntoView().exec(),this.createformgroup(),this.richtextForm?.controls.description?.valueChanges.subscribe(e=>{this.updatedDescription.emit(e)})}createformgroup(){this.richtextForm=this.fb.group({description:[""]})}ngOnDestroy(){this.editor.destroy()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(d.qu))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-rich-text-editor"]],inputs:{value:"value"},outputs:{updatedDescription:"updatedDescription"},decls:3,vars:6,consts:[[3,"formGroup"],[3,"editor","toolbar"],["formControlName","description",3,"editor","placeholder","ngModel"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t._UZ(1,"ngx-editor-menu",1)(2,"ngx-editor",2),t.qZA()),2&e&&(t.Q6J("formGroup",i.richtextForm),t.xp6(1),t.Q6J("editor",i.editor)("toolbar",i.toolbar),t.xp6(1),t.Q6J("editor",i.editor)("placeholder","Type here...")("ngModel",i.value))},dependencies:[_.tP,_.Mn,d._Y,d.JJ,d.JL,d.sg,d.u]}),a})();function it(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"div",6)(1,"div",7)(2,"mat-icon"),t._uU(3,"insert_drive_file"),t.qZA()(),t.TgZ(4,"div",8)(5,"h4",9),t._uU(6),t.qZA(),t.TgZ(7,"p",10),t._uU(8),t.qZA()(),t.TgZ(9,"div",11),t.NdJ("click",function(){const s=t.CHM(e).index,c=t.oxw();return t.KtG(c.deleteFile(s))}),t.TgZ(10,"mat-icon"),t._uU(11,"delete_forever"),t.qZA()()()}if(2&a){const e=o.$implicit,i=t.oxw();t.xp6(6),t.hij(" ",null==e?null:e.name," "),t.xp6(2),t.hij(" ",i.formatBytes(null==e?null:e.size)," ")}}let G=(()=>{class a{constructor(e){this.alertpopupService=e,this.updatedFilesDescription=new t.vpe,this.value=!1,this.files=[]}onFileDropped(e){this.prepareFilesList(e)}ngOnChanges(e){!1===e.value.currentValue&&(this.files=[])}fileBrowseHandler(e){this.prepareFilesList(e)}deleteFile(e){this.files.splice(e,1);const i=new DataTransfer;for(let n=0;n<this.filesEvent.target.files.length;n++){const s=this.filesEvent.target.files[n];e!==n&&i.items.add(s)}this.filesEvent.target.files=i.files,this.updatedFilesDescription.emit(this.filesEvent)}prepareFilesList(e){for(const i of e?.target.files)"image/jpeg"==i.type||"text/plain"==i.type||"application/vnd.openxmlformats-officedocument.wordprocessingml.document"==i.type||"image/png"==i.type||"application/vnd.openxmlformats-officedocument.presentationml.presentation"==i.type||"application/pdf"==i.type||"csv"==i.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"==i.type||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"==i.type&&i.size<=10485760?this.files.push(i):this.alertpopupService.open({message:`${i.type} is not accept `,action:"ok"});this.filesEvent=e,this.updatedFilesDescription.emit(e)}formatBytes(e,i){if(0===e)return"0 Bytes";const s=i<=0?0:i||2,r=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,r)).toFixed(s))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][r]}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(k.z))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-fileuploader"]],inputs:{value:"value"},outputs:{updatedFilesDescription:"updatedFilesDescription"},features:[t.TTD],decls:13,vars:1,consts:[["appDnd","",1,"container",3,"fileDropped"],["type","file","id","fileDropRef","multiple","","accept","application/pdf,application/vnd.ms-excel, image/gif, image/jpeg, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.openxmlformats-officedocument.wordprocessingml.document, application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword application/vnd.ms-powerpoint",3,"change"],["fileDropRef",""],["for","fileDropRef"],[1,"files-list"],["class","single-file",4,"ngFor","ngForOf"],[1,"single-file"],[1,"file-icon",2,"width","50px"],[1,"info"],[1,"name"],[1,"size"],[1,"delete",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0),t.NdJ("fileDropped",function(s){return i.onFileDropped(s)}),t.TgZ(1,"input",1,2),t.NdJ("change",function(s){return i.fileBrowseHandler(s)}),t.qZA(),t.TgZ(3,"mat-icon"),t._uU(4,"upload_file"),t.qZA(),t.TgZ(5,"h3"),t._uU(6,"Drag and drop file here"),t.qZA(),t.TgZ(7,"h3"),t._uU(8,"or"),t.qZA(),t.TgZ(9,"label",3),t._uU(10,"Browse for file"),t.qZA()(),t.TgZ(11,"div",4),t.YNc(12,it,12,2,"div",5),t.qZA()),2&e&&(t.xp6(12),t.Q6J("ngForOf",i.files))},dependencies:[u.sg,F.Hw],styles:[".container[_ngcontent-%COMP%]{padding:2rem;text-align:center;border:dashed 1px #979797;position:relative;margin:0 auto;background-color:#fff}input[_ngcontent-%COMP%]{opacity:0;position:absolute;z-index:2;width:100%;height:100%;top:0;left:0;cursor:pointer}label[_ngcontent-%COMP%]{color:#fff;border-radius:21.5px;background-color:#db202f;padding:8px 16px}h3[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#38424c}.fileover[_ngcontent-%COMP%]{animation:shake 1s;animation-iteration-count:infinite}.files-list[_ngcontent-%COMP%]{margin-top:1.5rem}.single-file[_ngcontent-%COMP%]{display:flex;padding:.5rem;justify-content:space-between;align-items:center;border:dashed 1px #979797;margin-bottom:1rem;background-color:#fff}.delete[_ngcontent-%COMP%]{margin-left:.5rem;cursor:pointer;align-self:flex-end;display:flex;flex-grow:1}.name[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#353f4a;margin:0}.size[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#a4a4a4;margin:0;margin-bottom:.25rem}.info[_ngcontent-%COMP%]{width:100%}"]}),a})();function at(a,o){if(1&a&&(t.TgZ(0,"span")(1,"mat-icon"),t._uU(2," chat"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.Oqu(null==e.activityData?null:e.activityData.activityLog.length)}}function nt(a,o){if(1&a&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.hij("... + ",(null==e.organizationsInvolved?null:e.organizationsInvolved.length)-1," more")}}function ot(a,o){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"attach_file"),t.qZA())}function st(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"p",53),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.downloadActivityAttachment(s))}),t.TgZ(1,"mat-icon"),t._uU(2,"insert_drive_file"),t.qZA(),t._uU(3),t.ALo(4,"number"),t.qZA()}if(2&a){const e=o.$implicit;t.xp6(3),t.AsE("",null==e?null:e.name," ",t.xi3(4,2,(null==e?null:e.size)/1024,".2-2")," Kb ")}}function ct(a,o){1&a&&(t.TgZ(0,"mat-icon"),t._uU(1,"attach_file"),t.qZA())}function rt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"p",53),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.downloadAttachment(c,s))}),t.TgZ(1,"mat-icon"),t._uU(2,"insert_drive_file"),t.qZA(),t._uU(3),t.ALo(4,"number"),t.qZA()}if(2&a){const e=o.$implicit;t.xp6(3),t.AsE("",null==e?null:e.name," ",t.xi3(4,2,(null==e?null:e.size)/1024,".2-2")," Kb ")}}function lt(a,o){if(1&a&&(t.TgZ(0,"div",9)(1,"div",40)(2,"div",10)(3,"mat-icon",11),t._uU(4,"account_circle"),t.qZA(),t.TgZ(5,"div",12),t._uU(6),t.TgZ(7,"p"),t._uU(8),t.ALo(9,"date"),t.qZA()()(),t.TgZ(10,"span",55)(11,"strong"),t._uU(12),t.ALo(13,"titlecase"),t.qZA()(),t.TgZ(14,"div")(15,"p"),t._uU(16),t.ALo(17,"titlecase"),t.qZA()(),t.TgZ(18,"div")(19,"p"),t._uU(20),t.qZA()()(),t._UZ(21,"div",13),t.TgZ(22,"div",10),t.YNc(23,ct,2,0,"mat-icon",4),t.TgZ(24,"div"),t.YNc(25,rt,5,5,"p",14),t.qZA()()()),2&a){const e=t.oxw().$implicit,i=t.oxw();t.xp6(6),t.hij(" Created by ",e.createdByUserName," "),t.xp6(2),t.Oqu(t.xi3(9,8,e.updatedAt,"medium")),t.xp6(4),t.Oqu(t.lcZ(13,11,e.title)),t.xp6(4),t.hij("Status: ",t.lcZ(17,13,e.status),""),t.xp6(4),t.hij("Assigned To: ",i.selectedActivityAssignedTo," "),t.xp6(1),t.Q6J("innerHTML",e.message,t.oJD),t.xp6(2),t.Q6J("ngIf",(null==e||null==e.attachments?null:e.attachments.length)>=1),t.xp6(2),t.Q6J("ngForOf",null==e?null:e.attachments)}}function dt(a,o){if(1&a&&(t.TgZ(0,"div",8),t.YNc(1,lt,26,15,"div",54),t.qZA()),2&a){const e=o.$implicit,i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.isShowActivityLog(e))}}function pt(a,o){if(1&a&&(t.TgZ(0,"mat-option",24),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.hij(" ",e.organization,"")}}function ut(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",64),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.updateActivityDetails())}),t.TgZ(1,"mat-icon"),t._uU(2,"edit"),t.qZA()()}}function mt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.updateStatusOfSelectedActivity("Resolve"))}),t.TgZ(1,"mat-icon"),t._uU(2,"assistant_photo"),t.qZA()()}}function _t(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",66),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.updateStatusOfSelectedActivity("Reject"))}),t.TgZ(1,"mat-icon"),t._uU(2,"checkmark"),t.qZA()()}}function gt(a,o){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",56)(2,"button",57),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.YNc(5,ut,3,0,"button",58),t.TgZ(6,"button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.updateSelectedArchiveStatus())}),t.TgZ(7,"mat-icon"),t._uU(8,"archive"),t.qZA()(),t.TgZ(9,"button",60),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.deleteSelectedActivity())}),t.TgZ(10,"mat-icon"),t._uU(11,"delete"),t.qZA()(),t.YNc(12,mt,3,0,"button",61),t.YNc(13,_t,3,0,"button",62),t.TgZ(14,"button",63),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.downloadActivity())}),t.TgZ(15,"mat-icon"),t._uU(16,"download"),t.qZA()()(),t.BQk()}if(2&a){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)),t.xp6(7),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"INPROGRESS"===(null==e.activityData?null:e.activityData.status)),t.xp6(1),t.Q6J("ngIf","REJECTED"!==(null==e.activityData?null:e.activityData.status))}}function vt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",59),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.updateSelectedArchiveStatus())}),t.TgZ(1,"mat-icon"),t._uU(2,"archive"),t.qZA()()}}function yt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(3);return t.KtG(n.deleteSelectedActivity())}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA()()}}function ht(a,o){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",56)(2,"button",67),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.YNc(5,vt,3,0,"button",68),t.YNc(6,yt,3,0,"button",69),t.TgZ(7,"button",63),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.downloadActivity())}),t.TgZ(8,"mat-icon"),t._uU(9,"download"),t.qZA()()(),t.BQk()}if(2&a){const e=t.oxw(2);t.xp6(5),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"INPROGRESS"===(null==e.activityData?null:e.activityData.status)||"REJECTED"===(null==e.activityData?null:e.activityData.status)),t.xp6(1),t.Q6J("ngIf","NEW"===(null==e.activityData?null:e.activityData.status)||"REJECTED"===(null==e.activityData?null:e.activityData.status))}}function ft(a,o){if(1&a){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",56)(2,"button",57),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.refreshPage())}),t.TgZ(3,"mat-icon"),t._uU(4,"refresh"),t.qZA()(),t.TgZ(5,"button",63),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2);return t.KtG(n.downloadActivity())}),t.TgZ(6,"mat-icon"),t._uU(7,"download"),t.qZA()()(),t.BQk()}}function At(a,o){if(1&a&&(t.TgZ(0,"div",35),t.YNc(1,gt,17,3,"ng-container",4),t.YNc(2,ht,10,2,"ng-container",4),t.YNc(3,ft,8,0,"ng-container",4),t.qZA()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.isSuperAdmin),t.xp6(1),t.Q6J("ngIf",e.logedInUserId===e.selectedActivityCreatedById&&!e.isSuperAdmin),t.xp6(1),t.Q6J("ngIf",e.logedInUserId!==e.selectedActivityCreatedById&&!e.isSuperAdmin)}}function Tt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"div",35)(1,"button",57),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.refreshPage())}),t.TgZ(2,"mat-icon"),t._uU(3,"refresh"),t.qZA()(),t.TgZ(4,"button",70),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.restoreActivity())}),t.TgZ(5,"mat-icon"),t._uU(6,"restore"),t.qZA()(),t.TgZ(7,"button",60),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.deleteSelectedActivity())}),t.TgZ(8,"mat-icon"),t._uU(9,"delete"),t.qZA()(),t.TgZ(10,"button",63),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.downloadActivity())}),t.TgZ(11,"mat-icon"),t._uU(12,"download"),t.qZA()()()}}function Dt(a,o){if(1&a&&(t.TgZ(0,"div")(1,"div"),t._uU(2),t.ALo(3,"date"),t.qZA(),t.TgZ(4,"div"),t._uU(5),t.qZA(),t._UZ(6,"hr"),t.qZA()),2&a){const e=o.$implicit;t.xp6(2),t.hij(" Due Date ",t.xi3(3,2,null==e?null:e.dueDate,"medium")," "),t.xp6(3),t.hij("Updated by ",null==e?null:e.createdByUserName,"")}}function Ct(a,o){if(1&a&&(t.TgZ(0,"div")(1,"div",71)(2,"div",10)(3,"mat-icon"),t._uU(4,"insert_drive_file"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.TgZ(7,"small"),t._uU(8),t.ALo(9,"number"),t.qZA()()(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"date"),t.qZA()()()),2&a){const e=o.$implicit;t.xp6(6),t.hij("",null==e?null:e.name," "),t.xp6(2),t.hij("",t.xi3(9,3,(null==e?null:e.size)/1024,".2-2")," Kb"),t.xp6(3),t.Oqu(t.xi3(12,6,null==e?null:e.updatedAt,"medium"))}}function xt(a,o){if(1&a&&(t.TgZ(0,"div",72)(1,"p")(2,"span",51),t._uU(3),t.qZA(),t._uU(4),t.ALo(5,"date"),t.qZA()()),2&a){const e=o.$implicit;t.xp6(3),t.hij("",e.status,":"),t.xp6(1),t.hij(" ",t.xi3(5,2,e.updatedAt,"medium")," ")}}function Zt(a,o){if(1&a&&(t.TgZ(0,"div")(1,"span",73)(2,"mat-icon",74),t._uU(3,"account_circle"),t.qZA()()()),2&a){const e=o.$implicit;t.xp6(2),t.s9C("matTooltip",e.organization)}}function bt(a,o){if(1&a&&(t.TgZ(0,"div")(1,"span",73)(2,"mat-icon",74),t._uU(3,"account_circle"),t.qZA()()()),2&a){const e=o.$implicit;t.xp6(2),t.s9C("matTooltip",e.organization)}}let St=(()=>{class a{constructor(e,i,n,s,c,r,m,p,v,Z,b){this.activatedRoute=e,this.activityService=i,this.formBuilder=n,this.organizationService=s,this.router=c,this.alertpopupService=r,this.confirmationDialogService=m,this.userService=p,this.csvHelperService=v,this.storageService=Z,this.userDetailsService=b,this.Priority=I,this.visibility=W,this.status=T,this.filesListArray=[],this.description="",this.toDay=new Date,this.isFilesListArray=!0,this.activatedRoute.queryParams.subscribe(J=>{this.selectedActivityId=J.aId})}ngOnInit(){this.getActivityDetailsById(),this.getActivityMasterData(),this.getAllOrganizationsBySearchCriteria(),this.genarateActivityLogForm(),this.isSuperAdmin=this.storageService.getDataFromLocalStorage(D.I.ROLE)===z.G.SuperAdmin,this.logedInUserId=this.storageService.getDataFromLocalStorage(D.I.USER_ID),this.minDate=new Date}getActivityDetailsById(){this.activityService.getActivityById(this.selectedActivityId).subscribe(e=>{this.activityData=e.data[0],this.selectedActivityEntryTypeId=e.data[0]?.activitEntryType,this.selectedActivityRelatedTypeId=e.data[0]?.activityRelatedTo,this.selectedActivitySectorId=e.data[0]?.activitySector,this.selectedActivityScopeId=e.data[0]?.activityScope,this.selectedActivityCreatedById=e.data[0]?.createdBy,this.organizationCreatedBy=this.activityData?.createdByOrganizationData[0]?.organization,this.activityLogData=this.activityData?.activityLog,this.isArchive=this.activityData?.isArchive,this.selectedActivityTypeId=this.activityData?.activityType,this.organizationsInvolved=this.activityData?.organizationData,this.ministryName=this.activityData?.organizationData.map(i=>i.organization),this.selectedActivityAssignedTo=this.activityData?.organizationData.filter(i=>i._id==this.activityData?.assignTo).map(i=>i.organization),this.getUserById(),this.getLogedInUserDetails(),this.ActivityTimeLogs=this.activityData?.statusLog,this.activityLogForm.controls.priority.setValue(this.activityData?.priority),this.activityLogForm.controls.status.setValue(this.activityData?.status),this.activityLogForm.controls.assignTo.setValue(this.activityData?.assignTo),this.activityLogForm.controls.visibility.setValue(this.activityData?.visibility)})}getLogedInUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.logedInUserDetails=e,this.isAssignee=e?.organization?.includes(this.activityData?.assignTo)})}getActivityMasterData(){this.activityService.getActivitiesMasterData().subscribe(e=>{this.activityEntryType=e.data?.activityEntryTypesData.filter(i=>i._id==this.selectedActivityEntryTypeId).map(i=>i.name),this.activityRelatedTypesData=e.data?.activityRelatedTypesData.filter(i=>i._id==this.selectedActivityRelatedTypeId).map(i=>i.name),this.activitySectorsData=e.data?.activitySectorsData.filter(i=>i._id==this.selectedActivitySectorId).map(i=>i.name),this.ActivityScopeData=e.data?.activityScopesData.filter(i=>i._id==this.selectedActivityScopeId).map(i=>i.name),this.activityType=e?.data?.activityTypesData.filter(i=>i._id==this.selectedActivityTypeId).map(i=>i.name)})}getUserById(){this.userService.getUserById(this.activityData?.createdBy).subscribe(e=>{this.activityReportedBy=e?.existingUser?.Name})}genarateActivityLogForm(){this.activityLogForm=this.formBuilder.group({priority:["",[d.kI.required]],visibility:["",[d.kI.required]],status:["",[d.kI.required]],assignTo:["",[d.kI.required]],attachments:["",[d.kI.required]]})}setOrganizationIdInActivityLog(){if(0===this.logedInUserDetails.organization.length)return this.logedInUserDetails.organization[0];{let e=this.logedInUserDetails?.organization.filter(i=>i===this.activityData?.assignTo);return 0!==e.length||(e=this.logedInUserDetails?.organization.filter(i=>i===this.activityData?.createdByOrganization)),e[0]}}onSubmit(){const e={...this.activityLogForm.value,organizationId:this.setOrganizationIdInActivityLog(),attachments:0===this.filesListArray?.length?void 0:this.filesListArray,message:this.description};this.activityService.updateActivityLogById(this.selectedActivityId,e).subscribe(i=>{let n=i.data.activityLog;if(this.fileAttachmments?.length>0){let s=new FormData;for(let c=0;c<this.fileAttachmments?.length;c++)s.append(`${this.selectedActivityId}/${n[n.length-1]._id}`,this.fileAttachmments[c],this.filesListArray[c].name);this.uploadAttachments(s)}this.alertpopupService.open({message:i?.message?i?.message:"Activity Updated Successfully",action:"ok"}),this.getActivityDetailsById(),this.activityLogForm?.reset(),this.description="",this.isFilesListArray=!1},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}getAllOrganizationsBySearchCriteria(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:0,pageSize:50,sortField:"",sortOrder:0,type:"63973bfb61ab6f49bfdd3c35",organization:"",organizationId:"",isActive:!0,userId:"",userSearch:""}).subscribe(i=>{this.organizationList=i.data.organizations})}updatedDescription(e){this.description=e}updatedFilesDescription(e){let i,n;this.isSuperAdmin?(i=this.activityData?.createdByOrganization,n=this.activityData?.createdByOrganizationData[0].organization):this.logedInUserDetails.organization?.includes(this.activityData?.assignTo)&&this.logedInUserDetails.organization?.includes(this.activityData?.createdByOrganization)||this.logedInUserDetails.organization?.includes(this.activityData?.assignTo)?(i=this.activityData?.assignTo,n=this.selectedActivityAssignedTo[0]):(i=this.activityData?.createdByOrganization,n=this.activityData?.createdByOrganizationData[0].organization);let s=e.target.files;this.fileAttachmments=s;for(var c=0;c<s.length;c++)this.filesListArray.push({name:s[c].name,size:s[c].size.toString(),path:"string",organization:n,organizationId:i})}updateActivityDetails(){this.router.navigate([A.p.CREATEACTIVITY],{queryParams:{aId:this.selectedActivityId}})}dueDateSetter(e,i){"noDueDate"==e?this.selectedDate="":"Today"==e?this.selectedDate=new Date:"Tomorrow"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+1)):"Next Monday"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+(7-this.toDay.getDay())%7+1)):"This Friday"==e?this.selectedDate=new Date(this.toDay.setDate(this.toDay.getDate()+(12-this.toDay.getDay())%7)):"custom"==e&&(this.selectedDate=i.value),this.activityService.updateActivityDueDate(this.selectedActivityId,{dueDate:this.selectedDate}).subscribe(n=>{this.alertpopupService.open({message:n.message,action:"ok"}),this.getActivityDetailsById()},n=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})}updateSelectedArchiveStatus(){const e={isArchive:!0};this.confirmationDialogService.open({message:`Are you sure you want to archive ${this.activityData?.uniqIdentity}`}).afterClosed().subscribe(i=>{i&&this.activityService.updateArchivestatus(this.selectedActivityId,e).subscribe(n=>{this.alertpopupService.open({message:n.message,action:"ok"}),this.getActivityDetailsById()},n=>{this.alertpopupService.open({message:"Faild to archive Organization! Please try again ",action:"ok"})})})}restoreActivity(){const e={isArchive:!1};this.confirmationDialogService.open({message:`Are you sure you want to restore ${this.activityData?.uniqIdentity}`}).afterClosed().subscribe(i=>{i&&this.activityService.updateArchivestatus(this.selectedActivityId,e).subscribe(n=>{this.alertpopupService.open({message:"Activity Restored Successfully",action:"ok"}),this.getActivityDetailsById()},n=>{this.alertpopupService.open({message:"Faild to Restored Organization! Please try again ",action:"ok"})})})}deleteSelectedActivity(){this.confirmationDialogService.open({message:`Are you sure you want to delete ${this.activityData?.uniqIdentity}`}).afterClosed().subscribe(e=>{e&&this.activityService.deleteSelectedActivity(this.selectedActivityId).subscribe(i=>{this.alertpopupService.open({message:i.message,action:"ok"}),this.getActivityDetailsById()},i=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})}updateStatusOfSelectedActivity(e){let i="";"Reject"==e?i=T[2]:"Resolve"==e&&(i=T[4]);const n={status:i};this.confirmationDialogService.open({message:`Are you sure you want to ${e} ${this.activityData?.uniqIdentity}`}).afterClosed().subscribe(s=>{s&&this.activityService.updateActivityStatus(this.selectedActivityId,n).subscribe(c=>{this.alertpopupService.open({message:c.message,action:"ok"}),this.getActivityDetailsById()},c=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})}downloadActivity(){let e=[...this.activityData.activityLog,...this.activityData.dueDateLog];e=e.sort((s,c)=>new Date(s.createdAt).valueOf()-new Date(c.createdAt).valueOf());let i=[{title:this.activityData.title,description:this.activityData.description.replace(/<[^>]*>/g,""),status:"New",assignedTo:this.selectedActivityAssignedTo.toString(),dueDate:this.activityData.dueDate,attachments:0==this.activityData.attachments.length?"NO":this.activityData.attachments[0].name.toString(),priority:"None",type:this.activityType.toString(),sector:this.activitySectorsData.toString(),entryType:this.activityEntryType.toString(),ministry:this.organizationsInvolved[0].organization,scope:this.ActivityScopeData.toString(),relatedTo:this.activityRelatedTypesData.toString(),categoryMappedTo:"",activityprogress:"",reportedBy:this.activityData.createdByOrganizationData[0].organization,activityId:this.activityData.uniqIdentity,createdAt:this.activityData.createdAt}];e.forEach((s,c)=>{let r={...i[0]};s.dueDate?(r.dueDate=s.dueDate,r.createdAt=s.createdAt,i.push(r)):s.message&&(r.description=s?.message.replace(/<[^>]*>/g,""),r.createdAt=s.createdAt,r.status=s?.status?s.status:r.status,r.priority=s?.priority?s.priority:r.priority,i.push(r))}),this.csvHelperService.downloadFile(i,"activity details",R)}refreshPage(){this.getActivityDetailsById()}resetActivityLogForm(){this.activityLogForm.reset()}navigateToPreviousRoute(){this.router.navigate([A.p.ACTIVITY])}statusClass(e){return"MEDIUM"===e?"confirm":"HIGH"===e?"reject":""}isShowActivityLog(e){if(this.isSuperAdmin)return!0;if("EVERYONE"===e.visibility)return!0;{let i=this.logedInUserDetails.organization.includes(e.organizationId);return!!i||(i=this.logedInUserDetails.organization.includes(e.organizationId),i)}}uploadAttachments(e){this.activityService.uploadAttachments(e).subscribe(i=>{})}downloadAttachment(e,i){this.activityService.dowloadAttachments({fileName:i.name,path:`${this.selectedActivityId}/${e._id}`}).subscribe(s=>{const c=document.createElement("a");c.href=window.URL.createObjectURL(s),c.download=i.name,c.click(),window.URL.revokeObjectURL(c.href)},s=>{})}downloadActivityAttachment(e){this.activityService.dowloadAttachments({fileName:e.name,path:`${this.selectedActivityId}`}).subscribe(n=>{const s=document.createElement("a");s.href=window.URL.createObjectURL(n),s.download=e.name,s.click(),window.URL.revokeObjectURL(s.href)},n=>{})}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(f.gz),t.Y36(q.M),t.Y36(d.qu),t.Y36(P.M),t.Y36(f.F0),t.Y36(k.z),t.Y36(Q.O),t.Y36(et.K),t.Y36(L),t.Y36(U.V),t.Y36(O.H))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity-details"]],decls:237,vars:73,consts:[[1,"btn-back","btn","btn-primary","btn-sm",3,"click"],[1,"row"],[1,"col-md-9"],[1,"activity-data"],[4,"ngIf"],[1,"col-md-4"],[1,"table","table-borderless"],[3,"matTooltip"],[1,"col-md-12","my-2"],[1,"activity_card"],[1,"d-flex"],[1,"mat-i"],[1,"card-created"],[3,"innerHTML"],[3,"click",4,"ngFor","ngForOf"],["class","col-md-12 my-2",4,"ngFor","ngForOf"],[1,"logform","mt-4"],[3,"formGroup","ngSubmit"],[1,"row","mb-3"],[1,"col-sm-3","col-form-label"],[1,"col-sm-9"],[3,"value","updatedDescription"],["appearance","outline"],["formControlName","status"],[3,"value"],["aria-label","","formControlName","priority"],["aria-label","","formControlName","visibility","layout","row"],["formControlName","assignTo"],[3,"value",4,"ngFor","ngForOf"],[3,"value","updatedFilesDescription"],[1,"d-flex","justify-content-end","align-items-center"],["type","button","mat-raised-button","",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[1,"col-md-3","active_right_panel"],["class","activity_widget",4,"ngIf"],[1,"activity_widget"],[1,"d-flex","align-items-center"],[1,"mat-Icon"],["data-toggle","dropdown",1,"quick-action","mb-0"],[1,"activity_widget","date_ragne"],[1,"d-flex","justify-content-between"],["mat-button","",3,"matMenuTriggerFor"],["dueDateLogMenu","matMenu"],[4,"ngFor","ngForOf"],["dueDateFiltersMatMenu","matMenu"],["mat-menu-item","",3,"click"],["matInput","",3,"matDatepicker","min","dateChange"],["matIconSuffix","",3,"for"],["picker",""],[1,"d-flex","flex-wrap","activity_widget"],[1,""],[1,"activity_status"],["class","my-2",4,"ngFor","ngForOf"],[3,"click"],["class","activity_card",4,"ngIf"],[1,"organization-title"],[1,"d-flex","justify-content-start"],["mat-stroked-button","","matTooltip","Reload",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Edit",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Archive",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Delete",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Resolve",3,"click",4,"ngIf"],["mat-stroked-button","","class","padding","matTooltip","Reject",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Download",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Edit",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Resolve",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Reject",1,"padding",3,"click"],["mat-stroked-button","","matTooltip","Refresh",1,"padding",3,"click"],["mat-stroked-button","","class","padding","matTooltip","Archive",3,"click",4,"ngIf"],["mat-stroked-button","","class","padding","matTooltip","Delete",3,"click",4,"ngIf"],["mat-stroked-button","","matTooltip","Restore",1,"padding",3,"click"],[1,"file-data"],[1,"my-2"],[1,"d-flex","align-items-center","justify-content-center"],[1,"mat-i",3,"matTooltip"]],template:function(e,i){if(1&e&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return i.navigateToPreviousRoute()}),t.TgZ(1,"mat-icon"),t._uU(2,"keyboard_return"),t.qZA(),t._uU(3," Back To Activities"),t.qZA(),t.TgZ(4,"div",1)(5,"div",2)(6,"div",3)(7,"h2"),t._uU(8),t.ALo(9,"titlecase"),t.qZA(),t.TgZ(10,"p"),t._uU(11),t.ALo(12,"date"),t.YNc(13,at,4,1,"span",4),t.qZA(),t.TgZ(14,"div",1)(15,"div",5)(16,"table",6)(17,"tbody")(18,"tr")(19,"td"),t._uU(20,"Type"),t.qZA(),t.TgZ(21,"td"),t._uU(22),t.qZA()(),t.TgZ(23,"tr")(24,"td"),t._uU(25,"Entry Type:"),t.qZA(),t.TgZ(26,"td"),t._uU(27),t.qZA()(),t.TgZ(28,"tr")(29,"td"),t._uU(30,"Related To:"),t.qZA(),t.TgZ(31,"td"),t._uU(32),t.qZA()(),t.TgZ(33,"tr")(34,"td"),t._uU(35,"Priority:"),t.qZA(),t.TgZ(36,"td"),t._uU(37),t.ALo(38,"titlecase"),t.qZA()(),t.TgZ(39,"tr")(40,"td"),t._uU(41,"Status:"),t.qZA(),t.TgZ(42,"td"),t._uU(43),t.ALo(44,"titlecase"),t.qZA()()()()(),t.TgZ(45,"div",5)(46,"table",6)(47,"tbody")(48,"tr")(49,"td"),t._uU(50,"Reported By:"),t.qZA(),t.TgZ(51,"td"),t._uU(52),t.qZA()(),t.TgZ(53,"tr")(54,"td"),t._uU(55,"Ministry/Department:"),t.qZA(),t.TgZ(56,"td",7),t._uU(57),t.YNc(58,nt,2,1,"span",4),t.qZA()(),t.TgZ(59,"tr")(60,"td"),t._uU(61,"Organization:"),t.qZA(),t.TgZ(62,"td"),t._uU(63),t.qZA()()()()(),t.TgZ(64,"div",5)(65,"table",6)(66,"tbody")(67,"tr")(68,"td"),t._uU(69,"Sector:"),t.qZA(),t.TgZ(70,"td"),t._uU(71),t.qZA()(),t.TgZ(72,"tr")(73,"td"),t._uU(74,"Scope:"),t.qZA(),t.TgZ(75,"td"),t._uU(76),t.qZA()()()()(),t.TgZ(77,"div")(78,"div",8)(79,"div",9)(80,"div",10)(81,"div",10)(82,"mat-icon",11),t._uU(83,"account_circle"),t.qZA()(),t.TgZ(84,"div",12),t._uU(85," Created by "),t.TgZ(86,"strong"),t._uU(87),t.qZA(),t.TgZ(88,"p"),t._uU(89),t.ALo(90,"date"),t.qZA()()(),t._UZ(91,"div",13),t.TgZ(92,"div",10),t.YNc(93,ot,2,0,"mat-icon",4),t.TgZ(94,"div"),t.YNc(95,st,5,5,"p",14),t.qZA()()(),t.YNc(96,dt,2,1,"div",15),t.TgZ(97,"div",16)(98,"form",17),t.NdJ("ngSubmit",function(){return i.onSubmit()}),t.TgZ(99,"div",18)(100,"label",19),t._uU(101," Write your Reply: "),t.qZA(),t.TgZ(102,"div",20)(103,"app-rich-text-editor",21),t.NdJ("updatedDescription",function(s){return i.updatedDescription(s)}),t.qZA()()(),t.TgZ(104,"div",18)(105,"label",19),t._uU(106," Status: "),t.qZA(),t.TgZ(107,"div",20)(108,"mat-form-field",22)(109,"mat-select",23)(110,"mat-option",24),t._uU(111,"New"),t.qZA(),t.TgZ(112,"mat-option",24),t._uU(113,"In Progress"),t.qZA(),t.TgZ(114,"mat-option",24),t._uU(115,"Resolved"),t.qZA(),t.TgZ(116,"mat-option",24),t._uU(117,"Not Admissible"),t.qZA()()()()(),t.TgZ(118,"div",18)(119,"label",19),t._uU(120," Priority: "),t.qZA(),t.TgZ(121,"div",20)(122,"mat-radio-group",25)(123,"mat-radio-button",24),t._uU(124,"None"),t.qZA(),t.TgZ(125,"mat-radio-button",24),t._uU(126,"Low"),t.qZA(),t.TgZ(127,"mat-radio-button",24),t._uU(128,"Medium"),t.qZA(),t.TgZ(129,"mat-radio-button",24),t._uU(130,"High"),t.qZA()()()(),t.TgZ(131,"div",18)(132,"label",19),t._uU(133," Visibility: "),t.qZA(),t.TgZ(134,"div",20)(135,"mat-radio-group",26)(136,"mat-radio-button",24),t._uU(137,"Internal"),t.qZA(),t.TgZ(138,"mat-radio-button",24),t._uU(139,"Everyone"),t.qZA()()()(),t.TgZ(140,"div",18)(141,"label",19),t._uU(142," Assign to "),t.qZA(),t.TgZ(143,"div",20)(144,"mat-form-field",22)(145,"mat-select",27),t.YNc(146,pt,2,2,"mat-option",28),t.qZA()()()(),t.TgZ(147,"div",18)(148,"label",19),t._uU(149," Attachments"),t.qZA(),t.TgZ(150,"div",20)(151,"app-fileuploader",29),t.NdJ("updatedFilesDescription",function(s){return i.updatedFilesDescription(s)}),t.qZA()()(),t.TgZ(152,"div",30)(153,"button",31),t.NdJ("click",function(){return i.resetActivityLogForm()}),t._uU(154,"Cancel"),t.qZA(),t.TgZ(155,"button",32),t._uU(156," Post "),t.qZA()()()()()()()()(),t.TgZ(157,"div",33),t.YNc(158,At,4,3,"div",34),t.YNc(159,Tt,13,0,"div",34),t.TgZ(160,"div",35)(161,"div",36)(162,"mat-icon",37),t._uU(163,"folder_shared"),t.qZA(),t.TgZ(164,"h3",38),t._uU(165,"Assigned To"),t.qZA()(),t.TgZ(166,"div",36)(167,"div")(168,"mat-icon",11),t._uU(169,"account_circle"),t.qZA()(),t.TgZ(170,"div")(171,"span"),t._uU(172),t.qZA()()()(),t.TgZ(173,"div",39)(174,"div",40)(175,"div",10)(176,"mat-icon"),t._uU(177," date_range"),t.qZA(),t.TgZ(178,"h3"),t._uU(179),t.ALo(180,"date"),t.qZA()(),t.TgZ(181,"div")(182,"button",41)(183,"mat-icon"),t._uU(184,"edit"),t.qZA()(),t.TgZ(185,"button",41)(186,"mat-icon"),t._uU(187,"view_headline"),t.qZA()(),t.TgZ(188,"mat-menu",null,42),t.YNc(190,Dt,7,5,"div",43),t.qZA()()(),t.TgZ(191,"mat-menu",null,44)(193,"button",45),t.NdJ("click",function(){return i.dueDateSetter("noDueDate")}),t._uU(194," No Due Date "),t.qZA(),t.TgZ(195,"button",45),t.NdJ("click",function(){return i.dueDateSetter("Today")}),t._uU(196,"Today"),t.qZA(),t.TgZ(197,"button",45),t.NdJ("click",function(){return i.dueDateSetter("Tomorrow")}),t._uU(198," Tomorrow "),t.qZA(),t.TgZ(199,"button",45),t.NdJ("click",function(){return i.dueDateSetter("Next Monday")}),t._uU(200," Next Monday "),t.qZA(),t.TgZ(201,"button",45),t.NdJ("click",function(){return i.dueDateSetter("This Friday")}),t._uU(202," This Friday "),t.qZA(),t.TgZ(203,"mat-label"),t._uU(204,"Choose a date"),t.qZA(),t.TgZ(205,"input",46),t.NdJ("dateChange",function(s){return i.dueDateSetter("custom",s)}),t.qZA(),t._UZ(206,"mat-datepicker-toggle",47)(207,"mat-datepicker",null,48),t.qZA()(),t.TgZ(209,"div",49)(210,"mat-icon"),t._uU(211,"attach_file"),t.qZA(),t.TgZ(212,"h3",50),t._uU(213),t.qZA(),t.YNc(214,Ct,13,9,"div",43),t.qZA(),t.TgZ(215,"div",35)(216,"div",10)(217,"mat-icon"),t._uU(218,"timeline"),t.qZA(),t.TgZ(219,"h3",50),t._uU(220,"Activities"),t.qZA()(),t.TgZ(221,"div")(222,"div")(223,"span",51),t._uU(224,"Created:"),t.qZA(),t._uU(225),t.ALo(226,"date"),t.qZA(),t.YNc(227,xt,6,5,"div",52),t.qZA()(),t.TgZ(228,"div",35)(229,"div",10)(230,"mat-icon"),t._uU(231," supervised_user_circle"),t.qZA(),t.TgZ(232,"h3",50),t._uU(233,"People Involved"),t.qZA()(),t.TgZ(234,"div",10),t.YNc(235,Zt,4,1,"div",43),t.YNc(236,bt,4,1,"div",43),t.qZA()()()()),2&e){const n=t.MAs(189),s=t.MAs(192),c=t.MAs(208);t.xp6(8),t.AsE("",null==i.activityData?null:i.activityData.uniqIdentity," : ",t.lcZ(9,55,null==i.activityData?null:i.activityData.title),""),t.xp6(3),t.hij(" Last updated on ",t.xi3(12,57,null==i.activityData?null:i.activityData.createdAt,"medium")," "),t.xp6(2),t.Q6J("ngIf",(null==i.activityData?null:i.activityData.activityLog.length)>=1),t.xp6(9),t.Oqu(i.activityType),t.xp6(5),t.Oqu(i.activityEntryType),t.xp6(5),t.Oqu(i.activityRelatedTypesData),t.xp6(4),t.Tol(i.statusClass(null==i.activityData?null:i.activityData.priority)),t.xp6(1),t.Oqu(t.lcZ(38,60,null==i.activityData?null:i.activityData.priority)),t.xp6(6),t.Oqu(t.lcZ(44,62,null==i.activityData?null:i.activityData.status)),t.xp6(9),t.Oqu(i.activityReportedBy),t.xp6(4),t.Q6J("matTooltip",i.ministryName),t.xp6(1),t.hij(" ",(null==i.organizationsInvolved?null:i.organizationsInvolved.length)>0&&(null==i.organizationsInvolved[0]?null:i.organizationsInvolved[0].organization),""),t.xp6(1),t.Q6J("ngIf",(null==i.organizationsInvolved?null:i.organizationsInvolved.length)>1),t.xp6(5),t.Oqu(i.organizationCreatedBy),t.xp6(8),t.Oqu(i.activitySectorsData),t.xp6(5),t.Oqu(i.ActivityScopeData),t.xp6(11),t.Oqu(i.activityReportedBy),t.xp6(2),t.Oqu(t.xi3(90,64,null==i.activityData?null:i.activityData.createdAt,"medium")),t.xp6(2),t.Q6J("innerHTML",null==i.activityData?null:i.activityData.description,t.oJD),t.xp6(2),t.Q6J("ngIf",(null==i.activityData||null==i.activityData.attachments?null:i.activityData.attachments.length)>=1),t.xp6(2),t.Q6J("ngForOf",null==i.activityData?null:i.activityData.attachments),t.xp6(1),t.Q6J("ngForOf",i.activityLogData),t.xp6(2),t.Q6J("formGroup",i.activityLogForm),t.xp6(5),t.Q6J("value",i.description),t.xp6(7),t.Q6J("value",i.status[0]),t.xp6(2),t.Q6J("value",i.status[1]),t.xp6(2),t.Q6J("value",i.status[4]),t.xp6(2),t.Q6J("value",i.status[2]),t.xp6(7),t.Q6J("value",i.Priority[0]),t.xp6(2),t.Q6J("value",i.Priority[1]),t.xp6(2),t.Q6J("value",i.Priority[2]),t.xp6(2),t.Q6J("value",i.Priority[3]),t.xp6(7),t.Q6J("value",i.visibility[0]),t.xp6(2),t.Q6J("value",i.visibility[1]),t.xp6(8),t.Q6J("ngForOf",i.organizationList),t.xp6(5),t.Q6J("value",i.isFilesListArray),t.xp6(4),t.Q6J("disabled",""===i.description),t.xp6(3),t.Q6J("ngIf",!i.isArchive),t.xp6(1),t.Q6J("ngIf",i.isArchive),t.xp6(13),t.hij("",i.selectedActivityAssignedTo," "),t.xp6(7),t.Oqu(null!=i.activityData&&i.activityData.dueDate?t.xi3(180,67,null==i.activityData?null:i.activityData.dueDate,"medium"):"No DueDate"),t.xp6(3),t.Q6J("matMenuTriggerFor",s),t.xp6(3),t.Q6J("matMenuTriggerFor",n),t.xp6(5),t.Q6J("ngForOf",null==i.activityData||null==i.activityData.dueDateLog?null:i.activityData.dueDateLog.reverse()),t.xp6(15),t.Q6J("matDatepicker",c)("min",i.minDate),t.xp6(1),t.Q6J("for",c),t.xp6(7),t.hij(" ",0===(null==i.activityData||null==i.activityData.attachments?null:i.activityData.attachments.length)?"No Files in this Activity":"Files in this Activity"," "),t.xp6(1),t.Q6J("ngForOf",null==i.activityData?null:i.activityData.attachments),t.xp6(11),t.hij(" ",t.xi3(226,70,null==i.activityData?null:i.activityData.createdAt,"medium")," "),t.xp6(2),t.Q6J("ngForOf",i.ActivityTimeLogs),t.xp6(8),t.Q6J("ngForOf",null==i.activityData?null:i.activityData.createdByOrganizationData),t.xp6(1),t.Q6J("ngForOf",i.organizationsInvolved)}},dependencies:[u.sg,u.O5,d._Y,d.JJ,d.JL,d.sg,d.u,E.ey,w.lW,y.Mq,y.hl,y.nW,F.Hw,h.KE,h.hX,Y.Nt,C.VK,C.OP,C.p6,N.VQ,N.U0,B.gD,$.gM,H,G,u.JJ,u.rS,u.uU],styles:[".btn-back[_ngcontent-%COMP%]{display:flex;align-items:center;gap:3px;letter-spacing:.03em;margin-bottom:5px;position:absolute;top:70px;z-index:333}.mat-Icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px}.padding[_ngcontent-%COMP%]{min-width:30px;padding:0;border-radius:5px}.img-span[_ngcontent-%COMP%]{height:50px;width:50px;background-color:#bbb;border-radius:50%;text-align:center}.mat-i[_ngcontent-%COMP%]{font-size:40px;opacity:.5;width:40px;height:40px;line-height:40px}.kit[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{opacity:.7}hr[_ngcontent-%COMP%]{opacity:.1}.date-icon[_ngcontent-%COMP%]{min-width:30px;padding:0}.redText[_ngcontent-%COMP%]{color:#b54b4b}.blueText[_ngcontent-%COMP%]{color:#7979c4}  .NgxEditor{height:200px;overflow-y:auto}  .NgxEditor__Content{min-height:150px}"]}),a})();var kt=l(5017),g=l(3626),V=l(8739),Ft=l(8202),Nt=l(5150),It=l(6749),qt=l(1135),Ut=l(4336),Ot=l(4889),Et=l(1413),wt=l(9974),Mt=l(3546),Jt=l(6709),x=l(7331),M=l(3848);function zt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("activityTypesData",n,"types",!0))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.shortName," ")}}function Rt(a,o){if(1&a&&(t.ynx(0),t.YNc(1,zt,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Pt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("activityEntryTypesData",n,"entryTypes",!0))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function Qt(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Pt,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Lt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("activitySectorsData",n,"geography",!0))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function Yt(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Lt,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Bt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("activityScopesData",n,"scope",!0))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.name," ")}}function $t(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Bt,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Ht(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("priority",n,"priority",!1))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function Gt(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Ht,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Vt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().index,s=t.oxw();return t.KtG(s.removeFilter("status",n,"status",!1))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function jt(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Vt,5,1,"mat-chip",4),t.BQk()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngIf",!0===e.selected)}}function Kt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeDateFilter("createdDate"))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.createdDateChipValue," ")}}function Wt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip"),t._uU(1),t.TgZ(2,"button",59)(3,"mat-icon",22),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.removeDateFilter("dueDate"))}),t._uU(4,"cancel"),t.qZA()()()}if(2&a){const e=t.oxw();t.xp6(1),t.hij(" ",e.dueDateChipValue," ")}}function Xt(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",60),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.resetAllFilters())}),t._uU(1,"Reset Filters"),t.qZA()}}function te(a,o){if(1&a&&(t.TgZ(0,"mat-option"),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function ee(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-option",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.sortActivityListData(s))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",e.DisplayName," ")}}function ie(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-radio-button",61),t.NdJ("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.filterActivityListData("createdDate",n,c.DisplayName))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function ae(a,o){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid start date"),t.qZA())}function ne(a,o){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid end date"),t.qZA())}const j=function(){return{width:"180px"}};function oe(a,o){if(1&a&&(t.TgZ(0,"mat-form-field",62),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-label"),t._uU(2,"Enter date"),t.qZA(),t.TgZ(3,"mat-date-range-input",63),t._UZ(4,"input",64)(5,"input",65),t.qZA(),t._UZ(6,"mat-datepicker-toggle",66)(7,"mat-date-range-picker",null,67),t.YNc(9,ae,2,0,"mat-error",4),t.YNc(10,ne,2,0,"mat-error",4),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw();t.Q6J("ngStyle",t.DdM(6,j)),t.xp6(3),t.Q6J("formGroup",i.customCreatedDate)("rangePicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.customCreatedDate.controls.fromDate.hasError("matStartDateInvalid")),t.xp6(1),t.Q6J("ngIf",i.customCreatedDate.controls.toDate.hasError("matEndDateInvalid"))}}function se(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-radio-button",61),t.NdJ("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.filterActivityListData("dueDate",n,c.DisplayName))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("value",e.key),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function ce(a,o){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid start date"),t.qZA())}function re(a,o){1&a&&(t.TgZ(0,"mat-error"),t._uU(1,"Invalid end date"),t.qZA())}function le(a,o){if(1&a&&(t.TgZ(0,"mat-form-field",62),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-label"),t._uU(2,"Enter date"),t.qZA(),t.TgZ(3,"mat-date-range-input",63),t._UZ(4,"input",64)(5,"input",65),t.qZA(),t._UZ(6,"mat-datepicker-toggle",66)(7,"mat-date-range-picker",null,68),t.YNc(9,ce,2,0,"mat-error",4),t.YNc(10,re,2,0,"mat-error",4),t.qZA()),2&a){const e=t.MAs(8),i=t.oxw();t.Q6J("ngStyle",t.DdM(6,j)),t.xp6(3),t.Q6J("formGroup",i.customDueDate)("rangePicker",e),t.xp6(3),t.Q6J("for",e),t.xp6(3),t.Q6J("ngIf",i.customDueDate.controls.fromDate.hasError("matStartDateInvalid")),t.xp6(1),t.Q6J("ngIf",i.customDueDate.controls.toDate.hasError("matEndDateInvalid"))}}function de(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"status",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function pe(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"types",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.name," ")}}function ue(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"entryTypes",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.name," ")}}function me(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"geography",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.name," ")}}function _e(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"scope",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.name," ")}}function ge(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-checkbox",69),t.NdJ("ngModelChange",function(n){const c=t.CHM(e).$implicit;return t.KtG(c.selected=n)})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(r.activityListFilterOnChanged(n,"priority",c))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.Q6J("ngModel",e.selected),t.xp6(1),t.hij(" ",e.DisplayName," ")}}function ve(a,o){if(1&a&&(t.TgZ(0,"div",22),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"section",25)(2,"mat-checkbox",70),t._uU(3),t.qZA()()()),2&a){const e=o.$implicit;t.xp6(3),t.hij(" ",e," ")}}function ye(a,o){if(1&a&&(t.TgZ(0,"div",22),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"section",25)(2,"mat-checkbox",70),t._uU(3),t.qZA()()()),2&a){const e=o.$implicit;t.xp6(3),t.hij(" ",e," ")}}function he(a,o){if(1&a&&(t.TgZ(0,"div",71)(1,"mat-icon"),t._uU(2,"assignment"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.hij(" All Tasks ( ",null!=e.activitiesTabCount&&null!=e.activitiesTabCount.all[0]&&e.activitiesTabCount.all[0].all?null==e.activitiesTabCount.all[0]?null:e.activitiesTabCount.all[0].all:0," ) ")}}function fe(a,o){if(1&a&&(t.TgZ(0,"div",71)(1,"mat-icon"),t._uU(2,"assignment_ind"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.hij(" My Tasks ( ",null!=e.activitiesTabCount&&null!=e.activitiesTabCount.myTasks[0]&&e.activitiesTabCount.myTasks[0].myTasks?null==e.activitiesTabCount.myTasks[0]?null:e.activitiesTabCount.myTasks[0].myTasks:0," ) ")}}function Ae(a,o){if(1&a&&(t.TgZ(0,"div",71)(1,"mat-icon"),t._uU(2,"person_pin"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.hij(" Active ( ",null!=e.activitiesTabCount&&null!=e.activitiesTabCount.activeActivities[0]&&e.activitiesTabCount.activeActivities[0].activeActivities?null==e.activitiesTabCount||null==e.activitiesTabCount.activeActivities[0]?null:e.activitiesTabCount.activeActivities[0].activeActivities:0," ) ")}}function Te(a,o){if(1&a&&(t.TgZ(0,"div",71)(1,"mat-icon"),t._uU(2,"hourglass_empty"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw();t.xp6(3),t.hij(" Overdue ( ",null!=e.activitiesTabCount&&null!=e.activitiesTabCount.overDue[0]&&e.activitiesTabCount.overDue[0].overDue?null==e.activitiesTabCount.overDue[0]?null:e.activitiesTabCount.overDue[0].overDue:0," ) ")}}function De(a,o){if(1&a&&(t.TgZ(0,"div",71)(1,"mat-icon"),t._uU(2,"wb_incandescent"),t.qZA(),t._uU(3),t.qZA()),2&a){const e=t.oxw(2);t.xp6(3),t.hij(" High Priority ( ",null!=e.activitiesTabCount&&null!=e.activitiesTabCount.highPriority[0]&&e.activitiesTabCount.highPriority[0].highPriority?null==e.activitiesTabCount.highPriority[0]?null:e.activitiesTabCount.highPriority[0].highPriority:0," ) ")}}function Ce(a,o){1&a&&(t.TgZ(0,"div")(1,"mat-tab",72),t.YNc(2,De,4,1,"ng-template",38),t.qZA()())}function xe(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"th",73)(1,"mat-checkbox",74),t.NdJ("change",function(n){t.CHM(e);const s=t.oxw();return t.KtG(n?s.toggleAllRows():null)}),t.qZA()()}if(2&a){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function Ze(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"td",75)(1,"mat-checkbox",76),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const c=t.CHM(e).$implicit,r=t.oxw();return t.KtG(n?r.selection.toggle(c):null)}),t.qZA(),t.TgZ(2,"button",77),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.generateActivityRowActions(s.status,s))}),t.TgZ(3,"mat-icon"),t._uU(4,"arrow_drop_down"),t.qZA()()()}if(2&a){const e=o.$implicit,i=t.oxw(),n=t.MAs(156);t.xp6(1),t.Q6J("checked",i.selection.isSelected(e))("aria-label",i.checkboxLabel(e)),t.xp6(1),t.Q6J("matMenuTriggerFor",n)}}function be(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Status "),t.qZA())}const Se=function(a,o,e,i){return{"badge-not-admissible":a,"badge-resolved":o,"badge-in-progress":e,"badge-new":i}};function ke(a,o){if(1&a&&(t.TgZ(0,"td",78)(1,"span",79),t._uU(2),t.ALo(3,"titlecase"),t.qZA()()),2&a){const e=o.$implicit;t.xp6(1),t.Q6J("ngClass",t.l5B(4,Se,"rejected"===(null==e?null:e.status.toLowerCase()),"resolved"===(null==e?null:e.status.toLowerCase()),"inprogress"===(null==e?null:e.status.toLowerCase()),"new"===(null==e?null:e.status.toLowerCase()))),t.xp6(1),t.Oqu(t.lcZ(3,2,null==e?null:e.status))}}function Fe(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Activity "),t.qZA())}function Ne(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"td",80),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.navigateToActivityDetails(s._id))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",e.uniqIdentity," ")}}function Ie(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Title "),t.qZA())}function qe(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"td",80),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.navigateToActivityDetails(s._id))}),t._uU(1),t.qZA()}if(2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",e.title," ")}}function Ue(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Priority "),t.qZA())}function Oe(a,o){if(1&a&&(t.TgZ(0,"td",75),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e?null:e.priority," ")}}function Ee(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Due date "),t.qZA())}function we(a,o){if(1&a&&(t.TgZ(0,"td",75),t._uU(1),t.ALo(2,"date"),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,null==e?null:e.dueDate,"MMM d, y")," ")}}function Me(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Assigned To "),t.qZA())}function Je(a,o){if(1&a&&(t.TgZ(0,"td",75),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.assignTo[0]?null:e.assignTo[0].organization," ")}}function ze(a,o){1&a&&(t.TgZ(0,"th",73),t._uU(1," Action "),t.qZA())}function Re(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"td",75)(1,"mat-icon",81),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.navigateToActivityDetails(s._id))}),t._uU(2,"keyboard_arrow_right icon"),t.qZA()()}}function Pe(a,o){1&a&&t._UZ(0,"tr",82)}function Qe(a,o){1&a&&t._UZ(0,"tr",83)}function Le(a,o){1&a&&(t.TgZ(0,"div")(1,"mat-card",84),t._uU(2," No Activities found "),t.qZA()())}function Ye(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",86),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onActivityRowActionClick(s.action))}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&a){const e=o.$implicit;t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.title)}}function Be(a,o){if(1&a&&(t.ynx(0),t.YNc(1,Ye,5,2,"button",85),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.activityRowActionByStatus)}}function $e(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"button",86),t.NdJ("click",function(){const s=t.CHM(e).$implicit,c=t.oxw(2);return t.KtG(c.onActivityRowActionClick(s.action))}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()()}if(2&a){const e=o.$implicit;t.xp6(2),t.Oqu(e.icon),t.xp6(2),t.Oqu(e.title)}}function He(a,o){if(1&a&&(t.ynx(0),t.YNc(1,$e,5,2,"button",85),t.BQk()),2&a){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.userActivityRowActionByStatus)}}let Ge=(()=>{class a{constructor(e,i,n,s,c,r,m,p,v,Z,b){this.activityService=e,this.storageService=i,this.router=n,this.userDetailsService=s,this.alertpopupService=c,this.confirmationDialogService=r,this.breadcrumbService=m,this.csvHelperService=p,this.selectedOrganizationService=v,this.dashboardService=Z,this.searchTriggerService=b,this.displayedColumns=["select","Status","Activity","Title","Priority","Duedate","Assignto","actions"],this.activityFiltersData=It.C,this.currentStatus=T,this.superAdminActivityRowActions=X,this.userActivityRowActions=tt,this.statusEnums=T,this.activitylist=[],this.filter=Ft.t,this.paginationProps=Nt.k,this.isSuperAdmin=!1,this.isShowCustomCreatedDate=!1,this.isShowCustomDueDate=!1,this.allCompleteFilters={type:!1,status:!1,entryType:!1,scope:!1,priority:!1,sectors:!1},this.totalActivitiesCount=0,this.selection=new kt.Ov(!0,[]),this.filters={types:[],status:[],entryTypes:[],scope:[],priority:[],geography:[]},this.customCreatedDate=new d.cw({fromDate:new d.NI(null),toDate:new d.NI(null)}),this.customDueDate=new d.cw({fromDate:new d.NI(null),toDate:new d.NI(null)}),this.createdDate=new d.NI,this.dueDte=new d.NI,this.createdDateChipValue="",this.dueDateChipValue="",this.isResetFilters=!1,this.activitySearchCriteriaPayload=new qt.X({pageNumber:0,pageSize:this.paginationProps.pageSize,sortField:"",sortOrder:1,isArchive:!1,onlyMyTasks:!1}),this.isSuperAdmin=this.storageService.getDataFromLocalStorage(D.I.ROLE)===z.G.SuperAdmin}ngOnInit(){this.appliedFilters=this.storageService.getDataFromLocalStorage(D.I.ACTIVITY_FILTERS)&&JSON.parse(this.storageService.getDataFromLocalStorage(D.I.ACTIVITY_FILTERS)),this.appliedFilters&&(this.appliedFilters?.createdDate&&this.setCreatedDateFilter(),this.appliedFilters?.dueDate&&this.setDueDateFilter(),this.filters={types:this.appliedFilters.types?this.appliedFilters.types:[],status:this.appliedFilters.status?this.appliedFilters.status:[],entryTypes:this.appliedFilters.entryTypes?this.appliedFilters.entryTypes:[],scope:this.appliedFilters.scope?this.appliedFilters.scope:[],priority:this.appliedFilters.priority?this.appliedFilters.priority:[],geography:this.appliedFilters.geography?this.appliedFilters.geography:[]},0!==this.appliedFilters?.status?.length&&this.activityFiltersData.status.forEach(e=>{e.selected=!!this.appliedFilters?.status?.includes(e.key)}),0!==this.appliedFilters?.priority?.length&&this.activityFiltersData.priority.forEach(e=>{e.selected=!!this.appliedFilters?.priority?.includes(e.key)}),this.activitySearchCriteriaPayload.next(this.appliedFilters)),this.getAcivityMasterData(),this.selectedOrganizationService.getSelectedOrganization().subscribe(e=>{this.selectedOrganizationIds=e,this.getActivitiesSearchCriteria(),this.getTabBasedActivityCount()}),this.getLogedinUserDetails(),this.customCreatedDate.valueChanges.subscribe(e=>{if(null!==e.fromDate&&null!==e.toDate){let i;this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),this.activitySearchCriteriaPayload.next({...i,createdDate:{fromDate:e.fromDate?.toISOString(),toDate:e.toDate?.toISOString()}}),this.createdDateChipValue=`${e.fromDate?.toDateString()} - ${e.toDate?.toDateString()}`}}),this.customDueDate.valueChanges.subscribe(e=>{if(null!==e.fromDate&&null!==e.toDate){let i;this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),this.activitySearchCriteriaPayload.next({...i,dueDate:{fromDate:e.fromDate?.toISOString(),toDate:e.toDate?.toISOString()}}),this.dueDateChipValue=`${e.fromDate?.toDateString()} - ${e.toDate?.toDateString()}`}}),this.breadcrumbService.getSelectedActivitiesStatus().subscribe(e=>{e&&e.key&&(this.filters.status=[],this.activityFiltersData.status.map(i=>{i.selected=!1}),e.selected=!0,this.activityListFilterOnChanged({},"status",e))}),this.activitySearchCriteriaPayload.subscribe(e=>{this.getActivitiesSearchCriteria()}),this.activitySerachSubscription=this.searchTriggerService.getSearchData().subscribe(e=>{let i;this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),this.activitySearchCriteriaPayload.next({...i,searchTerm:e})})}setCreatedDateFilter(){let e=this.activityFiltersData.createddate.findIndex(i=>i.key.unit==this.appliedFilters.createdDate.unit);e>0?this.filterActivityListData("createdDate",{source:{value:this.activityFiltersData.createddate[e].key}},this.activityFiltersData.createddate[e].DisplayName):(this.appliedFilters.createdDate.fromDate||this.appliedFilters.createdDate.todate)&&(this.customCreatedDate.controls.fromDate.setValue(this.appliedFilters.createdDate.fromDate),this.customCreatedDate.controls.toDate.setValue(this.appliedFilters.createdDate?.toDate),this.isShowCustomCreatedDate=!0,this.createdDateChipValue=`${this.appliedFilters.createdDate.fromDate} - ${this.appliedFilters.createdDate.toDate}`)}setDueDateFilter(){let e=this.activityFiltersData.duedate.findIndex(i=>i.key==this.appliedFilters.dueDate.customString);e>0?this.filterActivityListData("dueDate",{source:{value:this.activityFiltersData.duedate[e].key}},this.activityFiltersData.duedate[e].DisplayName):(this.appliedFilters.dueDate.fromDate||this.appliedFilters.dueDate.todate)&&(this.customDueDate.controls.fromDate.setValue(this.appliedFilters.dueDate.fromDate),this.customCreatedDate.controls.toDate.setValue(this.appliedFilters.dueDate?.toDate),this.isShowCustomDueDate=!0,this.dueDateChipValue=`${this.appliedFilters.dueDate.fromDate} - ${this.appliedFilters.dueDate.toDate}`)}getActivitiesSearchCriteria(){let e;this.activitySearchCriteriaPayload.subscribe(n=>{this.storageService.setDataToLocalStorage(D.I.ACTIVITY_FILTERS,JSON.stringify(n)),e=n}),this.isResetFilters=!!(!Object.values(this.filters).every(n=>0===n.length)||e.createdDate&&""!==e.createdDate||e.dueDate&&""!==e.dueDate),e={...e,organizations:this.selectedOrganizationIds},this.activityService.getActivitiesSearchCriteria(e).subscribe(n=>{this.totalActivitiesCount=n.data[0]?.count[0]?.count?n.data[0]?.count[0]?.count:0,this.dataSource=new g.by(n.data[0].activities),this.activityStatusMetricsCount()})}getLogedinUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.logedInUserDetails=e})}downloadFile(){let e=0===this.selection.selected.length?this.dataSource.filteredData:this.selection.selected,i=[];for(let s=0;s<e.length;s++){const c=this.masterData.activityEntryTypesData.filter(p=>p._id===e[s].activitEntryType),r=this.masterData.activityTypesData.filter(p=>p._id===e[s].activityType),m={title:e[s].title,description:e[s].description.replace(/<[^>]*>/g,""),status:e[s].status,priority:e[s].priority,assignedTo:e[s].assignTo[0].organization,dueDate:e[s].dueDate,propertyName:"createdAt",reportedBy:e[s].createdByOrganization[0].organization,activityId:e[s].uniqIdentity,createdAt:e[s].createdAt,entryType:c[0].name,type:r[0].name,ministry:e[s].assignToObj[0].organization};i.push(m)}this.csvHelperService.downloadFile(i,"List of Activities",R)}isAllSelected(){const i=this.dataSource?.data.length;return this.selection.selected.length===i}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}ngAfterViewInit(){this.dataSource&&(this.dataSource.paginator=this.paginator)}onChangedPageSize(e){let i;this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),this.activitySearchCriteriaPayload.next({...i,pageNumber:e.pageIndex,pageSize:e.pageSize})}getAcivityMasterData(){this.activityService.getActivityMastarData().subscribe(e=>{e.data&&(this.masterData=e.data,this.masterData?.activityTypesData.forEach(i=>{i.selected=!(0===this.appliedFilters?.types?.length||!this.appliedFilters?.types||!this.appliedFilters.types.includes(i._id))}),this.masterData?.activityEntryTypesData.forEach(i=>{i.selected=!(0===this.appliedFilters?.entryTypes?.length||!this.appliedFilters?.entryTypes||!this.appliedFilters.entryTypes.includes(i._id))}),this.masterData?.activitySectorsData.forEach(i=>{i.selected=!(0===this.appliedFilters?.geography?.length||!this.appliedFilters?.geography||!this.appliedFilters.geography.includes(i._id))}),this.masterData?.activityScopesData.forEach(i=>{i.selected=!(0===this.appliedFilters?.scope?.length||!this.appliedFilters?.scope||!this.appliedFilters.scope.includes(i._id))}))})}navigateToActivityDetails(e){this.router.navigate([A.p.ACTIVITY_DETAILS],{queryParams:{aId:e}})}generateActivityRowActions(e,i){this.selectedActivtyForRowActions=i,this.activityRowActionByStatus=this.superAdminActivityRowActions[e],this.userActivityRowActionByStatus=this.userActivityRowActions.filter(n=>n.displayCondition(i,this.logedInUserDetails))}onActivityRowActionClick(e){switch(e){case"NEW":case"INPROGRESS":case"RESOLVED":case"REJECTED":this.updateActivityStatus(e);break;case"REPLY":this.moveToActivityDetail();break;case"ARCHIVE":this.updateArchivestatus();break;case"DELETE":this.deleteActivityByActivityId();break;case"EDIT":this.editActivityByActivityId();break;case"MOVE_TO_ORGANIZATION":this.activityService.openMoveToOrganizationPopup(this.selectedActivtyForRowActions._id).afterClosed().subscribe(i=>{i&&this.getActivitiesSearchCriteria()})}}updateActivityStatus(e){this.confirmationDialogService.open({message:`Are you sure to change activity ${this.selectedActivtyForRowActions.uniqIdentity} to ${e}`}).afterClosed().subscribe(i=>{i&&this.activityService.updateActivityStatus(this.selectedActivtyForRowActions._id,{status:e}).subscribe(n=>{this.alertpopupService.open({message:"Activity Status Updated Successfully",action:"ok"}),this.getActivitiesSearchCriteria()})},i=>{this.alertpopupService.open({message:i.message?i.message:"Unable to update Activity status",action:"ok"})})}updateArchivestatus(){this.confirmationDialogService.open({message:`Are you sure to Archive the activity ${this.selectedActivtyForRowActions.uniqIdentity}`}).afterClosed().subscribe(e=>{e&&this.activityService.updateArchivestatus(this.selectedActivtyForRowActions._id,{isArchive:!0}).subscribe(i=>{this.alertpopupService.open({message:"Activity Archived Successfully",action:"ok"}),this.getActivitiesSearchCriteria()})},e=>{this.alertpopupService.open({message:e.message?e.message:"Unable to archive Activity status",action:"ok"})})}deleteActivityByActivityId(){this.confirmationDialogService.open({message:`Are you sure to Delete activity ${this.selectedActivtyForRowActions.uniqIdentity}`}).afterClosed().subscribe(e=>{e&&this.activityService.deleteSelectedActivity(this.selectedActivtyForRowActions._id).subscribe(i=>{this.alertpopupService.open({message:"Activity Deleted Successfully",action:"ok"}),this.getActivitiesSearchCriteria()})},e=>{this.alertpopupService.open({message:e.message?e.message:"Unable to delete Activity status",action:"ok"})})}editActivityByActivityId(){this.router.navigate([A.p.CREATEACTIVITY],{queryParams:{aId:this.selectedActivtyForRowActions._id}})}moveToActivityDetail(){this.router.navigate([A.p.ACTIVITY_DETAILS],{queryParams:{aId:this.selectedActivtyForRowActions._id}})}filterActivityListData(e,i,n){let s;switch(this.activitySearchCriteriaPayload.subscribe(c=>{s=c}),e){case"createdDate":const c=i?.source?.value;"R"===c?.unit?this.isShowCustomCreatedDate=!0:"ALL"===c?(this.activitySearchCriteriaPayload.next({...s,createdDate:""}),this.isShowCustomCreatedDate=!1,this.customCreatedDate.reset(),this.createdDateChipValue=""):(this.activitySearchCriteriaPayload.next({...s,createdDate:c}),this.isShowCustomCreatedDate=!1,this.customCreatedDate.reset(),this.createdDateChipValue=n);break;case"dueDate":const r=i?.source?.value;"R"===r?this.isShowCustomDueDate=!0:"ALL"===r?(this.activitySearchCriteriaPayload.next({...s,dueDate:""}),this.isShowCustomDueDate=!1,this.customDueDate.reset(),this.dueDateChipValue=""):(this.activitySearchCriteriaPayload.next({...s,dueDate:{customString:r}}),this.isShowCustomDueDate=!1,this.customDueDate.reset(),this.dueDateChipValue=n)}}activityListFilterOnChanged(e,i,n){if(n.selected)this.filters[i].push(n._id?n._id:n.key);else if(n._id){let c=this.filters[i].findIndex(r=>r===n._id);this.filters[i].splice(c,1)}else{let c=this.filters[i].findIndex(r=>r===n.key);this.filters[i].splice(c,1)}let s;this.activitySearchCriteriaPayload.subscribe(c=>{s=c}),this.activitySearchCriteriaPayload.next({...s,...this.filters})}setAllFiltersToggle(e,i,n){!this.masterData[n]||this.masterData[n].forEach(s=>{s.selected=e})}removeFilter(e,i,n,s){let c;s?(this.masterData[e][i].selected=!1,c=this.masterData[e][i]._id):(this.activityFiltersData[e][i].selected=!1,c=this.activityFiltersData[e][i].key);let m,r=this.filters[n].findIndex(p=>p===c);this.filters[n].splice(r,1),this.activitySearchCriteriaPayload.subscribe(p=>{m=p}),this.activitySearchCriteriaPayload.next({...m,...this.filters})}removeDateFilter(e){let i;switch(this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),e){case"createdDate":this.activitySearchCriteriaPayload.next({...i,createdDate:""}),this.createdDateChipValue="";break;case"dueDate":this.activitySearchCriteriaPayload.next({...i,dueDate:""}),this.dueDateChipValue=""}}sortActivityListData(e){let i;this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),this.activitySearchCriteriaPayload.next({...i,sortField:e.key})}onActivityTabSelection(e){let i;switch(this.activitySearchCriteriaPayload.subscribe(n=>{i=n}),e.tab.textLabel){case"ALL":this.activitySearchCriteriaPayload.next({...i,priority:[],status:[],dueDate:void 0,onlyMyTasks:!1});break;case"MY_TASKS":this.activitySearchCriteriaPayload.next({...i,priority:[],status:[],dueDate:void 0,onlyMyTasks:!0,organizations:this.selectedOrganizationIds});break;case"ACTIVE":this.activitySearchCriteriaPayload.next({...i,priority:[],status:["INPROGRESS","NEW"],dueDate:void 0,onlyMyTasks:!1});break;case"OVERDUE":this.activitySearchCriteriaPayload.next({...i,priority:[],status:[],dueDate:{customString:"OVERDUE"},onlyMyTasks:!1});break;case"HIGH":this.activitySearchCriteriaPayload.next({...i,priority:["HIGH"],status:[],dueDate:void 0,onlyMyTasks:!1})}}resetAllFilters(){this.activityFiltersData.status.forEach(e=>{e.selected=!1}),this.activityFiltersData.priority.forEach(e=>{e.selected=!1}),this.masterData?.activityTypesData.forEach(e=>{e.selected=!1}),this.masterData?.activityEntryTypesData.forEach(e=>{e.selected=!1}),this.masterData?.activitySectorsData.forEach(e=>{e.selected=!1}),this.masterData?.activityScopesData.forEach(e=>{e.selected=!1}),this.filters={types:[],status:[],entryTypes:[],scope:[],priority:[],geography:[]},this.activitySearchCriteriaPayload.next({pageNumber:0,pageSize:this.paginationProps.pageSize,sortField:"",sortOrder:1,isArchive:!1,onlyMyTasks:!1}),this.createdDateChipValue="",this.dueDateChipValue=""}getTabBasedActivityCount(){this.activityService.getActivitiesCountForHeaders({organizations:this.selectedOrganizationIds}).subscribe(i=>{this.activitiesTabCount=i.data[0]})}activityStatusMetricsCount(){this.dashboardService.postDashBoardActivityMetrics({organizations:this.selectedOrganizationIds}).subscribe(i=>{this.activityFiltersData.status[0]={...this.activityFiltersData.status[0],count:i.data[0]?.new[0]?.newCount},this.activityFiltersData.status[1]={...this.activityFiltersData.status[1],count:i.data[0]?.inProgress[0]?.inProgressCount},this.activityFiltersData.status[2]={...this.activityFiltersData.status[2],count:i.data[0]?.resolved[0]?.resolvedCount},this.activityFiltersData.status[3]={...this.activityFiltersData.status[3],count:i.data[0]?.rejectedCount[0]?.rejectedCount}})}ngOnDestroy(){this.activitySerachSubscription.unsubscribe()}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(q.M),t.Y36(U.V),t.Y36(f.F0),t.Y36(O.H),t.Y36(k.z),t.Y36(Q.O),t.Y36(Ut.p),t.Y36(L),t.Y36(Ot.s),t.Y36(Et.s),t.Y36(wt.V))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-activity"]],viewQuery:function(e,i){if(1&e&&t.Gf(V.NW,5),2&e){let n;t.iGM(n=t.CRH())&&(i.paginator=n.first)}},decls:159,vars:45,consts:[[1,"d-flex","justify-content-between","mb-2"],["aria-label","Fruit selection"],["chipList",""],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-end","activity_actions"],["mat-button","","class","resetButton",3,"click",4,"ngIf"],["mat-button","","matTooltip","Download",1,"",3,"click"],[1,"icon-taskdownl"],[1,"download"],["mat-button","","matTooltip","Filters",3,"matMenuTriggerFor"],["filters","matMenu"],["mat-menu-item","",3,"matMenuTriggerFor"],["groupBymenu","matMenu"],["mat-button","","matTooltip","Sort By",3,"matMenuTriggerFor"],["sortby","matMenu"],[3,"click",4,"ngFor","ngForOf"],["createddate","matMenu"],["aria-labelledby","example-radio-group-label",1,"example-radio-group",3,"click"],["class","example-radio-button",3,"value","change",4,"ngFor","ngForOf"],["appearance","fill",3,"ngStyle","click",4,"ngIf"],["duedate","matMenu"],[3,"click"],["aria-labelledby","example-radio-group-label",1,"example-radio-group"],["status","matMenu"],[1,"example-section"],[1,"example-list-section"],["class","example-margin",3,"ngModel","ngModelChange","change",4,"ngFor","ngForOf"],["types","matMenu"],[1,"example-margin",3,"checked","change"],["entrytype","matMenu"],["geography","matMenu"],["scope","matMenu"],["priority","matMenu"],["createdby","matMenu"],["assignto","matMenu"],[1,"activities-list",3,"selectedTabChange"],["label","ALL"],["mat-tab-label",""],["label","MY_TASKS"],["label","ACTIVE"],["label","OVERDUE"],["mat-table","",1,"mat-elevation-z8","userTable",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Status"],["mat-cell","","class","status-badge",4,"matCellDef"],["matColumnDef","Activity"],["mat-cell","","class","cursor",3,"click",4,"matCellDef"],["matColumnDef","Title"],["matColumnDef","Priority"],["matColumnDef","Duedate"],["matColumnDef","Assignto"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize","pageSizeOptions","page"],["menu","matMenu"],["matChipRemove",""],["mat-button","",1,"resetButton",3,"click"],[1,"example-radio-button",3,"value","change"],["appearance","fill",3,"ngStyle","click"],[3,"formGroup","rangePicker"],["matStartDate","","formControlName","fromDate","placeholder","Start date"],["matEndDate","","formControlName","toDate","placeholder","End date"],["matSuffix","",3,"for"],["picker",""],["picker1",""],[1,"example-margin",3,"ngModel","ngModelChange","change"],[1,"example-margin"],[1,"d-flex","align-items-center","gap-1"],["label","HIGH"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor","click"],["mat-cell","",1,"status-badge"],[1,"badge",3,"ngClass"],["mat-cell","",1,"cursor",3,"click"],[1,"cursor",3,"click"],["mat-header-row",""],["mat-row",""],[1,"noActivities-message"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"]],template:function(e,i){if(1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div")(3,"mat-chip-list",1,2),t.YNc(5,Rt,2,1,"ng-container",3),t.YNc(6,Qt,2,1,"ng-container",3),t.YNc(7,Yt,2,1,"ng-container",3),t.YNc(8,$t,2,1,"ng-container",3),t.YNc(9,Gt,2,1,"ng-container",3),t.YNc(10,jt,2,1,"ng-container",3),t.ynx(11),t.YNc(12,Kt,5,1,"mat-chip",4),t.BQk(),t.ynx(13),t.YNc(14,Wt,5,1,"mat-chip",4),t.BQk(),t.qZA()(),t.TgZ(15,"div",5),t.YNc(16,Xt,2,0,"button",6),t.TgZ(17,"button",7),t.NdJ("click",function(){return i.downloadFile()}),t._UZ(18,"i",8),t.TgZ(19,"mat-icon",9),t._uU(20,"file_download"),t.qZA()(),t.TgZ(21,"button",10)(22,"mat-icon"),t._uU(23," filter_alt"),t.qZA(),t._uU(24,"Filters "),t.TgZ(25,"mat-icon"),t._uU(26,"keyboard_arrow_down"),t.qZA()(),t.TgZ(27,"mat-menu",null,11)(29,"button",12),t._uU(30,"Created Date"),t.qZA(),t.TgZ(31,"button",12),t._uU(32,"Due Date"),t.qZA(),t.TgZ(33,"button",12),t._uU(34,"Status"),t.qZA(),t.TgZ(35,"button",12),t._uU(36,"Types"),t.qZA(),t.TgZ(37,"button",12),t._uU(38,"Entry Type"),t.qZA(),t.TgZ(39,"button",12),t._uU(40,"Geography"),t.qZA(),t.TgZ(41,"button",12),t._uU(42,"Scope"),t.qZA(),t.TgZ(43,"button",12),t._uU(44,"Priority"),t.qZA()(),t.TgZ(45,"mat-menu",null,13),t.YNc(47,te,2,1,"mat-option",3),t.qZA(),t.TgZ(48,"button",14)(49,"mat-icon"),t._uU(50,"sort"),t.qZA(),t._uU(51," Sort By "),t.TgZ(52,"mat-icon"),t._uU(53,"keyboard_arrow_down"),t.qZA()(),t.TgZ(54,"mat-menu",null,15),t.YNc(56,ee,2,1,"mat-option",16),t.qZA()()(),t.TgZ(57,"mat-menu",null,17)(59,"mat-radio-group",18),t.NdJ("click",function(s){return s.stopPropagation()}),t.YNc(60,ie,2,2,"mat-radio-button",19),t.qZA(),t.YNc(61,oe,11,7,"mat-form-field",20),t.qZA(),t.TgZ(62,"mat-menu",null,21)(64,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(65,"mat-radio-group",23),t.YNc(66,se,2,2,"mat-radio-button",19),t.qZA(),t.YNc(67,le,11,7,"mat-form-field",20),t.qZA()(),t.TgZ(68,"mat-menu",null,24)(70,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(71,"section",25)(72,"span",26),t.YNc(73,de,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(74,"mat-menu",null,28)(76,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(77,"section",25)(78,"span",26)(79,"mat-checkbox",29),t.NdJ("change",function(s){return i.setAllFiltersToggle(s.checked,"type","activityTypesData")}),t._uU(80," All "),t.qZA()(),t.TgZ(81,"span",26),t.YNc(82,pe,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(83,"mat-menu",null,30)(85,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(86,"section",25)(87,"span",26)(88,"mat-checkbox",29),t.NdJ("change",function(s){return i.setAllFiltersToggle(s.checked,"entryType","activityEntryTypesData")}),t._uU(89," All "),t.qZA()(),t.TgZ(90,"span",26),t.YNc(91,ue,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(92,"mat-menu",null,31)(94,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(95,"section",25)(96,"span",26),t.YNc(97,me,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(98,"mat-menu",null,32)(100,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(101,"section")(102,"span"),t.YNc(103,_e,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(104,"mat-menu",null,33)(106,"div",22),t.NdJ("click",function(s){return s.stopPropagation()}),t.TgZ(107,"section",25)(108,"span",26),t.YNc(109,ge,2,2,"mat-checkbox",27),t.qZA()()()(),t.TgZ(110,"mat-menu",null,34),t.YNc(112,ve,4,1,"div",16),t.qZA(),t.TgZ(113,"mat-menu",null,35),t.YNc(115,ye,4,1,"div",16),t.qZA()(),t.TgZ(116,"mat-tab-group",36),t.NdJ("selectedTabChange",function(s){return i.onActivityTabSelection(s)}),t.TgZ(117,"mat-tab",37),t.YNc(118,he,4,1,"ng-template",38),t.qZA(),t.TgZ(119,"mat-tab",39),t.YNc(120,fe,4,1,"ng-template",38),t.qZA(),t.TgZ(121,"mat-tab",40),t.YNc(122,Ae,4,1,"ng-template",38),t.qZA(),t.TgZ(123,"mat-tab",41),t.YNc(124,Te,4,1,"ng-template",38),t.qZA(),t.YNc(125,Ce,3,0,"div",4),t.qZA(),t.TgZ(126,"table",42),t.ynx(127,43),t.YNc(128,xe,2,3,"th",44),t.YNc(129,Ze,5,3,"td",45),t.BQk(),t.ynx(130,46),t.YNc(131,be,2,0,"th",44),t.YNc(132,ke,4,9,"td",47),t.BQk(),t.ynx(133,48),t.YNc(134,Fe,2,0,"th",44),t.YNc(135,Ne,2,1,"td",49),t.BQk(),t.ynx(136,50),t.YNc(137,Ie,2,0,"th",44),t.YNc(138,qe,2,1,"td",49),t.BQk(),t.ynx(139,51),t.YNc(140,Ue,2,0,"th",44),t.YNc(141,Oe,2,1,"td",45),t.BQk(),t.ynx(142,52),t.YNc(143,Ee,2,0,"th",44),t.YNc(144,we,3,4,"td",45),t.BQk(),t.ynx(145,53),t.YNc(146,Me,2,0,"th",44),t.YNc(147,Je,2,1,"td",45),t.BQk(),t.ynx(148,54),t.YNc(149,ze,2,0,"th",44),t.YNc(150,Re,3,0,"td",45),t.BQk(),t.YNc(151,Pe,1,0,"tr",55),t.YNc(152,Qe,1,0,"tr",56),t.qZA(),t.YNc(153,Le,3,0,"div",4),t.TgZ(154,"mat-paginator",57),t.NdJ("page",function(s){return i.onChangedPageSize(s)}),t.qZA(),t.TgZ(155,"mat-menu",null,58),t.YNc(157,Be,2,1,"ng-container",4),t.YNc(158,He,2,1,"ng-container",4),t.qZA()),2&e){const n=t.MAs(28),s=t.MAs(55),c=t.MAs(58),r=t.MAs(63),m=t.MAs(69),p=t.MAs(75),v=t.MAs(84),Z=t.MAs(93),b=t.MAs(99),J=t.MAs(105);t.xp6(5),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityTypesData),t.xp6(1),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityEntryTypesData),t.xp6(1),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activitySectorsData),t.xp6(1),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityScopesData),t.xp6(1),t.Q6J("ngForOf",i.activityFiltersData.priority),t.xp6(1),t.Q6J("ngForOf",i.activityFiltersData.status),t.xp6(2),t.Q6J("ngIf",i.createdDateChipValue&&""!==i.createdDateChipValue),t.xp6(2),t.Q6J("ngIf",i.dueDateChipValue&&""!==i.dueDateChipValue),t.xp6(2),t.Q6J("ngIf",i.isResetFilters),t.xp6(5),t.Q6J("matMenuTriggerFor",n),t.xp6(8),t.Q6J("matMenuTriggerFor",c),t.xp6(2),t.Q6J("matMenuTriggerFor",r),t.xp6(2),t.Q6J("matMenuTriggerFor",m),t.xp6(2),t.Q6J("matMenuTriggerFor",p),t.xp6(2),t.Q6J("matMenuTriggerFor",v),t.xp6(2),t.Q6J("matMenuTriggerFor",Z),t.xp6(2),t.Q6J("matMenuTriggerFor",b),t.xp6(2),t.Q6J("matMenuTriggerFor",J),t.xp6(4),t.Q6J("ngForOf",i.activityFiltersData.groupBy),t.xp6(1),t.Q6J("matMenuTriggerFor",s),t.xp6(8),t.Q6J("ngForOf",i.activityFiltersData.sortBy),t.xp6(4),t.Q6J("ngForOf",i.activityFiltersData.createddate),t.xp6(1),t.Q6J("ngIf",i.isShowCustomCreatedDate),t.xp6(5),t.Q6J("ngForOf",i.activityFiltersData.duedate),t.xp6(1),t.Q6J("ngIf",i.isShowCustomDueDate),t.xp6(6),t.Q6J("ngForOf",i.activityFiltersData.status),t.xp6(6),t.Q6J("checked",i.allCompleteFilters.type),t.xp6(3),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityTypesData),t.xp6(6),t.Q6J("checked",i.allCompleteFilters.entryType),t.xp6(3),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityEntryTypesData),t.xp6(6),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activitySectorsData),t.xp6(6),t.Q6J("ngForOf",null==i.masterData?null:i.masterData.activityScopesData),t.xp6(6),t.Q6J("ngForOf",i.activityFiltersData.priority),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.createdby),t.xp6(3),t.Q6J("ngForOf",i.activityFiltersData.assignedto),t.xp6(10),t.Q6J("ngIf",i.isSuperAdmin),t.xp6(1),t.Q6J("dataSource",i.dataSource),t.xp6(25),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===(null==i.dataSource||null==i.dataSource.filteredData?null:i.dataSource.filteredData.length)),t.xp6(1),t.Q6J("length",i.totalActivitiesCount)("pageSize",i.paginationProps.pageSize)("pageSizeOptions",i.paginationProps.pageSizeOptions),t.xp6(3),t.Q6J("ngIf",i.isSuperAdmin),t.xp6(1),t.Q6J("ngIf",!1===i.isSuperAdmin)}},dependencies:[u.mk,u.sg,u.O5,u.PC,d.Fj,d.JJ,d.JL,d.sg,d.u,E.ey,w.lW,Mt.a8,Jt.oG,x.qn,x.HS,x.qH,y.nW,y.wx,y.zY,y.By,y._g,F.Hw,h.TO,h.KE,h.hX,h.R9,C.VK,C.OP,C.p6,V.NW,N.VQ,N.U0,g.BZ,g.fO,g.as,g.w1,g.Dz,g.nj,g.ge,g.ev,g.XQ,g.Gk,M.SP,M.uD,M.uX,$.gM,d.On,u.rS,u.uU],styles:["md-select[_ngcontent-%COMP%]{background-color:#fff;color:#000;border:1px solid #666666}.userTable[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px;text-align:left;border-bottom:1px solid rgb(206,202,202)}.example-margin[_ngcontent-%COMP%]{margin:0 12px;display:block}.example-radio-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}.example-radio-button[_ngcontent-%COMP%]{margin:5px}.blue-color[_ngcontent-%COMP%]{color:#00f}.status-badge[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%], .status-badge[_ngcontent-%COMP%]   .badge-resolved[_ngcontent-%COMP%], .status-badge[_ngcontent-%COMP%]   .badge-not-admissible[_ngcontent-%COMP%], .status-badge[_ngcontent-%COMP%]   .badge-in-progress[_ngcontent-%COMP%], .status-badge[_ngcontent-%COMP%]   .badge-new[_ngcontent-%COMP%]{width:100px;color:#fff;text-align:center;padding:5px 9px;letter-spacing:.1em;font-weight:500;font-size:12px;border-radius:0;text-transform:capitalize}.status-badge[_ngcontent-%COMP%]   .badge-new[_ngcontent-%COMP%]{background-color:#ffae3ee0}.status-badge[_ngcontent-%COMP%]   .badge-in-progress[_ngcontent-%COMP%]{background-color:#012970c2}.status-badge[_ngcontent-%COMP%]   .badge-not-admissible[_ngcontent-%COMP%]{background-color:#ff4b3edb}.status-badge[_ngcontent-%COMP%]   .badge-resolved[_ngcontent-%COMP%]{background-color:#3eb365}.cursor[_ngcontent-%COMP%]{cursor:pointer}.noActivities-message[_ngcontent-%COMP%]{text-align:center;color:#e90e0e}"]}),a})();var Ve=l(4128);function je(a,o){1&a&&(t.TgZ(0,"div",4)(1,"h2",5),t._uU(2," you are not part of any organization so you cannot create activity"),t.qZA()())}function Ke(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.organization)}}function We(a,o){if(1&a&&(t.ynx(0),t.TgZ(1,"mat-form-field",13)(2,"mat-label"),t._uU(3,"organizations"),t.qZA(),t.TgZ(4,"mat-select",32),t.YNc(5,Ke,2,2,"mat-option",15),t.qZA()(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(5),t.Q6J("ngForOf",null==e.userDetails?null:e.userDetails.organizationsdata)}}function Xe(a,o){if(1&a&&(t.ynx(0),t.TgZ(1,"h3",34),t._uU(2),t.qZA(),t.BQk()),2&a){const e=t.oxw(2);t.xp6(2),t.hij("organization : ",1===(null==e.userDetails||null==e.userDetails.organizationsdata?null:e.userDetails.organizationsdata.length)?null==e.userDetails||null==e.userDetails.organizationsdata[0]?null:e.userDetails.organizationsdata[0].organization:"No Assigned organization","")}}function ti(a,o){1&a&&(t.TgZ(0,"mat-icon",37),t._uU(1,"cancel"),t.qZA())}function ei(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"mat-chip",35),t.NdJ("removed",function(){const s=t.CHM(e).index,c=t.oxw(2);return t.KtG(c.removeChip(s))}),t._uU(1),t.YNc(2,ti,2,0,"mat-icon",36),t.qZA()}if(2&a){const e=o.$implicit,i=t.oxw(2);t.Q6J("removable",i.removable),t.xp6(1),t.hij(" ",e.organization," "),t.xp6(1),t.Q6J("ngIf",i.removable)}}function ii(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function ai(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e.organization)}}function ni(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function oi(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function si(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function ci(a,o){if(1&a&&(t.TgZ(0,"mat-option",33),t._uU(1),t.qZA()),2&a){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.name)}}function ri(a,o){if(1&a){const e=t.EpF();t.TgZ(0,"div",6)(1,"form",7),t.NdJ("ngSubmit",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.onSubmit())}),t.TgZ(2,"div",8)(3,"div",9),t.YNc(4,We,6,1,"ng-container",10),t.YNc(5,Xe,3,1,"ng-container",10),t.qZA(),t.TgZ(6,"div",11)(7,"mat-chip-list"),t.YNc(8,ei,3,3,"mat-chip",12),t.qZA()()(),t.TgZ(9,"div",8)(10,"div",9)(11,"mat-form-field",13)(12,"mat-label"),t._uU(13,"Type"),t.qZA(),t.TgZ(14,"mat-select",14),t.YNc(15,ii,2,2,"mat-option",15),t.qZA()()(),t.TgZ(16,"div",9)(17,"mat-form-field",13)(18,"mat-label"),t._uU(19,"Ministry/Department"),t.qZA(),t.TgZ(20,"mat-select",16),t.YNc(21,ai,2,2,"mat-option",15),t.qZA()()()(),t.TgZ(22,"div",8)(23,"div",9)(24,"mat-form-field",13)(25,"mat-label"),t._uU(26,"Related To"),t.qZA(),t.TgZ(27,"mat-select",17),t.YNc(28,ni,2,2,"mat-option",15),t.qZA()()(),t.TgZ(29,"div",9)(30,"mat-form-field",18)(31,"mat-label"),t._uU(32,"Entry Type"),t.qZA(),t.TgZ(33,"mat-select",19),t.YNc(34,oi,2,2,"mat-option",15),t.qZA()()()(),t.TgZ(35,"div",8)(36,"div",9)(37,"mat-form-field",13)(38,"mat-label"),t._uU(39,"Sector"),t.qZA(),t.TgZ(40,"mat-select",20),t.YNc(41,si,2,2,"mat-option",15),t.qZA()()(),t.TgZ(42,"div",9)(43,"mat-form-field",13)(44,"mat-label"),t._uU(45,"Scope"),t.qZA(),t.TgZ(46,"mat-select",21),t.YNc(47,ci,2,2,"mat-option",15),t.qZA()()()(),t.TgZ(48,"div",8)(49,"div",22)(50,"mat-form-field",13)(51,"mat-label"),t._uU(52,"Title"),t.qZA(),t.TgZ(53,"div"),t._UZ(54,"input",23),t.qZA()()()(),t.TgZ(55,"h3",24),t._uU(56,"Description* :"),t.qZA(),t.TgZ(57,"div",25)(58,"app-rich-text-editor",26),t.NdJ("updatedDescription",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.updatedDescription(n))}),t.qZA()(),t.TgZ(59,"div",27)(60,"h3",24),t._uU(61,"Attachments :"),t.qZA(),t.TgZ(62,"app-fileuploader",28),t.NdJ("updatedFilesDescription",function(n){t.CHM(e);const s=t.oxw();return t.KtG(s.updatedFilesDescription(n))}),t.qZA()(),t.TgZ(63,"div",29)(64,"button",30),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.gotoDashboard())}),t._uU(65,"Cancel"),t.qZA(),t.TgZ(66,"button",31),t._uU(67,"Submit"),t.qZA()()()()}if(2&a){const e=t.oxw();let i;t.xp6(1),t.Q6J("formGroup",e.activityForm),t.xp6(3),t.Q6J("ngIf",(null==e.userDetails||null==e.userDetails.organizationsdata?null:e.userDetails.organizationsdata.length)>1),t.xp6(1),t.Q6J("ngIf",(null==e.userDetails||null==e.userDetails.organizationsdata?null:e.userDetails.organizationsdata.length)<=1),t.xp6(3),t.Q6J("ngForOf",null==(i=e.activityForm.get("organization"))?null:i.value),t.xp6(7),t.Q6J("ngForOf",e.activityTypesData),t.xp6(6),t.Q6J("ngForOf",e.organizationsData),t.xp6(7),t.Q6J("ngForOf",e.activityRelatedTypesData),t.xp6(6),t.Q6J("ngForOf",e.activityEntryTypesData),t.xp6(7),t.Q6J("ngForOf",e.activitySectorsData),t.xp6(6),t.Q6J("ngForOf",e.activityScopesData),t.xp6(11),t.Q6J("value",e.description),t.xp6(8),t.Q6J("disabled",!e.discriptionData)}}const li=[{path:"",component:Ge},{path:"create",component:(()=>{class a{constructor(e,i,n,s,c,r,m,p){this.organizationService=e,this.formBuilder=i,this.activityService=n,this.alertpopupService=s,this.storageService=c,this.activatedRoute=r,this.userDetailsService=m,this.router=p,this.removable=!0,this.filesListArray=[],this.priority=I,this.status=T,this.activatedRoute.queryParams.subscribe(v=>{this.selectedActivityId=v.aId})}ngOnInit(){this.generateAddNewUserForm(),this.getUserDetails(),this.selectedActivityId?this.forkJoinResult():(this.getAllOrganization(),this.getActivityMasterData())}forkJoinResult(){(0,Ve.D)([this.organizations$,this.activityMasterData$,this.activity$]).subscribe(e=>{this.organizationsData=e[0]?.organizations;const i=e[0]?.organizations.filter(n=>e[2].data[0]?.organizationData.find(s=>s._id===n._id));this.activityTypesData=e[1]?.data.activityTypesData,this.activityRelatedTypesData=e[1]?.data?.activityRelatedTypesData,this.activityEntryTypesData=e[1]?.data?.activityEntryTypesData,this.activitySectorsData=e[1]?.data?.activitySectorsData,this.activityScopesData=e[1]?.data?.activityScopesData,this.selectedActivityData=e[2]?.data[0],this.activityForm.controls.activityType.setValue(this.selectedActivityData?.activityType),this.activityForm.controls.activityRelatedTo.setValue(this.selectedActivityData?.activityRelatedTo),this.activityForm.controls.organization?.setValue(i),this.activityForm.controls.activitEntryType.setValue(this.selectedActivityData?.activitEntryType),this.activityForm.controls.activitySector.setValue(this.selectedActivityData?.activitySector),this.activityForm.controls.activityScope.setValue(this.selectedActivityData?.activityScope),this.activityForm.controls.title.setValue(this.selectedActivityData?.title),this.activityForm.controls.createdByOrganization.setValue(this.selectedActivityData?.createdByOrganization),this.description=this.selectedActivityData.description})}get organizations$(){return this.organizationService.getAllOrganizations()}getAllOrganization(){this.organizations$.subscribe(e=>{this.organizationsData=e?.organizations,this.organizationList=e?.organizations})}get activityMasterData$(){return this.activityService.getActivitiesMasterData()}getActivityMasterData(){this.activityService.getActivitiesMasterData().subscribe(e=>{this.activityTypesData=e?.data?.activityTypesData,this.activityRelatedTypesData=e?.data?.activityRelatedTypesData,this.activityEntryTypesData=e?.data?.activityEntryTypesData,this.activitySectorsData=e?.data?.activitySectorsData,this.activityScopesData=e?.data?.activityScopesData})}generateAddNewUserForm(){this.activityForm=this.formBuilder.group({activityType:["",_.kI.required],activityRelatedTo:["",_.kI.required],organization:["",_.kI.required],activitEntryType:["",_.kI.required],activitySector:["",_.kI.required],activityScope:["",_.kI.required],title:["",_.kI.required],createdByOrganization:["",_.kI.required]})}get activity$(){return this.activityService.getActivityById(this.selectedActivityId)}onSubmit(){if(this.filesListArray?.length>0){const e=this.userDetails?.organizationsdata.filter(i=>i._id===this.activityForm.controls.createdByOrganization.value);this.filesListArray.map(i=>{i.organization=e[0]?.organization,i.organizationId=e[0]?._id})}if(this.selectedOrganizationValue=this.activityForm.get("organization")?.value.map(e=>e._id),this.selectedActivityId){const e={...this.activityForm.value,attachments:[...this.filesListArray,...this.selectedActivityData.attachments],organization:this.selectedOrganizationValue,description:this.descriptionOfTextEditor};this.activityService.updateActivity(this.selectedActivityId,e).subscribe(i=>{if(0!==this.fileAttachmments?.length){let n=new FormData;for(let s=0;s<this.fileAttachmments?.length;s++)n.append(i?.data[0]?._id,this.fileAttachmments[s],this.filesListArray[s]?.name);this.uploadAttachments(n)}this.alertpopupService.open({message:i.message?i.message:"Activity updated Successfully",action:"ok"})},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}else{const e={...this.activityForm.value,attachments:this.filesListArray,organization:this.selectedOrganizationValue,priority:I[0],status:T[0],description:this.descriptionOfTextEditor,visibility:"INTERNAL"};this.activityService.postActivity(e).subscribe(i=>{if(this.fileAttachmments?.length>0){let n=new FormData;for(let s=0;s<this.fileAttachmments?.length;s++)n.append(i.newActivity._id,this.fileAttachmments[s],this.filesListArray[s].name);this.uploadAttachments(n)}this.alertpopupService.open({message:i.message?i.message:"Activity Created Successfully",action:"ok"}),this.router.navigate([A.p.ACTIVITY])},i=>{this.alertpopupService.open({message:i.message?i.message:"something went wrong!",action:"ok"})})}}relatedValue(e){"Multiple Ministries/Departments"===e.value&&(this.isMultipleOrganization=!1)}removeChip(e){let i=this.activityForm.controls.organization;i.value.splice(e,1),this.activityForm.controls.organization?.setValue(i.value)}removeFileChip(e){this.filesListArray.splice(e,1)}getUserDetails(){this.userDetailsService.getUserDetails().subscribe(e=>{this.userDetails=e,1===this.userDetails?.organization?.length&&this.activityForm?.controls.createdByOrganization?.setValue(this.userDetails?.organization[0])})}updatedDescription(e){this.descriptionOfTextEditor=e,this.discriptionData=e?.replace(/<[^>]*>/g,"")}updatedFilesDescription(e){let i=e.target.files;this.fileAttachmments=i;for(var n=0;n<i.length;n++)this.filesListArray.push({name:i[n].name,size:i[n].size.toString(),path:"string"})}uploadAttachments(e){this.activityService.uploadAttachments(e).subscribe(i=>{})}gotoDashboard(){this.router.navigate([A.p.DASHBOARD])}}return a.\u0275fac=function(e){return new(e||a)(t.Y36(P.M),t.Y36(d.qu),t.Y36(q.M),t.Y36(k.z),t.Y36(U.V),t.Y36(f.gz),t.Y36(O.H),t.Y36(f.F0))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-createactivity"]],decls:8,vars:3,consts:[[1,"container","create-activity"],[1,"d-flex","create-activity-header","align-items-baseline"],["class","d-flex justify-content-center",4,"ngIf"],["class","acitivity-panel",4,"ngIf"],[1,"d-flex","justify-content-center"],[1,"errorMsg"],[1,"acitivity-panel"],[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-6"],[4,"ngIf"],[1,"col-6","mb-4"],[3,"removable","removed",4,"ngFor","ngForOf"],["appearance","outline",1,"input-field"],["formControlName","activityType","required",""],[3,"value",4,"ngFor","ngForOf"],["multiple","multiple","formControlName","organization","required",""],["formControlName","activityRelatedTo","required",""],["appearance","outline",1,"col-12"],["formControlName","activitEntryType","required",""],["formControlName","activitySector","required",""],["formControlName","activityScope","required",""],[1,"col-12"],["matInput","","placeholder","Add an activity here & hit enter...","input","","type","text","formControlName","title","required",""],[1,"m-0"],[1,"text-editor","mb-1"],[3,"value","updatedDescription"],[1,"mt-2"],[3,"updatedFilesDescription"],[1,"text-end"],["mat-raised-button","","color","primary","type","button",3,"click"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["formControlName","createdByOrganization","required",""],[3,"value"],[1,"username"],[3,"removable","removed"],["matChipRemove","",4,"ngIf"],["matChipRemove",""]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon"),t._uU(3," note_add"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()(),t.YNc(6,je,3,0,"div",2),t.YNc(7,ri,68,12,"div",3),t.qZA()),2&e&&(t.xp6(5),t.Oqu(i.selectedActivityId?"Update Activity":"Create Activity"),t.xp6(1),t.Q6J("ngIf",0===(null==i.userDetails||null==i.userDetails.organizationsdata?null:i.userDetails.organizationsdata.length)),t.xp6(1),t.Q6J("ngIf",(null==i.userDetails||null==i.userDetails.organizationsdata?null:i.userDetails.organizationsdata.length)>=1))},dependencies:[u.sg,u.O5,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.sg,d.u,E.ey,w.lW,x.qn,x.HS,x.qH,F.Hw,h.KE,h.hX,Y.Nt,B.gD,H,G],styles:[".container[_ngcontent-%COMP%]{background-color:#fff}.create-activity[_ngcontent-%COMP%]{padding:0;width:80%;border:1px solid silver}.create-activity-header[_ngcontent-%COMP%]{background:#eeeeee;border-bottom:1px solid #dcdadb;color:#444;font-size:22px;font-weight:700;height:55px;padding:11px 10px 0;gap:5px}.text-editor[_ngcontent-%COMP%]{border:1px solid rgba(0,0,0,.2)}.username[_ngcontent-%COMP%]{font-size:20px}.input-field[_ngcontent-%COMP%]{display:block}  .NgxEditor{height:200px;overflow-y:auto;border-radius:0}  .NgxEditor__Content{min-height:150px}.errorMsg[_ngcontent-%COMP%]{color:#c45454}"]}),a})()},{path:"details",component:St}];let di=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[f.Bz.forChild(li),f.Bz]}),a})();var pi=l(1252);let ui=(()=>{class a{}return a.\u0275fac=function(e){return new(e||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[u.ez,di,d.UX,pi.m,d.u5]}),a})()},8202:(K,S,l)=>{l.d(S,{t:()=>u});const u={IS_ACTIVE:2,MINISTRIES:1,ASSOCIATION:0,INACTIVE:3,MY_PROFILE:4,CHANGE_PASSWORD:5,NOTIFICATIONS:6,EMAIL_REPORTS:7}}}]);
"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[411],{9411:(O,_,s)=>{s.r(_),s.d(_,{OrganizationModule:()=>pt});var g=s(6895),T=s(8210),f=s(4006),v=s(3060),m=s(8202),z=s(4025),b=s(7335),t=s(4650),U=s(7199),x=s(3081),Z=s(3293),d=s(5938);let y=(()=>{class i{constructor(e){this.matDialog=e}openAddUser(e){return this.matDialog.open(Z.H,{disableClose:!0,minWidth:"1200px",data:e})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(d.uw))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var C=s(2653),I=s(5017),c=s(3626),N=s(4859),u=s(3546),P=s(6709),S=s(7331),R=s(7392),A=s(9549),L=s(4144),w=s(455);function D(i,a){if(1&i&&(t.TgZ(0,"mat-chip"),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.Name)}}function k(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"th",24)(1,"mat-checkbox",25),t.NdJ("change",function(n){t.CHM(e);const r=t.oxw();return t.KtG(n?r.toggleAllRows():null)}),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.tableRowSelection.hasValue()&&e.isAllSelected())("indeterminate",e.tableRowSelection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function E(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"td",26)(1,"mat-checkbox",27),t.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const l=t.CHM(e).$implicit,p=t.oxw();return t.KtG(n?p.tableRowSelection.toggle(l):null)}),t.qZA()()}if(2&i){const e=a.$implicit,o=t.oxw();t.xp6(1),t.Q6J("checked",o.tableRowSelection.isSelected(e))("aria-label",o.checkboxLabel(e))}}function F(i,a){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Name"),t.qZA())}function Y(i,a){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(null==e?null:e.Name)}}function M(i,a){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Email"),t.qZA())}function J(i,a){if(1&i&&(t.TgZ(0,"td",26),t._uU(1),t.qZA()),2&i){const e=a.$implicit;t.xp6(1),t.Oqu(e.email)}}function Q(i,a){1&i&&(t.TgZ(0,"th",24),t._uU(1,"Email Notification"),t.qZA())}function q(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"td",26)(1,"mat-slide-toggle",28),t.NdJ("change",function(n){t.CHM(e);const r=t.oxw();return t.KtG(r.onEmailNotificationChecked(n))}),t._uU(2," Off "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("color",e.color)}}function $(i,a){1&i&&t._UZ(0,"tr",29)}function H(i,a){1&i&&t._UZ(0,"tr",30)}function B(i,a){1&i&&(t.TgZ(0,"div")(1,"mat-card",31),t._uU(2," No users found "),t.qZA()())}let G=(()=>{class i{constructor(e,o,n,r){this.alertpopupService=e,this.organizationService=o,this.dialogref=n,this.data=r,this.selectedOrganizationId="",this.organizationUsersData=[],this.displayedColumns=["select","Name","Email","Email Notification"],this.dataSource=new c.by(this.organizationUsersData),this.tableRowSelection=new I.Ov(!0,[]),this.userIdsArray=[],this.color="accent",this.isEmailNotificationActive=!1,this.disabled=!1,this.selectedOrganizationId=r}ngOnInit(){this.getUsersOrgnationById()}getUsersOrgnationById(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:1e3,pageSize:0,sortField:"",sortOrder:0,type:"",organization:"",organizationId:this.selectedOrganizationId,userId:"",userSearch:""}).subscribe(o=>{this.organizationName=o.organizations[0].organizations[0].organization,this.organizationUsersData=o.organizations[0].organizations[0].users,console.log(this.organizationUsersData),this.dataSource=new c.by(this.organizationUsersData)})}isAllSelected(){return this.tableRowSelection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.tableRowSelection.clear():this.tableRowSelection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.tableRowSelection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}userSearch(e){console.log(e.target.value),this.organizationService.getOrganizationsSearchCriteria({pageNumber:1e3,pageSize:0,sortField:"",sortOrder:0,type:"",organization:"",organizationId:this.selectedOrganizationId,userId:"",userSearch:e.target.value}).subscribe(n=>{this.organizationName=n.organizations[0].organizations[0].organization,this.organizationUsersData=n.organizations[0].organizations[0].users})}selectedUsers(){console.log(this.tableRowSelection.selected),this.tableRowSelection.selected.map(o=>{this.userIdsArray.push(o._id),console.log(this.userIdsArray)}),this.organizationService.removeUsersfromOrganization({userIds:this.userIdsArray,organizationId:this.selectedOrganizationId}).subscribe(o=>{this.alertpopupService.open({message:o.message,action:"ok"}),this.getUsersOrgnationById()},o=>{this.alertpopupService.open({message:"Faild to remove users from Organization! Please try again ",action:"ok"})})}onEmailNotificationChecked(e){console.log(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(C.z),t.Y36(U.M),t.Y36(d.so),t.Y36(d.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-remove-user-pop-up"]],decls:38,vars:9,consts:[[1,"d-flex","justify-content-between"],[1,"user"],["mat-button","","color","warn","mat-dialog-close","true",3,"mat-dialog-close"],[1,"d-flex","justify-content-end"],["appearance","outline"],["matInput","","placeholder","Enter User Name","input","","type","text",3,"keyup.enter"],["matSuffix",""],[1,"row"],[1,"col-12"],[4,"ngFor","ngForOf"],["mat-dialog-content",""],["mat-table","",2,"padding-right","10px","width","100%",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Name"],["matColumnDef","Email"],["matColumnDef","Email Notification"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"d-flex","btn","justify-content-end"],["mat-raised-button","","mat-dialog-close","true",3,"mat-dialog-close"],["mat-raised-button","","color","primary","mat-dialog-close","true",3,"mat-dialog-close","click"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],[3,"color","change"],["mat-header-row",""],["mat-row",""],[1,"noUserFoundCard"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card-title",0)(1,"h1",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t._uU(4,"x"),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"div",3)(7,"mat-form-field",4)(8,"input",5),t.NdJ("keyup.enter",function(r){return o.userSearch(r)}),t.qZA(),t.TgZ(9,"mat-icon",6),t._uU(10,"search"),t.qZA()()(),t.TgZ(11,"div",7)(12,"div",8)(13,"mat-chip-list"),t.YNc(14,D,2,1,"mat-chip",9),t.qZA(),t.TgZ(15,"div",10)(16,"table",11),t.ynx(17,12),t.YNc(18,k,2,3,"th",13),t.YNc(19,E,2,2,"td",14),t.BQk(),t.ynx(20,15),t.YNc(21,F,2,0,"th",13),t.YNc(22,Y,2,1,"td",14),t.BQk(),t.ynx(23,16),t.YNc(24,M,2,0,"th",13),t.YNc(25,J,2,1,"td",14),t.BQk(),t.ynx(26,17),t.YNc(27,Q,2,0,"th",13),t.YNc(28,q,3,1,"td",14),t.BQk(),t.YNc(29,$,1,0,"tr",18),t.YNc(30,H,1,0,"tr",19),t.qZA(),t.YNc(31,B,3,0,"div",20),t.qZA(),t.TgZ(32,"mat-card-actions")(33,"div",21)(34,"button",22),t._uU(35,"Cancel"),t.qZA(),t.TgZ(36,"button",23),t.NdJ("click",function(){return o.selectedUsers()}),t._uU(37," Remove "),t.qZA()()()()()()),2&e&&(t.xp6(2),t.hij("Remove User > ",o.organizationName,""),t.xp6(1),t.Q6J("mat-dialog-close",!1),t.xp6(11),t.Q6J("ngForOf",o.tableRowSelection.selected),t.xp6(2),t.Q6J("dataSource",o.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===(null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0))},dependencies:[g.sg,g.O5,N.lW,u.a8,u.dn,u.n5,u.hq,P.oG,S.qn,S.HS,d.ZT,d.xY,R.Hw,A.KE,A.R9,L.Nt,w.Rr,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk],styles:[".noUserFoundCard[_ngcontent-%COMP%]{text-align:center;color:#ec5757}"]}),i})(),K=(()=>{class i{constructor(e){this.matDialog=e}removeUserPopUp(e){return this.matDialog.open(G,{disableClose:!0,minWidth:"800px",data:e})}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(d.uw))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var j=s(9642),V=s(9690),h=s(3848);function W(i,a){1&i&&t._uU(0," Active ")}function X(i,a){1&i&&t._uU(0," Ministry/Department ")}function tt(i,a){1&i&&t._uU(0," Association ")}function et(i,a){1&i&&t._uU(0," Disabled ")}function it(i,a){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card",10),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.createOrganization())}),t.TgZ(1,"mat-card-content")(2,"div",11)(3,"font"),t._uU(4,"+"),t.qZA()(),t.TgZ(5,"h4",12),t._uU(6,"Create Organization"),t.qZA()()()}}function ot(i,a){1&i&&(t.TgZ(0,"mat-card")(1,"h1"),t._uU(2,"No Organizations Assigned!!"),t.qZA()())}function nt(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.disableAssociation(n._id,n.organization))}),t._uU(2," Disable "),t.qZA(),t.BQk()}}function at(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.removeUser(n._id,n.organization))}),t._uU(2," Delete "),t.qZA(),t.BQk()}}function rt(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openAddUserPopup(n._id))}),t._uU(2," Add User "),t.qZA(),t.TgZ(3,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.updateOrganization(n._id))}),t._uU(4," Edit "),t.qZA(),t.TgZ(5,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openRemoveUserPopup(n._id))}),t._uU(6," Remove User "),t.qZA(),t.YNc(7,nt,3,0,"ng-container",8),t.YNc(8,at,3,0,"ng-container",8),t.BQk()}if(2&i){const e=t.oxw().$implicit;t.xp6(7),t.Q6J("ngIf",(null==e.users?null:e.users.length)>=1),t.xp6(1),t.Q6J("ngIf",0==(null==e.users?null:e.users.length))}}function st(i,a){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.removeUser(n._id,n.organization))}),t._uU(2," Delete User "),t.qZA(),t.TgZ(3,"span",19),t.NdJ("click",function(){t.CHM(e);const n=t.oxw().$implicit,r=t.oxw();return t.KtG(r.enableAssociation(n._id,n.organization))}),t._uU(4," Enable "),t.qZA(),t.BQk()}}function ct(i,a){if(1&i&&(t.TgZ(0,"div",6)(1,"mat-card")(2,"mat-card-content")(3,"h3")(4,"span",13),t._uU(5),t.ALo(6,"titlecase"),t.qZA(),t.TgZ(7,"span"),t._uU(8),t.ALo(9,"uppercase"),t.qZA()(),t.TgZ(10,"div",14)(11,"div",15)(12,"i",16),t._uU(13,"corporate_fare"),t.qZA()(),t.TgZ(14,"div")(15,"p"),t._uU(16),t.qZA(),t.TgZ(17,"p"),t._uU(18,"0 Activity(s)"),t.qZA(),t.TgZ(19,"p"),t._uU(20,"0 Hour(s) Spent"),t.qZA(),t.TgZ(21,"p"),t._uU(22,"0 Mb Storage"),t.qZA()()(),t.TgZ(23,"div",17)(24,"div",18),t.YNc(25,rt,9,2,"ng-container",8),t.YNc(26,st,5,0,"ng-container",8),t.qZA()()()()()),2&i){const e=a.$implicit,o=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,5,e.organization)),t.xp6(3),t.hij(" (",t.lcZ(9,7,e.shortName),")"),t.xp6(8),t.hij(" ",e.users.length," User(s)"),t.xp6(9),t.Q6J("ngIf",1==o.organizationList[0].isActive),t.xp6(1),t.Q6J("ngIf",0==o.organizationList[0].isActive)}}const lt=[{path:"",component:(()=>{class i{constructor(e,o,n,r,l,p,mt){this.organizationService=e,this.masterDataService=o,this.addUserPopUpService=n,this.alertpopupService=r,this.removeUserPopUpService=l,this.confirmationDialogService=p,this.storageService=mt,this.filters=m.t,this.organizationListPayload={pageNumber:0,pageSize:50,sortField:"",sortOrder:0,type:"",organization:"",organizationId:"",isActive:!0,userId:"",userSearch:""},this.isUser=!1}ngOnInit(){this.getAllOrganizationsSearchCriteria(this.organizationListPayload),this.getOrganizationTypes()}getOrganizationTypes(){this.masterDataService.getOrganizationTypes().subscribe(e=>{this.organizationTypes=e.data,console.log(this.organizationTypes)})}getAllOrganizationsSearchCriteria(e){this.storageService.getDataFromLocalStorage(z.I.ROLE)===b.G.User&&(this.isUser=!0,e={...e,userId:this.storageService.getDataFromLocalStorage(z.I.USER_ID)}),this.organizationService.getOrganizationsSearchCriteria(e).subscribe(o=>{this.organizationList=o.organizations[0].organizations.reverse()})}applyOrganizationFilters(e){let o=this.organizationListPayload;Number(e.tab.textLabel)===m.t.MINISTRIES?o={...o,isActive:!0,type:this.organizationTypes[m.t.MINISTRIES]._id}:Number(e.tab.textLabel)===m.t.IS_ACTIVE?o={...o,isActive:!0}:Number(e.tab.textLabel)===m.t.ASSOCIATION?o={...o,isActive:!0,type:this.organizationTypes[m.t.ASSOCIATION]._id}:Number(e.tab.textLabel)===m.t.INACTIVE&&(o={...o,isActive:!1}),this.getAllOrganizationsSearchCriteria(o)}updateOrganization(e){this.organizationService.updateOrganizatioPopup(e).afterClosed().subscribe(o=>{o&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}createOrganization(){this.organizationService.openCreateOrganizatioPopup().afterClosed().subscribe(e=>{e&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}openAddUserPopup(e){this.addUserPopUpService.openAddUser(e).afterClosed().subscribe(o=>{o&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}openRemoveUserPopup(e){this.removeUserPopUpService.removeUserPopUp(e).afterClosed().subscribe(o=>{o&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload),console.log(o)})}disableAssociation(e,o){this.confirmationDialogService.open({message:`Are you Sure to Disable ${o}`}).afterClosed().subscribe(n=>{n&&this.organizationService.getorganizationById(e).subscribe(r=>{const l={...r.organization,isActive:!1};this.organizationService.updateOrganization(e,l).subscribe(p=>{this.alertpopupService.open({message:p.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},p=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}enableAssociation(e,o){this.confirmationDialogService.open({message:`Are you Sure to Enable ${o} `}).afterClosed().subscribe(n=>{n&&this.organizationService.getorganizationById(e).subscribe(r=>{const l={...r.organization,isActive:!0};this.organizationService.updateOrganization(e,l).subscribe(p=>{this.alertpopupService.open({message:p.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},p=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}removeUser(e,o){this.confirmationDialogService.open({message:`Are you Sure to Delete ${o}`}).afterClosed().subscribe(n=>{n&&this.confirmationDialogService.open({message:`All the Activities, Files associated with ${o} will be deleted permanently. `}).afterClosed().subscribe(r=>{r&&this.organizationService.deleteUser(e).subscribe(l=>{this.alertpopupService.open({message:l.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},l=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(U.M),t.Y36(x.D),t.Y36(y),t.Y36(C.z),t.Y36(K),t.Y36(j.O),t.Y36(V.V))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-organization-list"]],decls:16,vars:7,consts:[[1,"page-wrapper"],[1,"organization-cards",3,"selectedTabChange"],[3,"label"],["mat-tab-label",""],[1,"in-page-wrapper"],[1,"row"],[1,"col-md-4","org-card"],["class","plus",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-md-4 org-card",4,"ngFor","ngForOf"],[1,"plus",3,"click"],[1,"add-icon"],[1,"mt-2"],[1,"organization-title"],[1,"org_box"],[1,"org_icon"],[1,"material-icons"],[1,"action-buttons"],[1,"row","justify-content-between"],[1,"col-6",3,"click"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"mat-tab-group",1),t.NdJ("selectedTabChange",function(r){return o.applyOrganizationFilters(r)}),t.TgZ(2,"mat-tab",2),t.YNc(3,W,1,0,"ng-template",3),t.qZA(),t.TgZ(4,"mat-tab",2),t.YNc(5,X,1,0,"ng-template",3),t.qZA(),t.TgZ(6,"mat-tab",2),t.YNc(7,tt,1,0,"ng-template",3),t.qZA(),t.TgZ(8,"mat-tab",2),t.YNc(9,et,1,0,"ng-template",3),t.qZA()(),t.TgZ(10,"section",4)(11,"div",5)(12,"div",6),t.YNc(13,it,7,0,"mat-card",7),t.YNc(14,ot,3,0,"mat-card",8),t.qZA(),t.YNc(15,ct,27,9,"div",9),t.qZA()()()),2&e&&(t.xp6(2),t.s9C("label",o.filters.IS_ACTIVE),t.xp6(2),t.s9C("label",o.filters.MINISTRIES),t.xp6(2),t.s9C("label",o.filters.ASSOCIATION),t.xp6(2),t.s9C("label",o.filters.INACTIVE),t.xp6(5),t.Q6J("ngIf",!o.isUser),t.xp6(1),t.Q6J("ngIf",0===(null==o.organizationList?null:o.organizationList.length)&&o.isUser),t.xp6(1),t.Q6J("ngForOf",o.organizationList))},dependencies:[g.sg,g.O5,u.a8,u.dn,h.SP,h.uD,h.uX,g.gd,g.rS],styles:[".add-icon[_ngcontent-%COMP%]{height:100px;width:100px;margin:auto;border:.25px solid #f44336;border-radius:50%;display:grid;place-items:center}font[_ngcontent-%COMP%]{font-size:80px;color:#f44336}.plus[_ngcontent-%COMP%]{display:grid;place-items:center;cursor:pointer}.organization-title[_ngcontent-%COMP%]{font-weight:900}.togle-button[_ngcontent-%COMP%]{width:200px!important;min-width:unset!important}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#556ee7;color:#fff!important}"]}),i})()}];let gt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[v.Bz.forChild(lt),v.Bz]}),i})(),pt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[g.ez,T.m,f.u5,f.UX,gt]}),i})()},8202:(O,_,s)=>{s.d(_,{t:()=>g});const g={IS_ACTIVE:2,MINISTRIES:0,ASSOCIATION:1,INACTIVE:3,MY_PROFILE:4,CHANGE_PASSWORD:5,NOTIFICATIONS:6,EMAIL_REPORTS:7}}}]);
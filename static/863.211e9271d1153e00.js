"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[863],{5863:(b,u,a)=>{a.r(u),a.d(u,{DocumentsModule:()=>_});var p=a(6895),r=a(3060),d=a(8739),s=a(3626),h=a(5150),g=a(7335),t=a(4650),f=a(3248);let v=(()=>{class n{constructor(e){this.httpDataService=e}postActivityAttachments(e){return this.httpDataService.post("activity/getAttchements",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(f.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var D=a(5641),y=a(4889),C=a(9732),A=a(2653);function S(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Activity"),t.qZA())}function z(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e?null:e.uniqIdentity," ")}}function T(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," FileName "),t.qZA())}function Z(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"td",13),t.NdJ("click",function(){const c=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.downloadDocumement(c))}),t._uU(1),t.qZA()}if(2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.name," ")}}function w(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Size "),t.qZA())}function N(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.size," ")}}function x(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Organisation "),t.qZA())}function O(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.organization," ")}}function U(n,o){1&n&&t._UZ(0,"tr",14)}function Y(n,o){1&n&&t._UZ(0,"tr",15)}const P=[{path:"",component:(()=>{class n{constructor(e,i,l,c,m){this.documentsService=e,this.activityService=i,this.selectedOrganizationService=l,this.userDetailsService=c,this.alertpopupService=m,this.totalUserCount=0,this.paginationProps=h.k,this.attachmentsDetails=[],this.documentsPayload={pageNumber:0,pageSize:10,sortField:"",groupBy:0,fileNameSearchText:"",organizations:[]},this.displayedColumns=["Activity","FileName","Size","Organisation"],this.dataSource=new s.by(this.attachmentsDetails)}ngOnInit(){this.userDetailsService.getUserDetails().subscribe(e=>{e.roles[0]===g.G.User&&(this.documentsPayload.organizations=e.organization),this.postActivityAttachments()}),this.selectedOrganizationService.getSelectedOrganization().subscribe(e=>{this.documentsPayload.organizations=e,this.postActivityAttachments()})}postActivityAttachments(){this.documentsService.postActivityAttachments(this.documentsPayload).subscribe(e=>{this.attachmentsDetails=e?.data[0]?.attachments,this.totalDocumentCount=e?.data[0]?.count[0]?.count,this.dataSource=new s.by(this.attachmentsDetails)})}onChangedPageSize(e){this.documentsPayload.pageNumber=this.paginator?.pageIndex,this.documentsPayload.pageSize=this.paginator?.pageSize,this.postActivityAttachments()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}downloadDocumement(e){const i={fileName:e.nestedAttchments.name,path:`${e._id}`};e.nestedAttchments.activityLogId&&(i.path=`${e._id}/${e.nestedAttchments.activityLogId}`),this.activityService.dowloadAttachments(i).subscribe(l=>{const c=document.createElement("a");c.href=window.URL.createObjectURL(l),c.download=e.nestedAttchments.name,c.click(),window.URL.revokeObjectURL(c.href),this.alertpopupService.open({message:"Attachment downloaded successfully",action:"Ok"})},l=>{this.alertpopupService.open({message:"Attachment Not Found",action:"Ok"})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v),t.Y36(D.M),t.Y36(y.s),t.Y36(C.H),t.Y36(A.z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-documents"]],viewQuery:function(e,i){if(1&e&&t.Gf(d.NW,5),2&e){let l;t.iGM(l=t.CRH())&&(i.paginator=l.first)}},decls:16,vars:6,consts:[["mat-table","",1,"mat-elevation-z8","documentTable",3,"dataSource"],["matColumnDef","Activity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","FileName"],["mat-cell","","class","attachment-download",3,"click",4,"matCellDef"],["matColumnDef","Size"],["matColumnDef","Organisation"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize","pageSizeOptions","page"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"attachment-download",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,i){1&e&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,S,2,0,"th",2),t.YNc(3,z,2,1,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,T,2,0,"th",2),t.YNc(6,Z,2,1,"td",5),t.BQk(),t.ynx(7,6),t.YNc(8,w,2,0,"th",2),t.YNc(9,N,2,1,"td",3),t.BQk(),t.ynx(10,7),t.YNc(11,x,2,0,"th",2),t.YNc(12,O,2,1,"td",3),t.BQk(),t.YNc(13,U,1,0,"tr",8),t.YNc(14,Y,1,0,"tr",9),t.qZA(),t.TgZ(15,"mat-paginator",10),t.NdJ("page",function(c){return i.onChangedPageSize(c)}),t.qZA()),2&e&&(t.Q6J("dataSource",i.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",i.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("length",i.totalDocumentCount)("pageSize",i.paginationProps.pageSize)("pageSizeOptions",i.paginationProps.pageSizeOptions))},dependencies:[d.NW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk],styles:[".documentTable[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{text-align:left;font-size:1rem;background:#f0f0f0}.attachment-download[_ngcontent-%COMP%]{cursor:pointer;color:#00f;text-decoration:underline}"]}),n})()}];let M=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[r.Bz.forChild(P),r.Bz]}),n})();var R=a(1252);let _=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,M,R.m]}),n})()}}]);
"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[411],{9411:(b,_,s)=>{s.r(_),s.d(_,{OrganizationModule:()=>de});var p=s(6895),A=s(8210),f=s(4006),v=s(3060),d=s(8202),z=s(4025),O=s(7335),e=s(4650),U=s(7199),x=s(3081),Z=s(3293),m=s(5938);let y=(()=>{class i{constructor(t){this.matDialog=t}openAddUser(t){return this.matDialog.open(Z.H,{disableClose:!0,minWidth:"1200px",data:t})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.uw))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var C=s(2653),I=s(5017),c=s(3626),N=s(4859),u=s(3546),R=s(6709),S=s(7331),P=s(7392),T=s(9549),w=s(4144),L=s(455);function F(i,a){if(1&i&&(e.TgZ(0,"mat-chip"),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Oqu(t.Name)}}function D(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"th",28)(1,"mat-checkbox",29),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw();return e.KtG(n?r.toggleAllRows():null)}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("checked",t.tableRowSelection.hasValue()&&t.isAllSelected())("indeterminate",t.tableRowSelection.hasValue()&&!t.isAllSelected())("aria-label",t.checkboxLabel())}}function k(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"td",30)(1,"mat-checkbox",31),e.NdJ("click",function(n){return n.stopPropagation()})("change",function(n){const l=e.CHM(t).$implicit,g=e.oxw();return e.KtG(n?g.tableRowSelection.toggle(l):null)}),e.qZA()()}if(2&i){const t=a.$implicit,o=e.oxw();e.xp6(1),e.Q6J("checked",o.tableRowSelection.isSelected(t))("aria-label",o.checkboxLabel(t))}}function E(i,a){1&i&&(e.TgZ(0,"th",28),e._uU(1,"Name"),e.qZA())}function Y(i,a){if(1&i&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Oqu(null==t?null:t.Name)}}function J(i,a){1&i&&(e.TgZ(0,"th",28),e._uU(1,"Email"),e.qZA())}function M(i,a){if(1&i&&(e.TgZ(0,"td",30),e._uU(1),e.qZA()),2&i){const t=a.$implicit;e.xp6(1),e.Oqu(t.email)}}function Q(i,a){1&i&&(e.TgZ(0,"th",28),e._uU(1,"Email Notification"),e.qZA())}function q(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"td",30)(1,"mat-slide-toggle",32),e.NdJ("change",function(n){e.CHM(t);const r=e.oxw();return e.KtG(r.onEmailNotificationChecked(n))}),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("color",t.color)}}function $(i,a){1&i&&e._UZ(0,"tr",33)}function H(i,a){1&i&&e._UZ(0,"tr",34)}function B(i,a){1&i&&(e.TgZ(0,"div")(1,"mat-card",35),e._uU(2," No users found "),e.qZA()())}let G=(()=>{class i{constructor(t,o,n,r){this.alertpopupService=t,this.organizationService=o,this.dialogref=n,this.data=r,this.selectedOrganizationId="",this.organizationUsersData=[],this.displayedColumns=["select","Name","Email","Email Notification"],this.dataSource=new c.by(this.organizationUsersData),this.tableRowSelection=new I.Ov(!0,[]),this.userIdsArray=[],this.color="accent",this.isEmailNotificationActive=!1,this.disabled=!1,this.selectedOrganizationId=r}ngOnInit(){this.getUsersOrgnationById()}getUsersOrgnationById(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:1e3,pageSize:0,sortField:"",sortOrder:0,type:"",organization:"",organizationId:this.selectedOrganizationId,userId:"",userSearch:""}).subscribe(o=>{this.organizationName=o.organizations[0].organizations[0].organization,this.organizationUsersData=o.organizations[0].organizations[0].users,console.log(this.organizationUsersData),this.dataSource=new c.by(this.organizationUsersData)})}isAllSelected(){return this.tableRowSelection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.tableRowSelection.clear():this.tableRowSelection.select(...this.dataSource.data)}checkboxLabel(t){return t?`${this.tableRowSelection.isSelected(t)?"deselect":"select"} row ${t.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}userSearch(t){console.log(t.target.value),this.organizationService.getOrganizationsSearchCriteria({pageNumber:1e3,pageSize:0,sortField:"",sortOrder:0,type:"",organization:"",organizationId:this.selectedOrganizationId,userId:"",userSearch:t.target.value}).subscribe(n=>{this.organizationName=n.organizations[0].organizations[0].organization,this.organizationUsersData=n.organizations[0].organizations[0].users})}selectedUsers(){console.log(this.tableRowSelection.selected),this.tableRowSelection.selected.map(o=>{this.userIdsArray.push(o._id),console.log(this.userIdsArray)}),this.organizationService.removeUsersfromOrganization({userIds:this.userIdsArray,organizationId:this.selectedOrganizationId}).subscribe(o=>{this.alertpopupService.open({message:o.message,action:"ok"})},o=>{this.alertpopupService.open({message:"Faild to remove users from Organization! Please try again ",action:"ok"})})}onEmailNotificationChecked(t){console.log(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(C.z),e.Y36(U.M),e.Y36(m.so),e.Y36(m.WI))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-remove-user-pop-up"]],decls:46,vars:9,consts:[[1,"elog-dialog"],[1,"user"],["mat-dialog-close","true",1,"close",3,"mat-dialog-close"],[1,"row"],[1,"col-md-8"],[1,"selected-chips"],[4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"d-flex","justify-content-end"],["appearance","outline"],["matInput","","placeholder","Enter User Name","input","","type","text",3,"keyup.enter"],["matSuffix",""],[1,"elog-dialog-body","p-0"],[1,"col-12"],["mat-dialog-content",""],["mat-table","",2,"padding-right","10px","width","100%",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Name"],["matColumnDef","Email"],["matColumnDef","Email Notification"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"d-flex","btn","justify-content-end"],["mat-raised-button","","mat-dialog-close","true",3,"mat-dialog-close"],["mat-raised-button","","color","primary","mat-dialog-close","true",3,"mat-dialog-close","click"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],[3,"color","change"],["mat-header-row",""],["mat-row",""],[1,"noUserFoundCard"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"h1",1)(2,"span"),e._uU(3,"Remove User "),e.TgZ(4,"small"),e._uU(5,">"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"button",2),e._uU(8,"x"),e.qZA()(),e.TgZ(9,"div",3)(10,"div",4)(11,"div",5)(12,"mat-chip-list"),e.YNc(13,F,2,1,"mat-chip",6),e.qZA()()(),e.TgZ(14,"div",7)(15,"div",8)(16,"mat-form-field",9)(17,"input",10),e.NdJ("keyup.enter",function(r){return o.userSearch(r)}),e.qZA(),e.TgZ(18,"mat-icon",11),e._uU(19,"search"),e.qZA()()()()(),e.TgZ(20,"mat-card-content",12)(21,"div",3)(22,"div",13)(23,"div",14)(24,"table",15),e.ynx(25,16),e.YNc(26,D,2,3,"th",17),e.YNc(27,k,2,2,"td",18),e.BQk(),e.ynx(28,19),e.YNc(29,E,2,0,"th",17),e.YNc(30,Y,2,1,"td",18),e.BQk(),e.ynx(31,20),e.YNc(32,J,2,0,"th",17),e.YNc(33,M,2,1,"td",18),e.BQk(),e.ynx(34,21),e.YNc(35,Q,2,0,"th",17),e.YNc(36,q,2,1,"td",18),e.BQk(),e.YNc(37,$,1,0,"tr",22),e.YNc(38,H,1,0,"tr",23),e.qZA(),e.YNc(39,B,3,0,"div",24),e.qZA(),e.TgZ(40,"mat-card-actions")(41,"div",25)(42,"button",26),e._uU(43,"Cancel"),e.qZA(),e.TgZ(44,"button",27),e.NdJ("click",function(){return o.selectedUsers()}),e._uU(45," Remove "),e.qZA()()()()()()()),2&t&&(e.xp6(6),e.hij(" ",o.organizationName," "),e.xp6(1),e.Q6J("mat-dialog-close",!1),e.xp6(6),e.Q6J("ngForOf",o.tableRowSelection.selected),e.xp6(11),e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns),e.xp6(1),e.Q6J("ngIf",0===(null==o.dataSource.filteredData?null:o.dataSource.filteredData.length)),e.xp6(3),e.Q6J("mat-dialog-close",!1),e.xp6(2),e.Q6J("mat-dialog-close",!0))},dependencies:[p.sg,p.O5,N.lW,u.a8,u.dn,u.hq,R.oG,S.qn,S.HS,m.ZT,m.xY,P.Hw,T.KE,T.R9,w.Nt,L.Rr,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk],styles:[".noUserFoundCard[_ngcontent-%COMP%]{text-align:center;color:#ec5757}"]}),i})(),K=(()=>{class i{constructor(t){this.matDialog=t}removeUserPopUp(t){return this.matDialog.open(G,{disableClose:!0,minWidth:"800px",data:t})}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(m.uw))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var V=s(9642),j=s(9690),h=s(3848);function W(i,a){1&i&&e._uU(0," Active ")}function X(i,a){1&i&&e._uU(0," Ministry/Department ")}function ee(i,a){1&i&&e._uU(0," Association ")}function te(i,a){1&i&&e._uU(0," Disabled ")}function ie(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"mat-card",10),e.NdJ("click",function(){e.CHM(t);const n=e.oxw();return e.KtG(n.createOrganization())}),e.TgZ(1,"mat-card-content")(2,"div",11)(3,"font"),e._uU(4,"+"),e.qZA()(),e.TgZ(5,"h4",12),e._uU(6,"Create Organization"),e.qZA()()()}}function oe(i,a){1&i&&(e.TgZ(0,"mat-card")(1,"h1"),e._uU(2,"No Organizations Assigned!!"),e.qZA()())}function ne(i,a){if(1&i){const t=e.EpF();e.TgZ(0,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,r=e.oxw();return e.KtG(r.openRemoveUserPopup(n._id))}),e._uU(1," Remove User "),e.qZA()}}function ae(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,r=e.oxw();return e.KtG(r.disableAssociation(n._id,n.organization))}),e._uU(2," Disable "),e.qZA(),e.BQk()}}function re(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw(2).$implicit,r=e.oxw();return e.KtG(r.removeUser(n._id,n.organization))}),e._uU(2," Delete "),e.qZA(),e.BQk()}}function se(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.openAddUserPopup(n._id))}),e._uU(2," Add User "),e.qZA(),e.TgZ(3,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.updateOrganization(n._id))}),e._uU(4," Edit "),e.qZA(),e.YNc(5,ne,2,0,"span",20),e.YNc(6,ae,3,0,"ng-container",8),e.YNc(7,re,3,0,"ng-container",8),e.BQk()}if(2&i){const t=e.oxw().$implicit;e.xp6(5),e.Q6J("ngIf",(null==t.users?null:t.users.length)>0),e.xp6(1),e.Q6J("ngIf",(null==t.users?null:t.users.length)>=1),e.xp6(1),e.Q6J("ngIf",0==(null==t.users?null:t.users.length))}}function ce(i,a){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.removeUser(n._id,n.organization))}),e._uU(2," Delete User "),e.qZA(),e.TgZ(3,"span",19),e.NdJ("click",function(){e.CHM(t);const n=e.oxw().$implicit,r=e.oxw();return e.KtG(r.enableAssociation(n._id,n.organization))}),e._uU(4," Enable "),e.qZA(),e.BQk()}}function le(i,a){if(1&i&&(e.TgZ(0,"div",6)(1,"mat-card")(2,"mat-card-content")(3,"h3")(4,"span",13),e._uU(5),e.ALo(6,"titlecase"),e.qZA(),e.TgZ(7,"span"),e._uU(8),e.ALo(9,"uppercase"),e.qZA()(),e.TgZ(10,"div",14)(11,"div",15)(12,"i",16),e._uU(13,"corporate_fare"),e.qZA()(),e.TgZ(14,"div")(15,"p"),e._uU(16),e.qZA(),e.TgZ(17,"p"),e._uU(18,"0 Activity(s)"),e.qZA(),e.TgZ(19,"p"),e._uU(20,"0 Hour(s) Spent"),e.qZA(),e.TgZ(21,"p"),e._uU(22,"0 Mb Storage"),e.qZA()()(),e.TgZ(23,"div",17)(24,"div",18),e.YNc(25,se,8,3,"ng-container",8),e.YNc(26,ce,5,0,"ng-container",8),e.qZA()()()()()),2&i){const t=a.$implicit,o=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,5,t.organization)),e.xp6(3),e.hij(" (",e.lcZ(9,7,t.shortName),")"),e.xp6(8),e.hij(" ",t.users.length," User(s)"),e.xp6(9),e.Q6J("ngIf",1==o.organizationList[0].isActive),e.xp6(1),e.Q6J("ngIf",0==o.organizationList[0].isActive)}}const pe=[{path:"",component:(()=>{class i{constructor(t,o,n,r,l,g,me){this.organizationService=t,this.masterDataService=o,this.addUserPopUpService=n,this.alertpopupService=r,this.removeUserPopUpService=l,this.confirmationDialogService=g,this.storageService=me,this.filters=d.t,this.organizationListPayload={pageNumber:0,pageSize:50,sortField:"",sortOrder:0,type:"",organization:"",organizationId:"",isActive:!0,userId:"",userSearch:""},this.isUser=!1,this.selectedTab={tab:{textLabel:d.t.IS_ACTIVE}}}ngOnInit(){this.getAllOrganizationsSearchCriteria(this.organizationListPayload),this.getOrganizationTypes()}getOrganizationTypes(){this.masterDataService.getOrganizationTypes().subscribe(t=>{this.organizationTypes=t.data,console.log(this.organizationTypes)})}getAllOrganizationsSearchCriteria(t){this.storageService.getDataFromLocalStorage(z.I.ROLE)===O.G.User&&(this.isUser=!0,t={...t,userId:this.storageService.getDataFromLocalStorage(z.I.USER_ID)}),this.organizationService.getOrganizationsSearchCriteria(t).subscribe(o=>{this.organizationList=o.organizations[0].organizations.reverse()})}applyOrganizationFilters(t){this.selectedTab=t;let o=this.organizationListPayload;Number(t.tab.textLabel)===d.t.MINISTRIES?o={...o,isActive:!0,type:this.organizationTypes[d.t.MINISTRIES]._id}:Number(t.tab.textLabel)===d.t.IS_ACTIVE?o={...o,isActive:!0}:Number(t.tab.textLabel)===d.t.ASSOCIATION?o={...o,isActive:!0,type:this.organizationTypes[d.t.ASSOCIATION]._id}:Number(t.tab.textLabel)===d.t.INACTIVE&&(o={...o,isActive:!1}),this.getAllOrganizationsSearchCriteria(o)}updateOrganization(t){this.organizationService.updateOrganizatioPopup(t).afterClosed().subscribe(o=>{o&&this.applyOrganizationFilters(this.selectedTab)})}createOrganization(){this.organizationService.openCreateOrganizatioPopup().afterClosed().subscribe(t=>{t&&this.applyOrganizationFilters(this.selectedTab)})}openAddUserPopup(t){this.addUserPopUpService.openAddUser(t).afterClosed().subscribe(o=>{o&&this.applyOrganizationFilters(this.selectedTab)})}openRemoveUserPopup(t){this.removeUserPopUpService.removeUserPopUp(t).afterClosed().subscribe(o=>{o&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload),console.log(o)})}disableAssociation(t,o){this.confirmationDialogService.open({message:`Are you sure to Disable ${o}`}).afterClosed().subscribe(n=>{n&&this.organizationService.getorganizationById(t).subscribe(r=>{const l={...r.organization,isActive:!1};this.organizationService.updateOrganization(t,l).subscribe(g=>{this.alertpopupService.open({message:g.message,action:"ok"}),this.applyOrganizationFilters(this.selectedTab)},g=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}enableAssociation(t,o){this.confirmationDialogService.open({message:`Are you Sure to Enable ${o} `}).afterClosed().subscribe(n=>{n&&this.organizationService.getorganizationById(t).subscribe(r=>{const l={...r.organization,isActive:!0};this.organizationService.updateOrganization(t,l).subscribe(g=>{this.alertpopupService.open({message:g.message,action:"ok"}),this.applyOrganizationFilters(this.selectedTab)},g=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}removeUser(t,o){this.confirmationDialogService.open({message:`Are you Sure to Delete ${o}`}).afterClosed().subscribe(n=>{n&&this.confirmationDialogService.open({message:`All the Activities, Files associated with ${o} will be deleted permanently. `}).afterClosed().subscribe(r=>{r&&this.organizationService.deleteUser(t).subscribe(l=>{this.alertpopupService.open({message:l.message,action:"ok"}),this.applyOrganizationFilters(this.selectedTab)},l=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(U.M),e.Y36(x.D),e.Y36(y),e.Y36(C.z),e.Y36(K),e.Y36(V.O),e.Y36(j.V))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-organization-list"]],decls:16,vars:7,consts:[[1,"page-wrapper"],[1,"organization-cards",3,"selectedTabChange"],[3,"label"],["mat-tab-label",""],[1,"in-page-wrapper"],[1,"row"],[1,"col-md-4","org-card"],["class","plus",3,"click",4,"ngIf"],[4,"ngIf"],["class","col-md-4 org-card",4,"ngFor","ngForOf"],[1,"plus",3,"click"],[1,"add-icon"],[1,"mt-2"],[1,"organization-title"],[1,"org_box"],[1,"org_icon"],[1,"material-icons"],[1,"action-buttons"],[1,"row","justify-content-between"],[1,"col-6",3,"click"],["class","col-6",3,"click",4,"ngIf"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"mat-tab-group",1),e.NdJ("selectedTabChange",function(r){return o.applyOrganizationFilters(r)}),e.TgZ(2,"mat-tab",2),e.YNc(3,W,1,0,"ng-template",3),e.qZA(),e.TgZ(4,"mat-tab",2),e.YNc(5,X,1,0,"ng-template",3),e.qZA(),e.TgZ(6,"mat-tab",2),e.YNc(7,ee,1,0,"ng-template",3),e.qZA(),e.TgZ(8,"mat-tab",2),e.YNc(9,te,1,0,"ng-template",3),e.qZA()(),e.TgZ(10,"section",4)(11,"div",5)(12,"div",6),e.YNc(13,ie,7,0,"mat-card",7),e.YNc(14,oe,3,0,"mat-card",8),e.qZA(),e.YNc(15,le,27,9,"div",9),e.qZA()()()),2&t&&(e.xp6(2),e.s9C("label",o.filters.IS_ACTIVE),e.xp6(2),e.s9C("label",o.filters.MINISTRIES),e.xp6(2),e.s9C("label",o.filters.ASSOCIATION),e.xp6(2),e.s9C("label",o.filters.INACTIVE),e.xp6(5),e.Q6J("ngIf",!o.isUser),e.xp6(1),e.Q6J("ngIf",0===(null==o.organizationList?null:o.organizationList.length)&&o.isUser),e.xp6(1),e.Q6J("ngForOf",o.organizationList))},dependencies:[p.sg,p.O5,u.a8,u.dn,h.SP,h.uD,h.uX,p.gd,p.rS],styles:[".add-icon[_ngcontent-%COMP%]{height:100px;width:100px;margin:auto;border:.25px solid #f44336;border-radius:50%;display:grid;place-items:center}font[_ngcontent-%COMP%]{font-size:80px;color:#f44336}.plus[_ngcontent-%COMP%]{display:grid;place-items:center;cursor:pointer}.organization-title[_ngcontent-%COMP%]{font-weight:900}.togle-button[_ngcontent-%COMP%]{width:200px!important;min-width:unset!important}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#556ee7;color:#fff!important}"]}),i})()}];let ge=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[v.Bz.forChild(pe),v.Bz]}),i})(),de=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.ez,A.m,f.u5,f.UX,ge]}),i})()},8202:(b,_,s)=>{s.d(_,{t:()=>p});const p={IS_ACTIVE:2,MINISTRIES:1,ASSOCIATION:0,INACTIVE:3,MY_PROFILE:4,CHANGE_PASSWORD:5,NOTIFICATIONS:6,EMAIL_REPORTS:7}}}]);
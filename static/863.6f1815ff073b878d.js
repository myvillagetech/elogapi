"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[863],{5863:(M,l,i)=>{i.r(l),i.d(l,{DocumentsModule:()=>P});var d=i(6895),u=i(3060),r=i(8739),s=i(3626),h=i(5150),p=i(7335),t=i(4650),g=i(3248);let f=(()=>{class n{constructor(e){this.httpDataService=e}postActivityAttachments(e){return this.httpDataService.post("activity/getAttchements",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(g.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var D=i(5641),v=i(4889),C=i(9732);function y(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Activity"),t.qZA())}function A(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e?null:e.uniqIdentity," ")}}function S(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," FileName "),t.qZA())}function z(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"td",13),t.NdJ("click",function(){const c=t.CHM(e).$implicit,b=t.oxw();return t.KtG(b.downloadDocumement(c))}),t._uU(1),t.qZA()}if(2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.name," ")}}function T(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Size "),t.qZA())}function Z(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.size," ")}}function w(n,o){1&n&&(t.TgZ(0,"th",11),t._uU(1," Organisation "),t.qZA())}function N(n,o){if(1&n&&(t.TgZ(0,"td",12),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",null==e||null==e.nestedAttchments?null:e.nestedAttchments.organization," ")}}function x(n,o){1&n&&t._UZ(0,"tr",14)}function U(n,o){1&n&&t._UZ(0,"tr",15)}const _=[{path:"",component:(()=>{class n{constructor(e,a,m,c){this.documentsService=e,this.activityService=a,this.selectedOrganizationService=m,this.userDetailsService=c,this.totalUserCount=0,this.paginationProps=h.k,this.attachmentsDetails=[],this.documentsPayload={pageNumber:0,pageSize:10,sortField:"",groupBy:0,fileNameSearchText:"",organizations:[]},this.displayedColumns=["Activity","FileName","Size","Organisation"],this.dataSource=new s.by(this.attachmentsDetails)}ngOnInit(){this.userDetailsService.getUserDetails().subscribe(e=>{e.roles[0]===p.G.User&&(this.documentsPayload.organizations=e.organization),this.postActivityAttachments()}),this.selectedOrganizationService.getSelectedOrganization().subscribe(e=>{this.documentsPayload.organizations=e,this.postActivityAttachments()})}postActivityAttachments(){this.documentsService.postActivityAttachments(this.documentsPayload).subscribe(e=>{this.attachmentsDetails=e?.data[0]?.attachments,this.totalDocumentCount=e?.data[0]?.count[0]?.count,this.dataSource=new s.by(this.attachmentsDetails)})}onChangedPageSize(e){this.documentsPayload.pageNumber=this.paginator?.pageIndex,this.documentsPayload.pageSize=this.paginator?.pageSize,this.postActivityAttachments()}ngAfterViewInit(){this.dataSource.paginator=this.paginator}downloadDocumement(e){const a={fileName:e.nestedAttchments.name,path:`${e._id}`};e.nestedAttchments.activityLogId&&(a.path=`${e._id}/${e.nestedAttchments.activityLogId}`),this.activityService.dowloadAttachments(a).subscribe(m=>{const c=document.createElement("a");c.href=window.URL.createObjectURL(m),c.download=e.nestedAttchments.name,c.click(),window.URL.revokeObjectURL(c.href)},m=>{})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f),t.Y36(D.M),t.Y36(v.s),t.Y36(C.H))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-documents"]],viewQuery:function(e,a){if(1&e&&t.Gf(r.NW,5),2&e){let m;t.iGM(m=t.CRH())&&(a.paginator=m.first)}},decls:16,vars:6,consts:[["mat-table","",1,"mat-elevation-z8","documentTable",3,"dataSource"],["matColumnDef","Activity"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","FileName"],["mat-cell","","class","attachment-download",3,"click",4,"matCellDef"],["matColumnDef","Size"],["matColumnDef","Organisation"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of GitHub search results",3,"length","pageSize","pageSizeOptions","page"],["mat-header-cell",""],["mat-cell",""],["mat-cell","",1,"attachment-download",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(e,a){1&e&&(t.TgZ(0,"table",0),t.ynx(1,1),t.YNc(2,y,2,0,"th",2),t.YNc(3,A,2,1,"td",3),t.BQk(),t.ynx(4,4),t.YNc(5,S,2,0,"th",2),t.YNc(6,z,2,1,"td",5),t.BQk(),t.ynx(7,6),t.YNc(8,T,2,0,"th",2),t.YNc(9,Z,2,1,"td",3),t.BQk(),t.ynx(10,7),t.YNc(11,w,2,0,"th",2),t.YNc(12,N,2,1,"td",3),t.BQk(),t.YNc(13,x,1,0,"tr",8),t.YNc(14,U,1,0,"tr",9),t.qZA(),t.TgZ(15,"mat-paginator",10),t.NdJ("page",function(c){return a.onChangedPageSize(c)}),t.qZA()),2&e&&(t.Q6J("dataSource",a.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("length",a.totalDocumentCount)("pageSize",a.paginationProps.pageSize)("pageSizeOptions",a.paginationProps.pageSizeOptions))},dependencies:[r.NW,s.BZ,s.fO,s.as,s.w1,s.Dz,s.nj,s.ge,s.ev,s.XQ,s.Gk],styles:[".documentTable[_ngcontent-%COMP%]{width:100%}th.mat-header-cell[_ngcontent-%COMP%]{text-align:left;font-size:1rem;background:#f0f0f0}.attachment-download[_ngcontent-%COMP%]{cursor:pointer;color:#00f;text-decoration:underline}"]}),n})()}];let O=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.Bz.forChild(_),u.Bz]}),n})();var Y=i(1252);let P=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[d.ez,O,Y.m]}),n})()}}]);
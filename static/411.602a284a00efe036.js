"use strict";(self.webpackChunkelog_web=self.webpackChunkelog_web||[]).push([[411],{9411:(b,_,s)=>{s.r(_),s.d(_,{OrganizationModule:()=>lt});var p=s(6895),T=s(8210),f=s(4006),z=s(3060),g=s(8202),t=s(4650),v=s(7199),S=s(3081),Z=s(3293),m=s(5938);let y=(()=>{class o{constructor(e){this.matDialog=e}openAddUser(e){return this.matDialog.open(Z.H,{disableClose:!0,minWidth:"1200px",data:e})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(m.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var x=s(2653),N=s(5017),l=s(3626),U=s(7957),P=s(3238),C=s(4859),d=s(3546),I=s(6709),A=s(7331),L=s(7392),O=s(9549),R=s(4144),w=s(455);function k(o,i){if(1&o&&(t.TgZ(0,"mat-option",26),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.Q6J("value",e.Name),t.xp6(1),t.hij(" ",e.Name," ")}}function F(o,i){if(1&o&&(t.TgZ(0,"mat-chip"),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.Name)}}function D(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"th",27)(1,"mat-checkbox",28),t.NdJ("change",function(a){t.CHM(e);const r=t.oxw();return t.KtG(a?r.toggleAllRows():null)}),t.qZA()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("checked",e.selection.hasValue()&&e.isAllSelected())("indeterminate",e.selection.hasValue()&&!e.isAllSelected())("aria-label",e.checkboxLabel())}}function M(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"td",29)(1,"mat-checkbox",30),t.NdJ("click",function(a){return a.stopPropagation()})("change",function(a){const c=t.CHM(e).$implicit,u=t.oxw();return t.KtG(a?u.selection.toggle(c):null)}),t.qZA()()}if(2&o){const e=i.$implicit,n=t.oxw();t.xp6(1),t.Q6J("checked",n.selection.isSelected(e))("aria-label",n.checkboxLabel(e))}}function Y(o,i){1&o&&(t.TgZ(0,"th",27),t._uU(1,"Name"),t.qZA())}function J(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(null==e?null:e.Name)}}function E(o,i){1&o&&(t.TgZ(0,"th",27),t._uU(1,"Email"),t.qZA())}function Q(o,i){if(1&o&&(t.TgZ(0,"td",29),t._uU(1),t.qZA()),2&o){const e=i.$implicit;t.xp6(1),t.Oqu(e.email)}}function q(o,i){1&o&&(t.TgZ(0,"th",27),t._uU(1,"Email Notification"),t.qZA())}function $(o,i){if(1&o&&(t.TgZ(0,"td",29)(1,"section",31)(2,"mat-slide-toggle",32),t._uU(3," Off "),t.qZA()()()),2&o){const e=t.oxw();t.xp6(2),t.Q6J("color",e.color)("checked",e.checked)("disabled",e.disabled)}}function B(o,i){1&o&&t._UZ(0,"tr",33)}function H(o,i){if(1&o){const e=t.EpF();t.TgZ(0,"tr",34),t.NdJ("click",function(){const r=t.CHM(e).$implicit,c=t.oxw();return t.KtG(c.selection.toggle(r))}),t.qZA()}}function G(o,i){1&o&&(t.TgZ(0,"div")(1,"mat-card",35),t._uU(2," No users found "),t.qZA()())}let K=(()=>{class o{constructor(e,n,a,r){this.alertpopupService=e,this.organizationService=n,this.dialogref=a,this.data=r,this.selectedOrganizationId="",this.organizationUsersData=[],this.displayedColumns=["select","Name","Email","Email Notification"],this.dataSource=new l.by(this.organizationUsersData),this.selection=new N.Ov(!0,[]),this.userIdsArray=[],this.color="accent",this.checked=!1,this.disabled=!1,this.selectedOrganizationId=r}ngOnInit(){this.getUsersOrgnationById()}getUsersOrgnationById(){this.organizationService.getOrganizationsSearchCriteria({pageNumber:1e3,pageSize:0,sortField:"",sortOrder:0,type:"",organization:"",organizationId:this.selectedOrganizationId,userId:"",userSearch:""}).subscribe(n=>{this.organizationName=n.organizations[0].organizations[0].organization,this.organizationUsersData=n.organizations[0].organizations[0].users,console.log(this.organizationUsersData),this.dataSource=new l.by(this.organizationUsersData)})}isAllSelected(){return this.selection.selected.length===this.dataSource.data.length}toggleAllRows(){this.isAllSelected()?this.selection.clear():this.selection.select(...this.dataSource.data)}checkboxLabel(e){return e?`${this.selection.isSelected(e)?"deselect":"select"} row ${e.position+1}`:(this.isAllSelected()?"deselect":"select")+" all"}selectedUsers(){console.log(this.selection.selected),this.selection.selected.map(n=>{this.userIdsArray.push(n._id),console.log(this.userIdsArray)}),this.organizationService.removeUsersfromOrganization({userIds:this.userIdsArray,organizationId:this.selectedOrganizationId}).subscribe(n=>{this.alertpopupService.open({message:n.message,action:"ok"}),this.getUsersOrgnationById()},n=>{this.alertpopupService.open({message:"Faild to remove users from Organization! Please try again ",action:"ok"})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(x.z),t.Y36(v.M),t.Y36(m.so),t.Y36(m.WI))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-remove-user-pop-up"]],decls:41,vars:11,consts:[[1,"d-flex","justify-content-between"],[1,"user"],["mat-button","","color","warn","mat-dialog-close","true",3,"mat-dialog-close"],[1,"d-flex","justify-content-end"],["appearance","outline"],["matInput","","placeholder","Enter User Name","input","","type","text",3,"matAutocomplete"],["matSuffix",""],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[1,"row"],[1,"col-12"],[4,"ngFor","ngForOf"],["mat-dialog-content",""],["mat-table","",2,"padding-right","10px","width","100%",3,"dataSource"],["matColumnDef","select"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Name"],["matColumnDef","Email"],["matColumnDef","Email Notification"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"d-flex","btn","justify-content-end"],["mat-raised-button","","mat-dialog-close","true",3,"mat-dialog-close"],["mat-raised-button","","color","primary","mat-dialog-close","true",3,"mat-dialog-close","click"],[3,"value"],["mat-header-cell",""],[3,"checked","indeterminate","aria-label","change"],["mat-cell",""],[3,"checked","aria-label","click","change"],[1,"example-section"],[1,"example-margin",3,"color","checked","disabled"],["mat-header-row",""],["mat-row","",3,"click"],[1,"noUserFoundCard"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-card-title",0)(1,"h1",1),t._uU(2),t.qZA(),t.TgZ(3,"button",2),t._uU(4,"x"),t.qZA()(),t.TgZ(5,"mat-card-content")(6,"div",3)(7,"mat-form-field",4),t._UZ(8,"input",5),t.TgZ(9,"mat-icon",6),t._uU(10,"search"),t.qZA(),t.TgZ(11,"mat-autocomplete",null,7),t.YNc(13,k,2,2,"mat-option",8),t.qZA()()(),t.TgZ(14,"div",9)(15,"div",10)(16,"mat-chip-list"),t.YNc(17,F,2,1,"mat-chip",11),t.qZA(),t.TgZ(18,"div",12)(19,"table",13),t.ynx(20,14),t.YNc(21,D,2,3,"th",15),t.YNc(22,M,2,2,"td",16),t.BQk(),t.ynx(23,17),t.YNc(24,Y,2,0,"th",15),t.YNc(25,J,2,1,"td",16),t.BQk(),t.ynx(26,18),t.YNc(27,E,2,0,"th",15),t.YNc(28,Q,2,1,"td",16),t.BQk(),t.ynx(29,19),t.YNc(30,q,2,0,"th",15),t.YNc(31,$,4,3,"td",16),t.BQk(),t.YNc(32,B,1,0,"tr",20),t.YNc(33,H,1,0,"tr",21),t.qZA(),t.YNc(34,G,3,0,"div",22),t.qZA(),t.TgZ(35,"mat-card-actions")(36,"div",23)(37,"button",24),t._uU(38,"Cancel"),t.qZA(),t.TgZ(39,"button",25),t.NdJ("click",function(){return n.selectedUsers()}),t._uU(40," Remove "),t.qZA()()()()()()),2&e){const a=t.MAs(12);t.xp6(2),t.hij("Remove User > ",n.organizationName,""),t.xp6(1),t.Q6J("mat-dialog-close",!1),t.xp6(5),t.Q6J("matAutocomplete",a),t.xp6(5),t.Q6J("ngForOf",n.organizationUsersData),t.xp6(4),t.Q6J("ngForOf",n.selection.selected),t.xp6(2),t.Q6J("dataSource",n.dataSource),t.xp6(13),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns),t.xp6(1),t.Q6J("ngIf",0===(null==n.dataSource.filteredData?null:n.dataSource.filteredData.length)),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0)}},dependencies:[p.sg,p.O5,U.XC,U.ZL,P.ey,C.lW,d.a8,d.dn,d.n5,d.hq,I.oG,A.qn,A.HS,m.ZT,m.xY,L.Hw,O.KE,O.R9,R.Nt,w.Rr,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk],styles:[".noUserFoundCard[_ngcontent-%COMP%]{text-align:center;color:#ec5757}"]}),o})(),j=(()=>{class o{constructor(e){this.matDialog=e}removeUserPopUp(e){return this.matDialog.open(K,{disableClose:!0,minWidth:"800px",data:e})}}return o.\u0275fac=function(e){return new(e||o)(t.LFG(m.uw))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var V=s(9642),h=s(3848);function W(o,i){1&o&&t._uU(0," Active ")}function X(o,i){1&o&&t._uU(0," Ministry/Department ")}function tt(o,i){1&o&&t._uU(0," Association ")}function et(o,i){1&o&&t._uU(0," Disabled ")}function ot(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.disableAssociation(a._id,a.organization))}),t._uU(2," Disable "),t.qZA(),t.BQk()}}function nt(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2).$implicit,r=t.oxw();return t.KtG(r.removeUser(a._id,a.organization))}),t._uU(2," Delete "),t.qZA(),t.BQk()}}function it(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",15)(2,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openAddUserPopup(a._id))}),t._uU(3," Add User "),t.qZA(),t.TgZ(4,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.updateOrganization(a._id))}),t._uU(5," Edit "),t.qZA(),t.TgZ(6,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.openRemoveUserPopup(a._id))}),t._uU(7," Remove User "),t.qZA(),t.YNc(8,ot,3,0,"ng-container",14),t.YNc(9,nt,3,0,"ng-container",14),t.qZA(),t.BQk()}if(2&o){const e=t.oxw().$implicit;t.xp6(8),t.Q6J("ngIf",(null==e.users?null:e.users.length)>=1),t.xp6(1),t.Q6J("ngIf",0==(null==e.users?null:e.users.length))}}function at(o,i){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.removeUser(a._id,a.organization))}),t._uU(2," Delete User "),t.qZA(),t.TgZ(3,"button",16),t.NdJ("click",function(){t.CHM(e);const a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.enableAssociation(a._id))}),t._uU(4," Enable "),t.qZA(),t.BQk()}}function rt(o,i){if(1&o&&(t.TgZ(0,"mat-card",12)(1,"mat-card-content")(2,"p")(3,"span",13),t._uU(4),t.ALo(5,"titlecase"),t.qZA(),t.TgZ(6,"span"),t._uU(7),t.ALo(8,"uppercase"),t.qZA()(),t.TgZ(9,"p")(10,"span"),t._uU(11),t.qZA(),t._uU(12," User(s) "),t.qZA(),t.TgZ(13,"p"),t._uU(14,"0 Activity(s)"),t.qZA(),t.TgZ(15,"p"),t._uU(16,"0 Hour(s) Spent"),t.qZA(),t.TgZ(17,"p"),t._uU(18,"0 Mb Storage"),t.qZA(),t.YNc(19,it,10,2,"ng-container",14),t.YNc(20,at,5,0,"ng-container",14),t.qZA()()),2&o){const e=i.$implicit,n=t.oxw();t.xp6(4),t.Oqu(t.lcZ(5,5,e.organization)),t.xp6(3),t.hij(" ( ",t.lcZ(8,7,e.shortName)," )"),t.xp6(4),t.Oqu(e.users.length),t.xp6(8),t.Q6J("ngIf",1==n.organizationList[0].isActive),t.xp6(1),t.Q6J("ngIf",0==n.organizationList[0].isActive)}}const st=[{path:"",component:(()=>{class o{constructor(e,n,a,r,c,u){this.organizationService=e,this.masterDataService=n,this.addUserPopUpService=a,this.alertpopupService=r,this.removeUserPopUpService=c,this.confirmationDialogService=u,this.filters=g.t,this.organizationListPayload={pageNumber:0,pageSize:50,sortField:"",sortOrder:0,type:"",organization:"",organizationId:"",isActive:!0,userId:"",userSearch:""}}ngOnInit(){this.getAllOrganizationsSearchCriteria(this.organizationListPayload),this.getOrganizationTypes()}getOrganizationTypes(){this.masterDataService.getOrganizationTypes().subscribe(e=>{this.organizationTypes=e.data,console.log(this.organizationTypes)})}getAllOrganizationsSearchCriteria(e){this.organizationService.getOrganizationsSearchCriteria(e).subscribe(n=>{this.organizationList=n.organizations[0].organizations.reverse()})}applyOrganizationFilters(e){let n=this.organizationListPayload;Number(e.tab.textLabel)===g.t.MINISTRIES?n={...n,isActive:!0,type:this.organizationTypes[g.t.MINISTRIES]._id}:Number(e.tab.textLabel)===g.t.IS_ACTIVE?n={...n,isActive:!0}:Number(e.tab.textLabel)===g.t.ASSOCIATION?n={...n,isActive:!0,type:this.organizationTypes[g.t.ASSOCIATION]._id}:Number(e.tab.textLabel)===g.t.INACTIVE&&(n={...n,isActive:!1}),this.getAllOrganizationsSearchCriteria(n)}updateOrganization(e){this.organizationService.updateOrganizatioPopup(e).afterClosed().subscribe(n=>{n&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}createOrganization(){this.organizationService.openCreateOrganizatioPopup().afterClosed().subscribe(e=>{e&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}openAddUserPopup(e){this.addUserPopUpService.openAddUser(e).afterClosed().subscribe(n=>{n&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload)})}openRemoveUserPopup(e){this.removeUserPopUpService.removeUserPopUp(e).afterClosed().subscribe(n=>{n&&this.getAllOrganizationsSearchCriteria(this.organizationListPayload),console.log(n)})}disableAssociation(e,n){this.confirmationDialogService.open({message:`Are you Sure to Disable ${n}`}).afterClosed().subscribe(a=>{a&&this.organizationService.getorganizationById(e).subscribe(r=>{const c={...r.organization,isActive:!1};this.organizationService.updateOrganization(e,c).subscribe(u=>{this.alertpopupService.open({message:u.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},u=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}enableAssociation(e){this.confirmationDialogService.open({message:"Are you Sure to Enable User!!"}).afterClosed().subscribe(n=>{n&&this.organizationService.getorganizationById(e).subscribe(a=>{const r={...a.organization,isActive:!0};this.organizationService.updateOrganization(e,r).subscribe(c=>{this.alertpopupService.open({message:c.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},c=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}removeUser(e,n){this.confirmationDialogService.open({message:`Are you Sure to Delete ${n}`}).afterClosed().subscribe(a=>{a&&this.confirmationDialogService.open({message:`All the Activities, Files associated with ${n} will be deleted permanently. `}).afterClosed().subscribe(r=>{r&&this.organizationService.deleteUser(e).subscribe(c=>{this.alertpopupService.open({message:c.message,action:"ok"}),this.getAllOrganizationsSearchCriteria(this.organizationListPayload)},c=>{this.alertpopupService.open({message:"Faild to create Organization! Please try again ",action:"ok"})})})})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(v.M),t.Y36(S.D),t.Y36(y),t.Y36(x.z),t.Y36(j),t.Y36(V.O))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-organization-list"]],decls:31,vars:5,consts:[[1,"container"],[1,"page-wrapper"],[3,"selectedTabChange"],[3,"label"],["mat-tab-label",""],[2,"padding","0px !important"],[1,"section"],["fxLayout","row wrap","fxLayoutGap","16px",1,"align","main"],[1,"plus",3,"click"],[1,"add-icon"],[1,"mt-2"],["fxFlex.lg","calc(33% - 16px)","fxFlex.lt-lg","calc(50% - 16px)","fxFlex.xs","calc(100% - 16px)",4,"ngFor","ngForOf"],["fxFlex.lg","calc(33% - 16px)","fxFlex.lt-lg","calc(50% - 16px)","fxFlex.xs","calc(100% - 16px)"],[1,"organization-title"],[4,"ngIf"],[1,"button"],["mat-button","","color","primary",1,"addButton",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-tab-group",2),t.NdJ("selectedTabChange",function(r){return n.applyOrganizationFilters(r)}),t.TgZ(3,"mat-tab",3),t.YNc(4,W,1,0,"ng-template",4),t.TgZ(5,"div",5)(6,"h2"),t._uU(7,"Organizations"),t.qZA()()(),t.TgZ(8,"mat-tab",3),t.YNc(9,X,1,0,"ng-template",4),t.TgZ(10,"h2"),t._uU(11,"Organizations"),t.qZA()(),t.TgZ(12,"mat-tab",3),t.YNc(13,tt,1,0,"ng-template",4),t.TgZ(14,"h2"),t._uU(15,"Organizations"),t.qZA()(),t.TgZ(16,"mat-tab",3),t.YNc(17,et,1,0,"ng-template",4),t.TgZ(18,"h2"),t._uU(19,"Organizations"),t.qZA()()(),t.TgZ(20,"section",6)(21,"div",1)(22,"div",7)(23,"mat-card",8),t.NdJ("click",function(){return n.createOrganization()}),t.TgZ(24,"mat-card-content")(25,"div",9)(26,"font"),t._uU(27,"+"),t.qZA()(),t.TgZ(28,"h4",10),t._uU(29,"Create Organization"),t.qZA()()(),t.YNc(30,rt,21,9,"mat-card",11),t.qZA()()()()()),2&e&&(t.xp6(3),t.s9C("label",n.filters.IS_ACTIVE),t.xp6(5),t.s9C("label",n.filters.MINISTRIES),t.xp6(4),t.s9C("label",n.filters.ASSOCIATION),t.xp6(4),t.s9C("label",n.filters.INACTIVE),t.xp6(14),t.Q6J("ngForOf",n.organizationList))},dependencies:[p.sg,p.O5,C.lW,d.a8,d.dn,h.SP,h.uD,h.uX,p.gd,p.rS],styles:["mat-card[_ngcontent-%COMP%]{width:350px;min-height:220px;border-bottom:5px;text-align:center}.main[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;row-gap:10px}.mat-card-content[_ngcontent-%COMP%]{text-align:left;margin:30px 20px}.addButton[_ngcontent-%COMP%]{float:right}.add-icon[_ngcontent-%COMP%]{height:100px;width:100px;margin:auto;border:.25px solid #556ee7;border-radius:50%;display:grid;place-items:center}font[_ngcontent-%COMP%]{font-size:80px;color:#5927b1}.plus[_ngcontent-%COMP%]{display:grid;place-items:center;cursor:pointer}.organization-title[_ngcontent-%COMP%]{font-weight:900;font-size:16px}.togle-button[_ngcontent-%COMP%]{width:200px!important;min-width:unset!important}.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#556ee7;color:#fff!important}.mat-tab-group[_ngcontent-%COMP%]{padding:5px}"]}),o})()}];let ct=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[z.Bz.forChild(st),z.Bz]}),o})(),lt=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,T.m,f.u5,f.UX,ct]}),o})()},8202:(b,_,s)=>{s.d(_,{t:()=>p});const p={IS_ACTIVE:2,MINISTRIES:0,ASSOCIATION:1,INACTIVE:3,MY_PROFILE:4,CHANGE_PASSWORD:5,NOTIFICATIONS:6,EMAIL_REPORTS:7}}}]);